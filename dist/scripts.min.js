(function(e){function t(t,i){this.element=t,this.options=e.extend({},n,i),this._defaults=n,this._name=a,this.init()}var a="BootstrapSubMenu",n={propertyName:"value"},i=null,r=null,s=!1;t.prototype.init=function(){this.createEventHandlers(e(this.element),this.options.$mainNav)},t.prototype.createEventHandlers=function(t,a){a.click(function(){s=!1}),a.find("li:not(.dropdown-sub li)").hover(function(){clearTimeout(i),i=null,r||(r=setTimeout(function(){t.removeClass("active")},500))}),t.hover(function(){clearTimeout(r),r=null,i||(i=setTimeout(function(){s||t.addClass("active")},300))}),t.click(function(e){e.preventDefault(),e.stopPropagation()}),t.find("li").hover(function(){clearTimeout(r),r=null}),t.find("li").click(function(){s=!0,t.removeClass("active"),a.removeClass("open")}),a.find(".dropdown-toggle").click(function(){t.removeClass("active")}),e(document).click(function(){t.removeClass("active")})},e.fn[a]=function(n){return this.each(function(){e.data(this,"plugin_"+a)||e.data(this,"plugin_"+a,new t(this,n))})}})(jQuery);var gamedex={module:function(){var e={};return function(t){return e[t]?e[t]:e[t]={}}}()};gamedex.api="/",gamedex.initialize=function(){gamedex.initializeLibraries(),gamedex.initializeModules()},gamedex.initializeLibraries=function(){moment.calendar={lastDay:"LL",sameDay:"LL",nextDay:"LL",lastWeek:"LL",nextWeek:"LL",sameElse:"LL"},moment.longDateFormat={L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D YYYY h:mm A",LLLL:"dddd, MMMM D YYYY h:mm A"}},gamedex.initializeModules=function(){var e=gamedex.module("itemData"),t=gamedex.module("searchView"),a=gamedex.module("detailView"),n=gamedex.module("itemView"),i=gamedex.module("tagView"),r=gamedex.module("gridView"),s=gamedex.module("filterPanel"),o=gamedex.module("videoPanel"),l=gamedex.module("importView"),c=gamedex.module("siteView");e.init(),t.init(),a.init(),n.init(),i.init(),r.init(),s.init(),o.init(),l.init(),c.init()},function(e,t,a){"use strict";var n=(t.module("user"),[{id:"all",gt:"",ign:"",amazon:468642,name:"All Platforms",alias:"all"},{id:"pc",gt:"pc",ign:"pc",amazon:229575,name:"PC",alias:"pc,windows"},{id:"mac",gt:"",ign:"mac",amazon:229647,name:"Mac",alias:"mac,macwindows,osx,os x,apple,macintosh"},{id:"xbox",gt:"",ign:"xbox",amazon:537504,name:"Xbox",alias:"xbox,microsoft xbox"},{id:"x360",gt:"xbox 360",ign:"xbox-360",amazon:14220161,name:"X360",alias:"x360,xbox 360,microsoft xbox360,360"},{id:"xbl",gt:"xbla",ign:"xbox-360",amazon:14220161,name:"XBL",alias:"xbl,xbox live"},{id:"ds",gt:"ds",ign:"ds",amazon:11075831,name:"DS",alias:"ds,nintendo ds"},{id:"3ds",gt:"3ds",ign:"ds",amazon:2622269011,name:"3DS",alias:"3ds,nintendo 3ds"},{id:"wii",gt:"wii",ign:"wii",amazon:14218901,name:"Wii",alias:"wii,nintendo wii"},{id:"wiiu",gt:"wii u",ign:"wii-u",amazon:3075112011,name:"Wii U",alias:"wiiu,wii u,wii-u,nintendo wii u,nintendo wiiu"},{id:"ps",gt:"",ign:"ps",amazon:229773,name:"PS1",alias:"ps,ps1,playstation,playstation1,playstation 1,sony playstation 1,sony playstation"},{id:"ps2",gt:"",ign:"ps2",amazon:301712,name:"PS2",alias:"ps2,playstation 2,playstation2,sony playstation 2"},{id:"ps3",gt:"ps3",ign:"ps3",amazon:14210751,name:"PS3",alias:"ps3,playstation 3,playstation3,sony playstation 3"},{id:"psn",gt:"",ign:"ps3",amazon:14210751,name:"PSN",alias:"psn,playstation network"},{id:"vita",gt:"vita",ign:"vita",amazon:3010556011,name:"Vita",alias:"vita,psvita,ps vita,playstation vita,sony vita,sony playstation vita"},{id:"psp",gt:"",ign:"psp",amazon:11075221,name:"PSP",alias:"psp,sony psp"},{id:"gc",gt:"",ign:"gcn",amazon:541022,name:"Gamecube",alias:"gamecube,gc,nintendo gamecube"},{id:"n64",gt:"",ign:"n64",amazon:229763,name:"N64",alias:"n64,nintendo 64,nintendo64"},{id:"nes",gt:"",ign:"",amazon:566458,name:"NES",alias:"nes,nintendo nes"},{id:"snes",gt:"",ign:"",amazon:294945,name:"SNES",alias:"snes,super nintendo,nintendo snes"},{id:"gba",gt:"",ign:"gba",amazon:1272528011,name:"Game Boy",alias:"gb,gameboy"},{id:"gb",gt:"",ign:"gb",amazon:541020,name:"GBA",alias:"gba,gameboy advance,game boy,advance,gbadvance"},{id:"gbc",gt:"",ign:"",amazon:229783,name:"GBC",alias:"gbc,gbcolor,gameboy color"},{id:"dc",gt:"",ign:"dc",amazon:229793,name:"Dreamcast",alias:"dc,dreamcast,sega dreamcast,sega dream cast,dream cast"},{id:"saturn",gt:"",ign:"",amazon:294944,name:"Saturn",alias:"saturn,sega saturn"},{id:"genesis",gt:"",ign:"",amazon:294943,name:"Genesis",alias:"genesis,sega genesis"},{id:"gamegear",gt:"",ign:"",amazon:294942,name:"Gamegear",alias:"gamegear,game gear,sega gamegear"},{id:"segacd",gt:"",ign:"",amazon:11000181,name:"Sega CD",alias:"cd,sega cd"}]),i={Amazon:0,GiantBomb:1},r={Amazon:0,Steam:1},s="0",o={URL:"http://ecx.images-amazon.com/images",RE:/http:\/\/ecx\.images-amazon\.com\/images/gi,TOKEN:"~1~"},l={URL:"http://media.giantbomb.com/uploads",RE:/http:\/\/media\.giantbomb\.com\/uploads/gi,TOKEN:"~1~"},c=function(e){for(var t=RegExp(e,"gi"),a=0,i=n.length;i>a;a++)if(t.test(n[a].alias))return n[a];return n[0]},u=function(e){for(var t=null,a=[],i=null,r=e.length,s=0,o=null,l=0,c=n.length;c>l;l++){a=n[l].alias.split(",");for(var u=0,d=a.length;d>u;u++){if(t=RegExp(a[u],"gi"),o=t.exec(e),o&&o[0].length===r)return n[l];o&&o[0].length>s&&(s=o[0].length,i=n[l])}}return i?i:n[0]},d={PLATFORM_INDEX:n,SEARCH_PROVIDERS:i,PRICE_PROVIDERS:r,VIEW_ALL_TAG_ID:s,AMAZON_IMAGE:o,GIANTBOMB_IMAGE:l,getStandardPlatform:c,matchPlatformToIndex:u};a.extend(e,d)}(gamedex.module("utilities"),gamedex,jQuery,_),function(e,t,a,n,i){"use strict";var r=(t.module("utilities"),t.module("storage")),s=(t.module("itemView"),t.module("itemCache")),o=t.api+"user/login/",l=t.api+"user/logout/",c=t.api+"user/",u=t.api+"user/create/",d=t.api+"user/delete/",m=t.api+"user/update/",f=t.api+"user/resetcode/send/",g=t.api+"user/resetcode/submit/",p=t.api+"user/password/update/",h={user_id:"",secret_key:"",viewUser:null},v={user_id:"ag1zfnQtbWludXN6ZXJvcgwLEgVVc2Vycxj6VQw",secret_key:"1"};"localhost"===document.location.hostname&&(v={user_id:"ag9kZXZ-dC1taW51c3plcm9yEwsSBVVzZXJzGICAgICAgICARAw",secret_key:"1"}),e.getUserData=function(){return h},e.getUserCredentials=function(e){return e=e!==void 0?e:!1,h.timestamp=(new Date).getTime(),e&&r.set("timestamp",h.timestamp),h.viewUser?{user_name:h.viewUser}:e?{uid:h.user_id,uk:h.secret_key,ts:h.timestamp}:{uid:h.user_id,uk:h.secret_key}},e.getUserID=function(){return h.user_id},e.login=function(t,a,n,r){i.success("Logging in... "+t),e.verifyUser(t,a,function(e,t){I(e,t),n(e,t)},r)},e.verifyUser=function(e,t,n,i){var r={user_email:e,user_password:t};a.ajax({url:o,type:"POST",data:r,dataType:"json",cache:!0,success:function(t){n(t,e)},error:i})},e.deleteAccount=function(e,t,n,i){var r={uid:e,user_password:t};a.ajax({url:d,type:"POST",data:r,dataType:"json",cache:!0,success:function(e){n(e)},error:i})},e.demoLogin=function(){h.user_id=v.user_id,h.secret_key=v.secret_key},e.validateUser=function(e,t){var n={user_name:e};a.ajax({url:c,type:"POST",data:n,dataType:"json",cache:!0,success:function(e){D(e),t(e)},error:function(){}})},e.logout=function(){i.success("Logged out");var e={uid:h.user_id,uk:h.secret_key};a.ajax({url:l,type:"POST",data:e,dataType:"json",cache:!0,success:function(){},error:function(){}}),h.user_id=null,h.secret_key=null,h.userName=null,h.email=null,h.viewUser=null},e.createUser=function(e,t,n,r){i.success("Creating account : "+e);var s={user_email:e,user_password:t};a.ajax({url:u,type:"POST",data:s,dataType:"json",cache:!0,success:function(t){I(t,e),n(t,e)},error:r})},e.updateUser=function(e,t,n,i,r){if(""!==e){var s={uid:h.user_id,user_password:e};""!==n&&n!==h.userName&&(s.user_name=n),""!==n&&t!==h.email&&(s.user_email=t),""!==i&&(s.user_new_password=i),s.user_password=e,a.ajax({url:m,type:"POST",data:s,dataType:"json",cache:!0,success:function(e){"success"===e.status&&w(s),r(e)},error:function(){}})}},e.sendResetPasswordCode=function(e,t){var n={user_email:e};a.ajax({url:f,type:"POST",data:n,dataType:"json",cache:!0,success:function(e){t(e)},error:function(){}})},e.submitResetPasswordCode=function(e,t,n){var i={user_email:e,user_reset_code:t};a.ajax({url:g,type:"POST",data:i,dataType:"json",cache:!0,success:function(e){n(e)},error:function(){}})},e.updatePassword=function(e,t,n,i){var r={user_email:e,user_reset_code:t,user_new_password:n};a.ajax({url:p,type:"POST",data:r,dataType:"json",cache:!0,success:function(e){i(e)},error:function(){}})},e.isViewUser=function(){return h.viewUser?!0:!1};var w=function(e){e.user_name!==void 0&&(h.userName=e.user_name),e.user_email!==void 0&&(h.email=e.user_email)},I=function(e,t){if(e.userID){h.user_id=e.userID,h.secret_key=e.secretKey,h.userName=e.userName,h.email=t,h.viewUser=null,i.success("Welcome "+e.userName);var a=window.location.pathname;history&&"/"!==a&&history.pushState(null,null,"/");var n=r.get("timestamp");n?e.timestamp!=n&&(s.clearStoredData(),r.set("timestamp",e.timestamp)):r.set("timestamp",e.timestamp)}},D=function(e){"success"===e.status&&(h.viewUser=e.userName,h.user_id=e.userName,h.secret_key=0)}}(gamedex.module("user"),gamedex,jQuery,_,alertify),function(e,t){"use strict";var a=t.module("user");e.get=function(e){var t=a.getUserID(),n=localStorage.getItem(t+"_"+e),i=null;return"undefined"!==n&&n&&(i=JSON.parse(n)),i},e.set=function(e,t){if(!a.isViewUser()){var n=a.getUserID();localStorage.setItem(n+"_"+e,JSON.stringify(t)),t||(t={})}return t},e.remove=function(e){var t=a.getUserID();localStorage.removeItem(t+"_"+e)},e.setGlobal=function(e,t){return localStorage.setItem(e,JSON.stringify(t)),t||(t={}),t},e.getGlobal=function(e){var t=localStorage.getItem(e),a=null;return t&&(a=JSON.parse(t)),a},e.removeGlobal=function(e){localStorage.removeItem(e)},e.clearStorage=function(){localStorage.clear()}}(gamedex.module("storage"),gamedex,jQuery,_),function(e,t,a,n){"use strict";var i=(t.module("user"),t.module("storage")),r=t.module("utilities"),s=r.VIEW_ALL_TAG_ID,o={},l={},c=function(e){var t=null;return t=o[e]!==void 0?o[e]:D(e)},u=function(e,t){n.each(e,function(e){t[e.itemID]!==void 0&&n.each(t[e.itemID].tags,function(t,a){d(a,e),d(s,e)})})},d=function(e,t){o[e]!==void 0?o[e][t.itemID]=t:(o[e]={},o[e][t.itemID]=t),p(e,t)},m=function(e,t){o[e][t.itemID]=t,p(e,t,!0)},f=function(){return i.get("itemDataDirectory")},g=function(e){i.set("itemDataDirectory",e)},p=function(e,t,a){if(l[e+"_"+t.itemID]===void 0||a){var n=i.get("itemsCacheByTag");n?n[e]!==void 0?n[e][t.itemID]=t:(n[e]={},n[e][t.itemID]=t):(n={},n[e]={},n[e][t.itemID]=t),i.set("itemsCacheByTag",n)}},h=function(e,t){o[t]&&delete o[t][e],I(e,t)},v=function(e){o[e]&&delete o[e],w(e)},w=function(e){var t=i.get("itemsCacheByTag");t&&(delete t[e],i.set("itemsCacheByTag",t))},I=function(e,t){var a=i.get("itemsCacheByTag");a&&(delete a[t][e],i.set("itemsCacheByTag",a))},D=function(e){var t=i.get("itemsCacheByTag"),a=null;return t&&t[e]!==void 0&&(a=t[e],n.each(a,function(t,a){l[e+"_"+a]=!0})),a},y=function(){o={},l={}},b=function(){i.remove("itemsCacheByTag"),i.remove("itemDataDirectory"),i.remove("tag")},x={getCachedItemsByTag:c,cacheItemsByTag:u,cacheItemByTag:d,updateCacheItemByTag:m,getStoredItemDirectory:f,storeItemDirectory:g,deleteCachedItem:h,deleteCachedTag:v,clearItemCache:y,clearStoredData:b};a.extend(e,x)}(gamedex.module("itemCache"),gamedex,$,_),function(e,t,a,n,i){"use strict";var r=t.module("utilities"),s=["accessory","case","codes","combo","console","controller","covers","face plate","faceplate","head set","headset","import","japan","kit","map","membership","new","pack","poster","pre-paid","set","shell","skin","software","stylus","wireless"],o=t.api+"amazon/search/",l=t.api+"amazon/detail/",c=500,u=3e3,d={},m={},f={},g={},p=null,h=0;e.searchAmazon=function(t,n,i,r,s){r=r!==void 0?r:null,s=s!==void 0?s:!1,encodeURIComponent(t);var l={keywords:t,browse_node:n,search_index:"VideoGames",response_group:"ItemAttributes,Images",page:1};p&&s&&p.abort();var d=++h;return p=a.ajax({url:o,type:"GET",data:l,dataType:"xml",cache:!0,success:function(e){d!==h&&s||(p=null,i(e))},error:function(){var a=Math.floor(Math.random()*(u-c+1))+c;(function(){e.searchAmazon(t,n,i,r,s)}).delay(a),r&&r(!0)}})},e.parseAmazonResultItem=function(e,t){t=t!==void 0?t:!1;var a="("+s.join("|")+")",n=RegExp(a,"i"),o={name:e.find("Title").text(),platform:e.find("Platform").text()};return t||!n.test(o.name)&&""!==o.platform?(o.id=e.find("ASIN").text(),o.asin=e.find("ASIN").text(),o.gbombID=0,o.smallImage=e.find("ThumbnailImage > URL:first").text()||"",o.thumbnailImage=e.find("MediumImage > URL:first").text()||"",o.largeImage=e.find("LargeImage > URL:first").text()||"",o.description=e.find("EditorialReview > Content:first").text()||"",o.releaseDate=e.find("ReleaseDate").text()||"1900-01-01",o.platform=r.matchPlatformToIndex(o.platform).name,o.releaseDate&&"1900-01-01"!==releaseDate?o.calendarDate=i(o.releaseDate,"YYYY-MM-DD").calendar():(o.calendarDate="Unknown",o.releaseDate="1900-01-01")):o.isFiltered=!0,o},e.getAmazonItemDetail=function(e,t,i){var r=I(e);if(r)t(r);else if(n.has(g,e)||(g[e]=[]),g[e].push(t),1===g[e].length){var s={asin:e,response_group:"Medium"};a.ajax({url:l,type:"GET",data:s,dataType:"xml",cache:!0,success:function(t){n.each(g[e],function(a){m[e]=t,a(t)}),g[e]=[]},error:i})}},e.getAmazonItemOffers=function(e,t,i,r){console.info("getAmazonOffers");var s=w(e);if(s)console.info("get cached offer",s),t.offers=s,i(s);else if(n.has(f,e)||(f[e]=[]),f[e].push(i),1===f[e].length){var o={asin:e,response_group:"OfferFull"};a.ajax({url:l,type:"GET",data:o,dataType:"xml",cache:!0,success:function(a){n.each(f[e],function(n){var i=D(a,t);d[e]=i,n(i)}),f[e]=[]},error:r})}};var v=function(e){for(var t=null,a=null,n=0,i=e.offers.length;i>n;n++)"now"===e.offers[n].availability&&(t=e.offers[n].price,a=e.offers[n].rawPrice);t=t||e.lowestNewPrice,"Too low to display"===t&&(t="n/a",a=0),"Too low to display"===e.lowestNewPrice&&(e.lowestNewPrice="n/a"),e.buyNowPrice=t,e.buyNowRawPrice=a},w=function(e){var t=null;return d[e]!==void 0&&(t=d[e]),t},I=function(e){var t=null;return m[e]!==void 0&&(t=m[e]),t},D=function(e,t){var n={};return a("Item",e).each(function(){n=y(a(this))}),t.offers=n,n},y=function(e){var t={},n={},i=/\$/,r=parseInt(e.find("TotalNew").text(),10),s=parseInt(e.find("TotalUsed").text(),10);if(0!==r||0!==s){t.totalNew=r,t.totalUsed=s,t.lowestNewPrice=e.find("LowestNewPrice FormattedPrice").text().replace(i,""),t.lowestUsedPrice=e.find("LowestUsedPrice FormattedPrice").text().replace(i,""),t.totalOffers=e.find("TotalOffers").text(),t.offersURL=e.find("MoreOffersUrl").text(),t.offersURLNew=e.find("MoreOffersUrl").text()+"&condition=new",t.offersURLUsed=e.find("MoreOffersUrl").text()+"&condition=used";var o=/offer-listing/gi;t.productURL=t.offersURL.replace(o,"product"),t.offers=[],a("Offer",e).each(function(){n={},n.price=a(this).find("Price FormattedPrice").text().replace(i,""),n.rawPrice=a(this).find("Price Amount").text(),n.availability=a(this).find("AvailabilityType").text(),n.freeShipping=a(this).find("IsEligibleForSuperSaverShipping").text(),t.offers.push(n)}),v(t)}return t}}(gamedex.module("amazon"),gamedex,jQuery,_,moment),function(e,t,a,n,i){"use strict";var r=(t.module("amazon"),t.api+"giantbomb/search/"),s=t.api+"giantbomb/detail/",o=t.api+"giantbomb/video/",l={},c={},u={},d={},m={};e.searchGiantBomb=function(e,t,n){encodeURIComponent(e);var i=["id","name","original_release_date","image","platforms","site_detail_url","expected_release_day","expected_release_month","expected_release_quarter","expected_release_year"],s={field_list:i.join(","),keywords:e,page:0},o=a.ajax({url:r,type:"GET",data:s,dataType:"json",cache:!0,success:t,error:n});return o},e.parseGiantBombResultItem=function(e){var t={id:e.id,asin:0,gbombID:e.id,name:e.name,platform:"n/a",platforms:e.platforms};return e.original_release_date&&""!==e.original_release_date?t.releaseDate=e.original_release_date.split(" ")[0]:e.expected_release_day&&e.expected_release_month&&e.expected_release_year?(1===(""+e.expected_release_day).length&&(e.expected_release_day="0"+(""+e.expected_release_day)),1===(""+e.expected_release_month).length&&(e.expected_release_month="0"+(""+e.expected_release_month)),t.releaseDate=e.expected_release_year+"-"+e.expected_release_month+"-"+e.expected_release_day):e.expected_release_quarter&&(t.releaseDate="year-03-31",t.calendarDate="Q1 YEAR"),t.releaseDate&&"1900-01-01"!==t.releaseDate?t.calendarDate=i(t.releaseDate,"YYYY-MM-DD").calendar():(t.calendarDate="Unknown",t.releaseDate="1900-01-01"),t.smallImage=e.image&&e.image.small_url&&""!==e.image.small_url?e.image.small_url:"no image.png",t.thumbnailImage=e.image&&e.image.thumb_url&&""!==e.image.thumb_url?e.image.thumb_url:"no image.png",t.largeImage=e.image&&e.image.small_url&&""!==e.image.small_url?e.image.small_url:"no image.png",t.description=e.description&&""!==e.description?e.description:"No Description",t},e.getGiantBombItemPlatform=function(e,t,a){var n=["platforms"],i=f(s,e,n,function(a){t(a,e)},a);return i},e.getGiantBombItemData=function(e,t,a){var i=p(e);if(i)t(i);else if(n.has(d,e)||(d[e]=[]),d[e].push(t),1===d[e].length){var r=["description","site_detail_url","videos"];f(s,e,r,function(t){n.each(d[e],function(a){l[e]=t.results,a(t.results)}),d[e]=[]},a)}},e.getGiantBombVideo=function(e,t,a){var n=g(e),i=null;if(n)t(n);else{var r=[];i=f(o,e,r,function(a){u[e]=a.results,t(a.results)},a)}return i},e.getGiantBombItemDetail=function(e,t,a){var i=h(e);if(i)t(i);else if(n.has(m,e)||(m[e]=[]),m[e].push(t),1===m[e].length){var r=["id","name","original_release_date","image"];f(s,e,r,function(t){n.each(m[e],function(a){c[e]=t.results,a(t.results)}),m[e]=[]},a)}};var f=function(e,t,n,i,r){var s={field_list:n.join(","),id:t},o=a.ajax({url:e,type:"GET",data:s,dataType:"json",cache:!0,success:i,error:r});return o},g=function(e){var t=null;return u[e]!==void 0&&(t=u[e]),t},p=function(e){var t=null;return l[e]!==void 0&&(t=l[e]),t},h=function(e){var t=null;return c[e]!==void 0&&(t=c[e]),t}}(gamedex.module("giantbomb"),gamedex,jQuery,_,moment),function(e,t,a){"use strict";var n=t.module("amazon"),i=t.module("giantbomb"),r=t.module("utilities");e.standardizeTitle=function(e){var t=e,a=null,n=null;return t=t.replace(/\s*[\[\(].*[\)\]]/gi,""),t=t.replace(/\s*trophies/gi,""),t=t.replace(/\S+ edition$/gi,""),t=t.replace(/\swith\s.*/gi,""),t=t.replace(/^\s*the\s/gi,""),n&&n[0].length>3&&(t=t.replace(a,"")),t.toLowerCase()},e.getSimilarityScore=function(e,t){var a=100,n=u(e.standardName,t.name);if(a-=n,t.releaseDate!==void 0){var i=Math.floor((Date.parse(e.releaseDate)-Date.parse(t.releaseDate))/864e5);0===i&&(a+=100),isNaN(i)||"1900-01-01"===t.releaseDate||(a-=Math.abs(i/365))}if(t.platform!==void 0){var s=r.matchPlatformToIndex(t.platform).name;e.platform===s&&(a+=20)}return a},e.convertRomanNumerals=function(e){var t=RegExp("\\s[XVI]+","gi"),a=t.exec(e);if(a&&a[0].length>0){var n=a[0],i=RegExp("III","gi"),r=i.exec(n),s="";r&&r[0].length>0&&(s=3,n=n.replace(i,""));for(var o=n.split(""),l=null,c=o.length-1;c>=1;c--){switch(o[c]){case"I":l=1;break;case"V":l=5;break;case"X":l=10}s>l?s-=l:s+=l}e=e.replace(t," "+s)}return e},e.findItemOnAlternateProvider=function(e,t,a,s,o){var u=null;switch(o=o!==void 0?o:null,t){case r.SEARCH_PROVIDERS.Amazon:var d=e.standardName;u=i.searchGiantBomb(d,function(t){c(t,e,s,o)});break;case r.SEARCH_PROVIDERS.GiantBomb:var m=0;"n/a"!==e.platform&&(m=r.getStandardPlatform(e.platform).amazon),u=n.searchAmazon(e.name,m,function(t){l(t,e,s,o,!1)},o,a)}return u},e.getLinkedItemData=function(e,t,a){switch(t){case r.SEARCH_PROVIDERS.Amazon:i.getGiantBombItemDetail(e.gbombID,function(e){o(e,a)});break;case r.SEARCH_PROVIDERS.GiantBomb:n.getAmazonItemDetail(e.asin,function(e){s(e,a)})}},e.findWikipediaMatch=function(t,a,n){for(var i=t,r={},s=null,o=-99999,l=0,c=0,u=i.length;u>c;c++)r={name:i[c]},0===c&&(s=r),l=e.getSimilarityScore(a,r),l>o&&(s=r,o=l);0!==i.length&&n(s)};var s=function(e,t){var i={};a("Item",e).each(function(){i=n.parseAmazonResultItem(a(this),!0)}),t(i)},o=function(e,t){var a=i.parseGiantBombResultItem(e);t(a)},l=function(t,i,r,s,o){a("Item",t).length;var c={},u=0,d=null,m=-99999,f=0;a("Item",t).each(function(){c=n.parseAmazonResultItem(a(this)),c.isFiltered===void 0&&(0===u&&(d=c),u++,f=e.getSimilarityScore(i,c),f>m&&(d=c,m=f))}),d?r(d):o?s():n.searchAmazon(i.name,0,function(e){l(e,i,r,s,!0)},s)},c=function(t,a,n,r){for(var s=t.results,o={},l=null,c=-99999,u=0,d=0,m=s.length;m>d;d++)o=i.parseGiantBombResultItem(s[d]),0===d&&(l=o),u=e.getSimilarityScore(a,o),u>c&&(l=o,c=u);0!==s.length?n(l):r()},u=function(e,t){if(e==t)return 0;var a=e.length,n=t.length;if(0===a)return n;if(0===n)return a;var i=!1;try{i=!"0"[0]}catch(r){i=!0}i&&(e=e.split(""),t=t.split(""));var s=Array(a+1),o=Array(a+1),l=0,c=0,u=0;for(l=0;a+1>l;l++)s[l]=l;var d="",m="";for(c=1;n>=c;c++){for(o[0]=c,m=t[c-1],l=0;a>l;l++){d=e[l],u=d==m?0:1;var f=s[l+1]+1,g=o[l]+1,p=s[l]+u;f>g&&(f=g),f>p&&(f=p),o[l+1]=f}var h=s;s=o,o=h}return s[a]}}(gamedex.module("itemLinker"),gamedex,jQuery,_),function(e,t,a,n,i,r){"use strict";var s=t.module("user"),o=t.module("itemLinker"),l=t.module("itemCache"),c=t.module("tagView"),u=t.module("utilities"),d=t.api+"item/directory/",m=t.api+"item/",f=t.api+"item/add/",g=t.api+"item/delete/batch/",p=t.api+"item/delete/",h=t.api+"item/user/update/",v=t.api+"item/shared/price/update/",w=t.api+"item/metacritic/update/",I=t.api+"import/",D=u.VIEW_ALL_TAG_ID,y={},b={},x={},P={},S=function(){a(document).keypress(function(e){96==e.which&&(console.warn("------------ itemDataDirectory: -------",b),console.warn("------------ amazonDirectory: -------",x),console.warn("------------ giantBombDirectory: -------",P),console.warn("------------ items: -------------------",y))})},C=function(e){l.cacheItemsByTag(e,b)},_=function(e){var t=null,n=s.getUserCredentials(),i=l.getStoredItemDirectory();if(i)R(i),e&&e(i);else{var r={};a.extend(!0,r,n),t=a.ajax({url:d,type:"POST",data:r,dataType:"json",cache:!0,success:function(t){T(t),l.storeItemDirectory(b),e&&e(t)},error:function(){}})}return t},T=function(e){var t={};n.each(e.directory,function(e,a){t={itemID:a,asin:e.aid,gbombID:e.gid,gameStatus:e.gs,playStatus:e.ps,tags:e.t,tagCount:e.tc,userRating:e.ur},q(t)})},R=function(e){n.each(e,function(e){q(e)})},k=function(e,t,n){var i=null,r=l.getCachedItemsByTag(e);if(r)y=r,t(r);else{var o={list_id:e},c=s.getUserCredentials();a.extend(!0,o,c),i=a.ajax({url:m,type:"POST",data:o,dataType:"json",cache:!0,success:function(e){y=E(e),t(y)},error:n})}return i},E=function(e){var t={},a={};return n.each(e.items,function(e){a={};var n=e.ip,i=e.ib||"",r=G(e.si,i,n),s=G(e.ti,i,n),o=G(e.li,i,n);a.id=e.iid,a.initialProvider=e.ip,a.itemID=e.iid,a.asin=e.aid,a.gbombID=e.gid,a.name=e.n,a.releaseDate=e.rd,a.platform=e.p,a.smallImage=r,a.thumbnailImage=s,a.largeImage=o,a.metascore=e.ms,a.metascorePage=e.mp,a.offers={},null!==e.ap&&(a.offers.buyNowPrice=e.ap,a.offers.buyNowRawPrice=e.ap.replace(".",""),a.offers.offersURL=e.apu,a.offers.productURL=e.apu),null!==e.anp&&(a.offers.lowestNewPrice=e.anp,a.offers.offersURLNew=e.anpu),null!==e.aup&&(a.offers.lowestUsedPrice=e.aup,a.offers.offersURLUsed=e.aupu),null!==e.sp&&(a.steamPrice=e.sp,a.steamPage=e.spu),a.description="",Q(a),t[a.itemID]=a}),t},L=function(e){return y[e]},N=function(e,t,i,o){var l=null,u=s.getUserCredentials(!0),d=a.extend(!0,{},t),m=A(d.smallImage,d.initialProvider),g=A(d.thumbnailImage,d.initialProvider),p=A(d.largeImage,d.initialProvider),h=m.split(""),v=g.split(""),w=p.split(""),I=U(h,v,w),D=h.slice(0,I).join("");m=h.slice(I).join(""),g=v.slice(I).join(""),p=w.slice(I).join("");var y={lids:e,n:d.name,rd:d.releaseDate,aid:d.asin,gid:d.gbombID,ip:d.initialProvider,p:d.platform,ib:D,si:m,ti:g,li:p,mp:d.metascorePage,ms:d.metascore,gs:d.gameStatus,ps:d.playStatus,ur:d.userRating};return n.isUndefined(d.offers)||(n.isUndefined(d.offers.buyNowPrice)||(y.ap=d.offers.buyNowPrice,y.apu=d.offers.productURL),n.isUndefined(d.offers.lowestNewPrice)||(y.anp=d.offers.lowestNewPrice,y.anpu=d.offers.offersURLNew),n.isUndefined(d.offers.lowestUsedPrice)||(y.aup=d.offers.lowestUsedPrice,y.aupu=d.offers.offersURLUsed)),n.isUndefined(d.steamPrice)||(y.sp=d.steamPrice,y.spu=d.steamPage),a.extend(!0,y,u),l=a.ajax({url:f,type:"POST",data:y,dataType:"json",cache:!0,success:function(a){t.id=a.itemID,t.itemID=a.itemID;var s=j(t,a);c.updateInitialItemTags(a.tagIDsAdded,a.idsAdded);var o=[],l=" added to tag: ";n.each(e,function(e){o.push(c.getTagName(e))}),e.length>1&&(l=" added to tags: "),r.success(d.name+l+o.join(", ")),i(a,s)},error:o})},U=function(e,t,a){for(var n=0,i=0,r=e.length;r>i&&e[i]===t[i]&&e[i]===a[i];i++)n=i;return n+1},A=function(e,t){var a=e;return t===u.SEARCH_PROVIDERS.Amazon?a=e.replace(u.AMAZON_IMAGE.RE,u.AMAZON_IMAGE.TOKEN):t===u.SEARCH_PROVIDERS.GiantBomb&&(a=e.replace(u.GIANTBOMB_IMAGE.RE,u.GIANTBOMB_IMAGE.TOKEN)),a},G=function(e,t,a){var n=e,i=null;return e=t+e,a==u.SEARCH_PROVIDERS.Amazon?(i=RegExp(u.AMAZON_IMAGE.TOKEN,"g"),n=e.replace(i,u.AMAZON_IMAGE.URL)):a==u.SEARCH_PROVIDERS.GiantBomb&&(i=RegExp(u.GIANTBOMB_IMAGE.TOKEN,"g"),n=e.replace(i,u.GIANTBOMB_IMAGE.URL)),n},V=function(e,t,i,o,l){var u=s.getUserCredentials(!0),d={ids:e};a.extend(!0,d,u),a.ajax({url:g,type:"POST",data:d,dataType:"json",cache:!0,success:function(){var e=[],a=" removed from tag: ";n.each(t,function(t){e.push(c.getTagName(t))}),t.length>1&&(a=" removed from tags: "),r.error(i.name+a+e.join(", "))},error:l}),F(i.itemID,e,t),o(i.itemID,t)},F=function(e,t,a){for(var n=0,i=t.length;i>n;n++)H(a[n],e)},O=function(e,t,n,i){var r=Z(e).tags[t],o=s.getUserCredentials(!0),l={id:r};return a.extend(!0,l,o),a.ajax({url:p,type:"POST",data:l,dataType:"json",cache:!0,success:function(){},error:i}),H(t,e),n(r,t),e},z=function(e,t,i,r){var o=!1,l=a.extend(!0,{},e),c={id:l.itemID};if(t==u.PRICE_PROVIDERS.Amazon?n.isUndefined(l.offers)||0===n.keys(l.offers).length?(l.offers={buyNowPrice:"",buyNowRawPrice:"",lowestNewPrice:"",lowestUsedPrice:"",offersURL:"",offersURLNew:"",offersURLUsed:"",productURL:""},c.ap="",c.apu="",c.anp="",c.anpu="",c.aup="",c.aupu=""):(n.isUndefined(l.offers.buyNowPrice)||""===l.offers.buyNowPrice||(o=!0,c.ap=l.offers.buyNowPrice,c.apu=l.offers.productURL),n.isUndefined(l.offers.lowestNewPrice)||""===l.offers.lowestNewPrice||(o=!0,c.anp=l.offers.lowestNewPrice,c.anpu=l.offers.offersURLNew),n.isUndefined(l.offers.lowestUsedPrice)||""===l.offers.lowestUsedPrice||(o=!0,c.aup=l.offers.lowestUsedPrice,c.aupu=l.offers.offersURLUsed)):t==u.PRICE_PROVIDERS.Steam&&(n.isUndefined(l.steamPrice)?(o=!0,l.steamPrice="",l.steamPage="",c.sp="",c.spu=""):n.isUndefined(l.steamPrice)||""===l.steamPrice||(o=!0,c.sp=l.steamPrice,c.spu=l.steamPage)),o){var d=Z(e.itemID).tags,m=s.getUserCredentials(!0);W(l,d),a.extend(!0,c,m),a.ajax({url:v,type:"POST",data:c,dataType:"json",cache:!0,success:function(e){i(l,e)},error:r})}},B=function(e,t,n){var i=s.getUserCredentials(!0),o=a.extend(!0,{},e),l={id:o.itemID,gs:o.gameStatus,ps:o.playStatus,ur:o.userRating};a.extend(!0,l,i),a.ajax({url:h,type:"POST",data:l,dataType:"json",cache:!0,success:function(e){Y(o),t(o,e),r.success(o.name+" status updated")},error:n})},M=function(e,t,n){var i=Z(e.itemID).tags,r=s.getUserCredentials(!0),o=a.extend(!0,{},e),l={id:o.itemID,mp:o.metascorePage,ms:o.metascore};a.extend(!0,l,r),W(o,i),a.ajax({url:w,type:"POST",data:l,dataType:"json",cache:!0,success:function(e){t&&t(o,e)},error:n})},j=function(e,t){var i=null,r=null,s=[];e.itemID=t.itemID;for(var o=0,c=t.tagIDsAdded.length;c>o;o++)r=a.extend(!0,{},e),r.id=t.itemID,Q(r),l.cacheItemByTag(t.tagIDsAdded[o],r),s.push(r);X(r,t),i=l.getCachedItemsByTag(D);var u=!1;return n.each(i,function(e){e.itemID===r.itemID&&(u=!0)}),u||l.cacheItemByTag(D,r),s},H=function(e,t){l.deleteCachedItem(t,e),J(t,e),0===b[t].tagCount&&l.deleteCachedItem(t,D)},Q=function(e){e.calendarDate="1900-01-01"!==e.releaseDate?i(e.releaseDate,"YYYY-MM-DD").calendar():"Unknown",e.standardName=o.standardizeTitle(e.name)},Y=function(e){var t=b[e.itemID];t.gameStatus=e.gameStatus,t.playStatus=e.playStatus,t.userRating=e.userRating,l.storeItemDirectory(b)},W=function(e,t){n.each(t,function(t,a){l.updateCacheItemByTag(a,e)}),l.updateCacheItemByTag(0,e)},X=function(e,t){if(!b[t.itemID]){var a={itemID:e.itemID,asin:e.asin,gbombID:e.gbombID,gameStatus:e.gameStatus,playStatus:e.playStatus,tags:{},tagCount:0,userRating:e.userRating};q(a)}for(var n=0,i=t.tagIDsAdded.length;i>n;n++)b[t.itemID].tags[t.tagIDsAdded[n]]=t.idsAdded[n],b[t.itemID].tagCount+=1;l.storeItemDirectory(b)},J=function(e,t){var a=b[e];delete a.tags[t],a.tagCount+=-1,l.storeItemDirectory(b)},q=function(e){b[e.itemID]=e,0!==parseInt(e.asin,10)&&(x[e.asin]=e),0!==parseInt(e.gbombID,10)&&(P[e.gbombID]=e)},$=function(){return b},Z=function(e){return b[e]||null},K=function(e,t){var a=null;return 0!==e?a=P[e]:0!==t&&(a=x[t]),a},et=function(){y={},b={},x={},P={},l.clearItemCache()},tt=function(){var e=[];n.each(y,function(t,a){e.push(a)});var t=Math.floor(Math.random()*e.length);return e[t]},at=function(e,t,n){var i=s.getUserCredentials(!0),r={source:e,source_user:t};a.extend(!0,r,i),a.ajax({url:I,type:"POST",data:r,dataType:"json",cache:!0,success:n,error:function(){}})},nt={init:S,itemsAndDirectoryLoaded:C,getItemDirectory:$,getDirectoryItemByItemID:Z,getItemByThirdPartyID:K,resetItemData:et,getRandomItemID:tt,getItems:k,getItem:L,downloadItemDirectory:_,addItemToTags:N,updateUserItem:B,updateSharedItemPrice:z,updateMetacritic:M,deleteTagsForItem:V,deleteSingleTagForItem:O,deleteTagFromDirectory:J,deleteClientItem:H,importGames:at};a.extend(e,nt)}(gamedex.module("itemData"),gamedex,$,_,moment,alertify),function(e,t,a){"use strict";var n=t.api+"tag/",i=t.api+"tag/add/",r=t.api+"tag/update/",s=t.api+"tag/delete/",o=t.module("user"),l=t.module("storage"),c=(t.module("itemData"),{});e.getTags=function(e,t){var i=null,r=o.getUserCredentials(),s={};return a.extend(!0,s,r),c=l.get("tag"),c?e&&e(c):i=a.ajax({url:n,type:"POST",data:s,dataType:"json",cache:!0,success:function(t){c=l.set("tag",t.list),e(t.list)},error:t}),i},e.addTag=function(e,t,n){var r=o.getUserCredentials(!0),s={tag_name:e};a.extend(!0,s,r),a.ajax({url:i,type:"POST",data:s,dataType:"json",cache:!0,success:function(e){c.push({tagName:e.tagName.toLowerCase(),tagID:e.tagID}),l.set("tag",c),t(e)},error:n})},e.updateTag=function(e,t,n,i){var s=o.getUserCredentials(!0),u={tag_name:e,tag_id:t};a.extend(!0,u,s),a.ajax({url:r,type:"POST",data:u,dataType:"json",cache:!0,success:function(e){n(e)},error:i});for(var d=0,m=c.length;m>d;d++)c[d].tagID===t&&(c[d].tagName=e,l.set("tag",c))},e.deleteTag=function(e,t,n){var i=o.getUserCredentials(!0),r={id:e};a.extend(!0,r,i),a.ajax({url:s,type:"POST",data:r,dataType:"json",cache:!0,success:t,error:n});for(var u=0,d=c.length;d>u;u++)if(c[u].tagID===e){c.splice(u,1),l.set("tag",c);break}}}(gamedex.module("tagData"),gamedex,jQuery,_),function(e,t,a,n){"use strict";var i=(t.module("amazon"),t.module("itemLinker")),r=t.module("itemData"),s=t.api+"metacritic/search/",o=t.api+"metacritic/cache/",l="metacritic.com",c={},u={};e.getMetascore=function(e,t,i,o){var l=null,c=m(t.asin,t.gbombID,t.platform);if(c)l=c,t.metascore=c.metascore,t.metascorePage=c.metascorePage,o(t);else{var h=e+"_"+t.platform;if(n.has(u,h)||(u[h]=[]),u[h].push(o),1===u[h].length){var v=d(e),w={keywords:encodeURI(v),platform:encodeURI(t.platform)};l=a.ajax({url:s,type:"GET",data:w,cache:!0,success:function(e){var a=t.metascore,s=g(v,e,t);p(s,t),i||t.metascore==a||r.updateMetacritic(t),n.each(u[h],function(e){f(t.asin,t.gbombID,t.platform,t),e(t)}),u[h]=[]}})}}return l},e.displayMetascoreData=function(e,t,n){var i=a(n),r=t,s="favorable";0>t?(r="n/a",s="unavailable"):50>t?s="unfavorable":75>t&&(s="neutral"),i.html(r).removeClass("unavailable").removeClass("unfavorable").removeClass("neutral").removeClass("favorable").addClass(s).attr("href","http://www."+l+e).attr("data-score",t).attr("data-original-title",l+" "+e).show();var o=i.data("opentips");o&&o.length>0?o[0].setContent(i.attr("data-original-title")):i.opentip(i.attr("data-original-title"),{tipJoint:"bottom"})
};var d=function(e){a=/\s*[:&]\s*/g;var t=e.replace(a," "),a=/\s/g;return t=t.replace(a,"+")},m=function(e,t,a){var n=null;return c[e+"_"+a]!==void 0?n=c[e+"_"+a]:c[t+"_"+a]!==void 0&&(n=c[t+"_"+a]),n},f=function(e,t,a,n){"0"!=e&&(c[e+"_"+a]={metascorePage:n.metascorePage,metascore:n.metascore}),"0"!=t&&(c[t+"_"+a]={metascorePage:n.metascorePage,metascore:n.metascore})},g=function(e,t,a){var n=null;return t.metascore===void 0?(n=v(t,a),n&&h(e,a.platform,n.metascore,n.metascorePage)):n=t,n},p=function(e,t){e&&""!==e.metascore?(t.metascore=e.metascore,t.displayMetascore=e.metascore,t.metascorePage=e.metascorePage):e?(t.metascore=-1,t.displayMetascore="n/a",t.metascorePage=e.metascorePage):(t.metascore=-1,t.displayMetascore="n/a",t.metascorePage="")},h=function(e,t,n,i){var r={keywords:encodeURI(e),platform:encodeURI(t),metascore:encodeURI(n),metascorePage:encodeURI(i)};a.ajax({url:o,type:"GET",data:r,cache:!0,success:function(){}})},v=function(e,t){var n=a("#main",e).find(".result"),r={},s=null,o=-99999,l=0;return a(n).each(function(){var e=new Date(a(this).find(".release_date .data").text()),n=e.getMonth()+1;n=10>n?"0"+n:n;var c=e.getDate();c=10>c?"0"+c:c,r={name:a(this).find(".product_title a").text(),releaseDate:e.getFullYear()+"-"+n+"-"+c,platform:a(this).find(".platform").text(),metascore:a(this).find(".metascore").text(),metascorePage:a(this).find(".product_title a").attr("href")},l=i.getSimilarityScore(t,r),l>o&&(s=r,o=l)}),s}}(gamedex.module("metacritic"),gamedex,jQuery,_),function(e){var t=(gamedex.module("user"),gamedex.module("utilities"),gamedex.module("itemLinker")),a={};e.getWikipediaPage=function(e,r,s){var o=a[r.id];o&&o.wikipediaPage!==void 0?s(o.wikipediaPage):n(e,function(e){pageArray=e[1],t.findWikipediaMatch(pageArray,r,function(e){i(e.name,function(e){_.each(e.query.pages,function(e){o?o.wikipediaPage=e.fullurl:a[r.id]={wikipediaPage:e.fullurl},s(e.fullurl)})})})})};var n=function(e,t,a){var n="http://en.wikipedia.org/w/api.php?action=opensearch&format=json&callback=?",i={search:e,prop:"revisions",rvprop:"content"};$.ajax({url:n,type:"GET",data:i,dataType:"jsonp",cache:!1,crossDomain:!0,success:t,error:a})},i=function(e,t,a){var n="http://en.wikipedia.org/w/api.php?action=query&format=json&callback=?",i={titles:e,prop:"info",inprop:"url"};$.ajax({url:n,type:"GET",data:i,dataType:"jsonp",cache:!1,crossDomain:!0,success:t,error:a})}}(gamedex.module("wikipedia")),function(e,t,a,n){"use strict";var i=(t.module("amazon"),t.module("itemLinker")),r=(t.module("itemData"),t.api+"gametrailers/search/"),s=t.api+"gametrailers/cache/",o={},l={};e.getGametrailersPage=function(e,t,i){var s=null,o=u(e);if(o)t.gametrailersPage=o.gametrailersPage,i(t.gametrailersPage);else{var f=e+"_";if(n.has(l,f)||(l[f]=[]),l[f].push(i),1===l[f].length){var g=c(e),p={keywords:encodeURI(g)};s=a.ajax({url:r,type:"GET",data:p,cache:!0,success:function(a){var i=m(g,a,t);n.each(l[f],function(a){t.gametrailersPage=i,d(e,i),a(i)}),l[f]=[]}})}}return s};var c=function(e){a=/\s*[:&]\s*/g;var t=e.replace(a," "),a=/\s/g;return t=t.replace(a,"+")},u=function(e){var t=null;return o[e]!==void 0&&(t=o[e]),t},d=function(e,t){o[e]={gametrailersPage:t}},m=function(e,t,a){var n=null;return t.gametrailersPage===void 0?(n=g(t,a),n&&f(e,n)):n=t.gametrailersPage,n},f=function(e,t){var n={keywords:encodeURI(e),gametrailersPage:encodeURI(t)};a.ajax({url:s,type:"GET",data:n,cache:!0,success:function(){}})},g=function(e,t){var n=a("#games",e).find(".video_game_information_child"),r={},s=null,o=-99999,l=0;return a(n).each(function(){r={name:a(this).find(".content h3 a").text(),releaseDate:a(this).find(".content dl dd:eq(1) a").text(),gametrailersPage:a(this).find(".content h3 a").attr("href")},l=i.getSimilarityScore(t,r),l>o&&(s=r,o=l)}),s?s.gametrailersPage+"/videos-trailers":null}}(gamedex.module("gameTrailers"),gamedex,jQuery,_),function(e,t,a,n){"use strict";var i=t.module("itemLinker"),r=t.api+"steam/search/",s=t.api+"steam/cache/",o={},l={};e.getSteamGame=function(e,t,i,s){var o=null,f=u(e);if(f)t.steamPage=f.steamPage,t.steamPrice=f.steamPrice,i(f);else{var g=e+"_";if(n.has(l,g)||(l[g]=[]),l[g].push(i),1===l[g].length){var p=c(e),h={keywords:p};o=a.ajax({url:r,type:"GET",data:h,cache:!0,success:function(a){var i=m(p,a,t);i?n.each(l[g],function(a){t.steamPage=i.steamPage,t.steamPrice=i.steamPrice,d(e,i.steamPage,i.steamPrice),a(i)}):n.isUndefined(s)||s(),l[g]=[]}})}}return o};var c=function(e){var t=/\s*[:&]\s*/g,a=e.replace(t," ");return a},u=function(e){var t=null;return o[e]!==void 0&&(t=o[e]),t},d=function(e,t,a){o[e]={steamPage:t,steamPrice:a}},m=function(e,t,a){var n={};return t.url===void 0?(n=g(t,a),n&&f(e,n.steamPage,n.steamPrice)):n={steamPage:t.url,steamPrice:t.price},n},f=function(e,t,n){var i={keywords:encodeURI(e),url:encodeURI(t),price:encodeURI(n)};a.ajax({url:s,type:"GET",data:i,cache:!0,success:function(){}})},g=function(e,t){var a=null,r=-99999,s=0;return n.each(e,function(e){s=i.getSimilarityScore(t,e),s>r&&(a={steamPage:e.page,steamPrice:e.price.replace("$","")},r=s)}),a}}(gamedex.module("steam"),gamedex,jQuery,_),function(e,t,a){var n=t.api+"list/ign/upcoming/popular/",i=t.api+"list/ign/upcoming/",r=t.api+"list/ign/reviewed/",s={};IGNUpcomingListCache={},IGNReviewedListCache={},e.getPopularGames=function(e,t,i){var r=o(s,e,t);if(r)i(r);else{var l={platform:e,page:t};a.ajax({url:n,type:"GET",data:l,cache:!0,success:function(a){s[e+"_"+t]=a,i(a)}})}},e.getUpcomingGames=function(e,t,n){var r=o(IGNUpcomingListCache,e,t);if(r)n(r);else{var s={platform:e,page:t};a.ajax({url:i,type:"GET",data:s,cache:!0,success:function(a){IGNUpcomingListCache[e+"_"+t]=a,n(a)}})}},e.getReviewedGames=function(e,t,n){var i=o(IGNReviewedListCache,e,t);if(i)n(i);else{var s={platform:e,page:t};a.ajax({url:r,type:"GET",data:s,cache:!0,success:function(a){IGNReviewedListCache[e+"_"+t]=a,n(a)}})}};var o=function(e,t,a){var n=null;return e[t+"_"+a]!==void 0&&(n=e[t+"_"+a]),n}}(gamedex.module("ign"),gamedex,jQuery,_),function(e,t,a,n){"use strict";var i=t.module("utilities"),r=t.api+"list/gt/released/",s={},o={},l={};e.getReleasedGames=function(e,t,i,f,g){var p=m(t,i,f),h=null;if(p){var v=d(p,e);g(v,o)}else{var w=t+"_"+i+"_"+f;if(n.has(l,w))l[w].platform=e;else{var I={platform:e};l[w]=I;var D={year:t,month:i,day:f};h=a.ajax({url:r,type:"GET",data:D,cache:!0,success:function(e){c(e),u(e);var a=d(e,l[w].platform);s[t+"_"+i+"_"+f]=e,g(a,o),delete l[w]}})}}return h};var c=function(e){n.each(e,function(e){var t=e.platforms.split(",");e.linkedPlatforms={all:void 0},n.each(t,function(t){var a=n.str.trim(t),r=i.getStandardPlatform(a);e.linkedPlatforms[r.id]=r.name})})},u=function(e){n.each(e,function(e){n.each(e.linkedPlatforms,function(e,t){o[t]=n.has(o,t)?o[t]+1:1})})},d=function(e,t){var a=[];return n.each(e,function(e){e.name=e.name.replace(/\sbox\s*.*/gi,""),n.has(e.linkedPlatforms,t)&&a.push(e)}),a},m=function(e,t,a){var n=null;return s[e+"_"+t+"_"+a]!==void 0&&(n=s[e+"_"+t+"_"+a]),n}}(gamedex.module("releasedList"),gamedex,jQuery,_),function(e,t,a,n,i,r){"use strict";var s=t.module("user"),o=t.module("itemData"),l=t.module("tagView"),c=t.module("itemView"),u=t.module("searchView"),d=t.module("storage"),m=t.module("gridView"),f={login:0,signup:1},g=600,p="Demo",h=!1,v=f.login,w=!1,I=1,D=a("#content"),y=(a("#infoHeader"),a("#header"),a("#userMenu")),b=a("#loggedInButton"),x=a(".miniLogo"),P=a("#managementButton"),S=a("#updateProfileButton"),C=a("#changePasswordButton"),_=a("#logoutButton"),T=a("#hideInfoHeader_btn"),R=a("#showInfoHeader_btn"),k=a("#loginForm"),E=a("#buttonContainer"),L=a("#loginButton"),N=a("#loginHitArea"),U=a("#signupButton"),A=a("#signupHitArea"),G=a("#loginSubmitButton"),V=a("#signupSubmitButton"),F=a("#backButton"),O=a("#email").find("input"),z=a("#password").find("input"),B=a("#rememberCheckboxToggle"),M=a("#resetPasswordButton"),j=a("#invalidLoginTag"),H=a("#accountExistsTag"),Q=a("#accountManagement-modal"),Y=Q.find("#clearLocalStorage_btn"),W=(Q.find(".alert-success"),Q.find(".alert-error")),X=Q.find(".existingPasswordGroup"),J=a("#accountPasswordField"),q=a("#deleteAccount_btn"),$=a("#deleteAccountConfirm-modal"),Z=a("#deleteAccountConfirm_btn"),K=a("#updateProfile-modal"),et=K.find(".usernameGroup"),tt=K.find("#userNameUpdateField"),at=K.find(".emailGroup"),nt=K.find("#emailUpdateField"),it=K.find("#profilePasswordField"),rt=K.find(".existingPasswordGroup"),st=K.find(".alert-success"),ot=K.find(".alert-error"),lt=K.find("#updateAccount_btn"),ct=K.find(".profileURL"),ut=a("#changePassword-modal"),dt=ut.find(".existingPasswordGroup"),mt=ut.find(".confirmPasswordGroup"),ft=ut.find(".newPasswordGroup"),gt=ut.find("#passwordUpdateField"),pt=ut.find("#passwordConfirmField"),ht=ut.find("#existingPasswordField"),vt=ut.find(".alert-error"),wt=ut.find(".alert-success"),It=ut.find("#changePassword_btn"),Dt=a("#resetpassword-modal"),yt=Dt.find(".resetCodeForm"),bt=Dt.find(".updatePasswordForm"),xt=Dt.find(".passwordResetCodeContainer"),Pt=Dt.find(".passwordResetEmailContainer"),St=Dt.find(".alert-success"),Ct=Dt.find(".alert-error"),_t=a("#resetPasswordEmailField"),Tt=a("#resetPasswordCodeField"),Rt=a("#resetPasswordPasswordField"),kt=a("#sendResetCode_btn"),Et=a("#submitResetCode_btn"),Lt=a("#updatePassword_btn"),Nt=a("#guideHitArea"),Ut=a("#guideButton"),At=a("#siteGuide"),Gt=(a("#siteGuideBackdrop"),At.find(".siteGuideExit_btn")),Vt=At.find(".siteGuidePrevious_btn"),Ft=At.find(".siteGuideNext_btn"),Ot=(a("#searchField input"),a("#itemResultsContainer").find(".loadingStatus")),zt=function(){i.set({labels:{ok:"Close",cancel:"Close"},delay:2e3}),Bt(),Mt(),Ht(),Dt.modal({backdrop:!0,keyboard:!0,show:!1}),Xt()},Bt=function(){r.lastZIndex=1e5,r.styles.info={"extends":"standard",title:void 0,escapeTitle:!0,escapeContent:!1,className:"info",stem:!0,delay:null,hideDelay:0,fixed:!0,showOn:"mouseover",hideTrigger:"trigger",hideTriggers:[],hideOn:null,offset:[0,0],containInViewport:!0,autoOffset:!0,showEffect:"appear",hideEffect:"fade",showEffectDuration:.3,hideEffectDuration:.2,stemLength:8,stemBase:8,tipJoint:"top",target:!0,targetJoint:null,ajax:!1,ajaxMethod:"GET",ajaxCache:!0,group:null,style:null,background:"rgba(50, 63, 66, .9);",backgroundGradientHorizontal:!1,closeButtonOffset:[5,5],closeButtonRadius:7,closeButtonCrossSize:4,closeButtonCrossColor:"#d2c35b",closeButtonCrossLineWidth:1.5,closeButtonLinkOverscan:6,borderRadius:3,borderWidth:1,borderColor:"rgba(255, 255, 255, .5)",shadow:!0,shadowBlur:10,shadowOffset:[3,3],shadowColor:"rgba(0, 0, 0, 0.4)"},r.defaultStyle="info"},Mt=function(){window.addEventListener("popstate",function(){var e=window.location.pathname;jt(e)}),T.click(function(e){e.preventDefault();var t=T.data("opentips");t[0].hide(),pa()}),R.click(function(e){e.preventDefault(),ha()}),P.click(function(e){e.preventDefault(),Pa()}),S.click(function(e){e.preventDefault(),Sa()}),C.click(function(e){e.preventDefault(),Ca()}),lt.click(function(e){e.preventDefault(),Ta()}),It.click(function(e){e.preventDefault(),_a()}),O.on("keydown",function(e){xa(e.which)}),z.on("keydown",function(e){xa(e.which)}),_.click(function(e){e.preventDefault(),ea()}),x.on("click",function(){ea()}),Y.click(function(e){e.preventDefault(),d.clearStorage()}),q.click(function(e){e.preventDefault(),Ra()}),Z.click(function(e){e.preventDefault(),ka()}),A.click(function(e){e.preventDefault(),Da()}),A.mouseover(function(){U.addClass("hover")}),A.mouseout(function(){U.removeClass()}),A.mousedown(function(){U.addClass("active")}),A.mouseup(function(){U.removeClass("active")}),N.click(function(e){e.preventDefault(),Ia()}),N.mouseover(function(){L.addClass("hover")}),N.mouseout(function(){L.removeClass()}),N.mousedown(function(){L.addClass("active")}),N.mouseup(function(){L.removeClass("active")}),Nt.click(function(){ia(1)}),Nt.mouseover(function(){Ut.addClass("hover")}),Nt.mouseout(function(){Ut.removeClass()}),Nt.mousedown(function(){Ut.addClass("active")}),Nt.mouseup(function(){Ut.removeClass("active")}),G.click(function(e){e.preventDefault(),Yt(O.val(),z.val())}),V.click(function(e){e.preventDefault(),ta(O.val(),z.val())}),F.click(function(e){e.preventDefault(),ba()}),B.click(function(){w?(w=!1,a(this).removeClass("on"),Qt()):(w=!0,a(this).addClass("on"))}),M.click(function(e){e.preventDefault();var t=O.val()||d.getGlobal("email");t&&_t.val(t),Dt.modal("show"),n.delay(function(){_t.focus().select()},1e3)}),kt.click(function(e){e.preventDefault(),sa(_t.val())}),Et.click(function(e){e.preventDefault(),la(_t.val(),Tt.val())}),Lt.click(function(e){e.preventDefault(),ua(_t.val(),Tt.val(),Rt.val())}),_t.keydown(function(e){13===e.which&&(e.preventDefault(),sa(_t.val()))}),Tt.keydown(function(e){13===e.which&&(e.preventDefault(),la(_t.val(),Tt.val()))}),Rt.keydown(function(e){13===e.which&&(e.preventDefault(),ua(_t.val(),Tt.val(),Rt.val()))}),At.click(function(e){e.preventDefault(),e.stopPropagation()}),Ft.click(function(e){e.preventDefault(),ia(++I)}),Vt.click(function(e){e.preventDefault(),ia(--I)}),Gt.click(function(e){e.preventDefault(),I=1,ia(0),ra()})},jt=function(){p="Demo",h&&Xt()},Ht=function(){var e=d.getGlobal("email");e&&(w=!0,O.val(e),B.addClass("on"),z.focus())},Qt=function(){w?d.setGlobal("email",O.val()):d.removeGlobal("email")},Yt=function(e,t){Wt(),s.login(e,t,aa)},Wt=function(){z.val(""),j.hide(),H.hide()},Xt=function(){var e=window.location.pathname.split("/"),t=e[1];""!==t?s.validateUser(t,function(e){"success"===e.status?qt(t):$t(t)}):h||Jt()},Jt=function(){i.success("Loading Demo"),Zt(),s.demoLogin(),Kt()},qt=function(e){p=e,i.success("Loading User: "+e),ga(e),Kt()},$t=function(e){i.alert('User "'+e+'" not found'),Jt()},Zt=function(){var e=window.location.pathname;history&&"/"!==e&&history.pushState(null,null,"/"),a("body").removeClass("viewOnly")},Kt=function(){Ot.addClass("show"),c.clearItemView(),c.resizePanel(),o.resetItemData(),window.setTimeout(function(){var e=null,t=null,n=o.downloadItemDirectory(),i=c.initializeUserItems(function(t){e=t},function(){e={}}),r=l.getTags(function(e){t=e},function(){});a.when(i,n,r).then(function(){l.getTags_result(t),c.initializeUserItems_result(e),Ot.removeClass("show"),h=!0},function(){})},g)},ea=function(){p="Demo",ha(),c.clearItemView(),m.exitGridView(),s.logout(),Jt()},ta=function(e,t){Wt(),""!==e&&""!==t&&s.createUser(e,t,na)},aa=function(e,t){"success"===e.status?(Qt(),fa(t),Kt()):e.status!==void 0&&"invalid_login"===e.status&&(i.error("Login Failed: "+t),j.fadeIn())},na=function(e,t){e.status!==void 0&&"user_exists"===e.status?H.fadeIn():(Qt(),aa(e,t))},ia=function(e){e&&(D.removeClass(),D.addClass("step"+e)),At.is(":visible")||At.show()},ra=function(){At.is(":visible")&&(At.hide(),D.removeClass())},sa=function(e){s.sendResetPasswordCode(e,oa)},oa=function(e){e.status!==void 0&&"success"===e.status?(kt.hide(),Et.show(),Pt.hide(),xt.show(),St.find(".alertTitle").text("E-mail sent:"),St.show().find(".alertText").html("Check your e-mail and enter the <strong>3-digit code</strong> into the field above"),Ct.hide()):e.status!==void 0&&"invalid_email"===e.status&&(Ct.find(".alertTitle").text("Invalid E-mail address:"),Ct.show().find(".alertText").html("Cannot send password reset code"))},la=function(e,t){s.submitResetPasswordCode(e,t,ca)},ca=function(e){e.status!==void 0&&"success"===e.status?(yt.hide(),Et.hide(),bt.show(),Lt.show(),St.hide(),Ct.hide()):(St.hide(),Ct.find(".alertTitle").text("Invalid code:"),Ct.show().find(".alertText").html("Reset code is incorrect, please try again"))},ua=function(e,t,a){s.updatePassword(e,t,a,function(t){da(t,e,a)})},da=function(e,t,a){e.status!==void 0&&"success"===e.status&&(ma(),O.val(t),z.val(a),Yt(O.val(),z.val()))},ma=function(){Dt.modal("hide"),kt.show(),Et.hide(),Lt.hide(),yt.hide(),bt.hide(),Pt.show(),xt.hide(),St.hide(),Ct.hide(),_t.val(""),Tt.val(""),Rt.val("")},fa=function(e){Zt(),va(),b.find(".userEmail").text(e),y.show()},ga=function(e){va(),a("body").addClass("viewOnly"),b.find(".userEmail").text(e)},pa=function(){va(),a("body").addClass("demo"),b.find(".userEmail").text(p)},ha=function(){wa()},va=function(){a("body").removeClass("infoHeader"),a("body").addClass("useHeader"),c.loggedInView(!0),u.loggedInView(!0),y.show()},wa=function(){a("body").removeClass("useHeader"),a("body").addClass("infoHeader"),a("body").removeClass("viewOnly"),a("body").removeClass("demo"),c.loggedInView(!1),u.loggedInView(!1),y.hide()},Ia=function(){v=f.login,ya(),G.show(),V.hide(),F.removeClass("signup"),F.addClass("login")},Da=function(){v=f.signup,ya(),V.show(),G.hide(),F.removeClass("login"),F.addClass("signup")},ya=function(){Wt(),k.show(),F.show(),w&&""!==O.val()?z.focus():O.focus(),E.hide()},ba=function(){k.hide(),G.hide(),V.hide(),F.hide(),E.show()},xa=function(e){13===e&&v===f.login?Yt(O.val(),z.val()):13===e&&v===f.signup&&ta(O.val(),z.val())},Pa=function(){Ea(),Q.modal("show")},Sa=function(){Ea();var e=s.getUserData();tt.val(e.userName),nt.val(e.email),ct.text("http://www.gamedex.net/"+e.userName),K.modal("show")},Ca=function(){Ea(),ut.modal("show")},_a=function(){Ea();var e=ht.val(),t=s.getUserData().email,a=gt.val(),n=pt.val();""!==e&&""!==t&""!==a&""!==n&a==n&&s.updateUser(e,t,"",a,function(e){"success"===e.status?(wt.fadeIn().find(".alertText").text("Password Changed"),gt.val(""),pt.val(""),ht.val("")):"incorrect_password"===e.status&&(dt.addClass("error"),vt.fadeIn().find(".alertText").text("Incorrect password"),ht.val(""))}),""===a?(ft.addClass("error"),vt.fadeIn().find(".alertText").text("Please enter new password")):""===n?(mt.addClass("error"),vt.fadeIn().find(".alertText").text("Please confirm password")):a!==n?(gt.val(""),pt.val(""),ft.addClass("error"),mt.addClass("error"),vt.fadeIn().find(".alertText").text("Passwords do not match")):""===e&&(dt.addClass("error"),vt.fadeIn().find(".alertText").text("Please enter existing password"))},Ta=function(){Ea();var e=it.val(),t=nt.val(),a=tt.val();""!==e&&""!==t&&s.updateUser(e,t,a,"",function(e){"success"===e.status?(ct.text("http://www.gamedex.net/"+a),b.find(".userEmail").text(t),it.val(""),st.fadeIn().find(".alertText").text("Account updated")):"incorrect_password"===e.status?(it.val(""),rt.addClass("error"),ot.fadeIn().find(".alertText").text("Incorrect password")):"username_exists"===e.status&&(et.addClass("error"),ot.fadeIn().find(".alertText").text("User name exists"))}),""===e&&(rt.addClass("error"),ot.fadeIn().find(".alertText").text("Please enter existing password")),""===t&&(at.addClass("error"),ot.fadeIn().find(".alertText").text("E-mail cannot be blank")),gt.val("")},Ra=function(){Ea();var e=J.val(),t=s.getUserData().email;""!==e&&""!==t?s.verifyUser(t,e,function(e){e.status!==void 0&&"success"==e.status?(Q.modal("hide"),$.modal("show")):(J.val(""),X.addClass("error"),W.show().find(".alertText").html("Incorrect Password"))},function(){J.val("")}):(X.addClass("error"),W.show().find(".alertText").html("Please enter existing password"))},ka=function(){var e=J.val(),t=s.getUserData().user_id;J.val(""),s.deleteAccount(t,e,function(){$.modal("hide"),d.clearStorage(),ea()},function(){})},Ea=function(){W.hide(),X.removeClass("error"),et.removeClass("error"),at.removeClass("error"),rt.removeClass("error"),st.hide(),ot.hide(),ft.removeClass("error"),mt.removeClass("error"),dt.removeClass("error"),wt.hide(),vt.hide()},La={init:zt,hideSiteGuide:ra};a.extend(e,La)}(gamedex.module("siteView"),gamedex,jQuery,_,alertify,Opentip),function(e,t,a,n,i,r){"use strict";var s=t.module("detailView"),o=t.module("amazon"),l=t.module("giantbomb"),c=t.module("utilities"),u=t.module("ign"),d=t.module("releasedList"),m=t.module("itemLinker"),f={POPULAR:0,UPCOMING:1,RELEASED:2,REVIEWED:3},g={"#searchTab":0,"#listTab":1},p=400,h={List:0,Icons:1,Cover:2},v=258,w=503,I=5,D=13,y=1500,b=1,x=null,P="skyrim",S="",C={},_=[],T=g["#searchTab"],R=!1,k=-1,E=-1,L=-1,N=!1,U=!1,A=!1,G=null,V=0,F=null,O=h.Icons,z=0,B=null,M=h.Icons,j=w,H=null,Q={valueNames:["itemName","releaseDate"],item:"list-item"},Y=a("#searchContainer"),W=a("#searchViewMenu"),X=a("#listType"),J=X.find(".listTypeName"),q=a("#searchPlatforms"),$=a("#legacySubNav"),Z=(a("#platformSelect_btn"),a("#listPlatforms")),K=a("#listPlatforms").find("ul"),et=q.find(".platformName"),tt=Z.find(".platformName"),at=a("#finderTabLinks"),nt=(a("#finderTabContent"),a("#searchTab"),a("#listTab"),a("#searchTabLink")),it=a("#listTabLink"),rt=a("#searchField"),st=a("#search_btn"),ot=a("#clearSearch_btn"),lt=(ot.find("i"),a("#searchResultsContainer")),ct=lt.find(".content"),ut=a("#searchResults"),dt=rt.find("input"),mt=a("#listResultsContainer"),ft=mt.find(".content"),gt=a("#listResults"),pt=gt.find(".list"),ht=Y.find(".searchDisplayOptions"),vt=Y.find(".listDisplayOptions"),wt=lt.find(".loadingStatus"),It=mt.find(".loadingStatus"),Dt=n.template(a("#search-results-template").html()),yt=n.template(a("#list-results-template").html()),bt=n.template(a("#list-platform-template").html()),xt=n.template(a("#search-results-platform-dropdown-template").html());e.init=function(){e.createEventHandlers(),_t(),B=c.PLATFORM_INDEX[0],F=c.getStandardPlatform(""),Wt(!1);var t={sliderMinHeight:20,iOSNativeScrolling:!0,preventPageScrolling:!0};lt.nanoScroller(t),mt.nanoScroller(t),setInterval(function(){Xt(),lt.nanoScroller(),mt.nanoScroller()},1500),ft.on("scroll",function(){var t=ft.scrollTop(),a=gt.height(),n=ft.height(),i=a-(t+n);y>i&&(R||(R=!0,e.loadNextListPages()))}),$.BootstrapSubMenu({$mainNav:q})},e.createEventHandlers=function(){at.find('a[data-toggle="tab"]').on("shown",function(e){T=g[a(e.target).attr("href")],Nt(T)}),dt.keyup(jt),W.on("mouseenter",".dropdown-toggle",function(){var e=this;W.find(".dropdown").each(function(){a(this).hasClass("open")&&a(this).find(".dropdown-toggle").get(0)!==a(e).get(0)&&a(e).trigger("click")})}),X.find("li a").click(function(e){e.preventDefault(),X.attr("data-content",a(this).attr("data-content")),Ut()}),Z.on("click","li a",function(e){e.preventDefault(),a(this).attr("data-content")&&At(a(this).attr("data-content"),a(this).text())}),q.find("li:not(.dropdown-sub) a").click(function(e){e.preventDefault(),Gt(a(this).attr("data-content"),a(this).text())}),ut.on("click","tr",Ht),gt.on("click","tr",Qt),ut.on("click",".dropdown-menu li",function(e){e.preventDefault(),Yt(this)}),ht.on("click","button",function(e){e.preventDefault(),Bt(a(this).attr("data-content"),!1,a(this))}),vt.on("click","button",function(e){e.preventDefault(),(G==f.UPCOMING||G==f.RELEASED||G==f.REVIEWED||G==f.POPULAR)&&Bt(a(this).attr("data-content"),!1,a(this))}),st.click(function(t){t.preventDefault(),e.search(P)}),ot.click(function(){dt.val(""),dt.focus(),Wt(!1)}),ut.resize(e.resizePanel),gt.resize(e.resizePanel),a(window).resize(e.resizePanel)},e.renderSearchResults=function(e){_=[],wt.removeClass("show"),n.each(e,function(e){_.push(e)}),_.sort(Lt);var t={sortedSearchResults:_};t.displayType=M,ut.html(Dt(t))},e.renderListResults=function(e,t){It.removeClass("show");var a={listResults:e};pt.append(yt(a)),"none"!==t&&St(t)},e.search=function(e){""===e?Wt(!1):Wt(!0),T!==g["#searchTab"]&&(nt.trigger("click"),Nt(g["#searchTab"])),e!==S&&(Pt(),lt.find(".noResults").hide(),wt.addClass("show"),S=e,o.searchAmazon(e,B.amazon,function(t){Tt(t,e)}),l.searchGiantBomb(e,function(t){Rt(t,e)}))},e.loadNextListPages=function(){switch(It.addClass("show"),G){case f.POPULAR:e.getIGNPopularList(F,L+1);break;case f.UPCOMING:e.getIGNUpcomingList(F,k+1);break;case f.RELEASED:break;case f.REVIEWED:e.getIGNReviewedList(F,E+1)}},e.getIGNPopularList=function(e,t){function a(e){0===e.length&&(A=!0),R=!1,Ct(e,"none",f.POPULAR),L++}if(A)return It.removeClass("show"),void 0;for(var n=0;b>n;n++)u.getPopularGames(e.ign,t+n,a)},e.getIGNUpcomingList=function(e,t){function a(e){0===e.length&&(N=!0),R=!1,Ct(e,"asc",f.UPCOMING),k++}if(N)return It.addClass("show"),void 0;for(var n=0;b>n;n++)u.getUpcomingGames(e.ign,t+n,a)},e.getIGNReviewedList=function(e,t){function a(e){0===e.length&&(U=!0),R=!1,Ct(e,"desc",f.REVIEWED),E++}if(U)return It.remove("show"),void 0;for(var n=0;b>n;n++)u.getReviewedGames(e.ign,t+n,a)},e.getGTReleasedList=function(e){function t(e,t){Ct(e,"desc",f.RELEASED,t)}for(var a=14,n=i().day(0),r=n,s=0,o=a;o>s;s++)d.getReleasedGames(e.id,r.year(),r.month()+1,r.date(),t),r=r.subtract("weeks",1)},e.resizePanel=function(){var e=null,t=null;switch(T){case g["#searchTab"]:e=ut.height(),t=lt,wt.is(":visible")&&(e+=wt.height());break;case g["#listTab"]:e=gt.height(),It.is(":visible")&&(e+=It.height()),t=mt}var n=a(window).height();if(n-j>e)t.css({height:e+I});else{var i=n-j;t.css({height:i+D})}},e.loggedInView=function(t){j=t?v:w,e.resizePanel()};var Pt=function(){ut.empty(),wt.addClass("show"),C={},_=[]},St=function(e){H=new r("listResults",Q),"asc"===e?H.sort("releaseDate",{sortFunction:Jt}):H.sort("releaseDate",{sortFunction:qt})},Ct=function(t,a,n,i){i=i!==void 0?i:null,i&&_t(i),n===G&&e.renderListResults(t,a)},_t=function(e){var t={};e!==void 0&&e?n.each(e,function(e,a){t[a]="("+e+") "}):t={all:"",pc:"",x360:"",xbl:"",ps3:"",psn:"",vita:"",ds:"","3ds":"",wii:"",wiiu:""},K.html(bt({found:t}))},Tt=function(t,n){var i={},r={};a("Item",t).each(function(){if(r=o.parseAmazonResultItem(a(this)),r.isFiltered===void 0){var e=r.releaseDate.split("-"),t=parseInt(e[0],10)-100;r.sortDate=t+"-"+e[1]+"-"+e[2],i[r.id]=r}}),a.extend(!0,C,i),P===n&&e.renderSearchResults(C)},Rt=function(t,i){var r=t.results,s={},o={};n.each(r,function(e){o=l.parseGiantBombResultItem(e),o.sortDate=o.releaseDate,"1900-01-01"==o.releaseDate&&(o.sortDate="2100-01-01"),s[o.id]=o}),a.extend(!0,C,s),P===i&&(e.renderSearchResults(C),n.each(r,function(e){n.delay(function(){kt(e.platforms,e.id)},500)}))},kt=function(t,a){var i=[],r="";if(t){n.each(t,function(e){r=c.matchPlatformToIndex(e.platform.name).name||e.platform.name,"Mac"!==r&&i.push(r)}),Et(a,i);var s=e.getSearchResult(a);s&&(s.platformList=i,s.platform=i[0])}},Et=function(e,t){var n={platformList:t,gbombID:e};a("#"+e).find(".platformDropdown").html(xt(n))},Lt=function(e,t){var a=i(e.sortDate),n=i(t.sortDate);return n>a?1:-1};e.getSearchResult=function(e){return C[e]};var Nt=function(e){switch(e){case 0:lt.nanoScroller({scrollTop:z-1}),Ot(!0),zt(!1);break;case 1:mt.nanoScroller({scrollTop:parseInt(V-1,10)}),zt(!0),Ot(!1),Ut()}},Ut=function(){var e=parseInt(X.attr("data-content"),10);if(e!==G){switch(e){case 0:Bt(O),vt.find("button:eq("+O+")").button("toggle"),vt.fadeTo(100,1),J.text("Popular"),G=f.POPULAR;break;case 1:Bt(O),vt.find("button:eq("+O+")").button("toggle"),vt.fadeTo(100,1),J.text("Upcoming"),G=f.UPCOMING;break;case 2:Bt(O),vt.find("button:eq("+O+")").button("toggle"),vt.fadeTo(100,1),J.text("Released"),G=f.RELEASED;break;case 3:Bt(O),vt.find("button:eq("+O+")").button("toggle"),vt.fadeTo(100,1),J.text("Reviewed"),G=f.REVIEWED}Ft(G)}},At=function(e,t){tt.text(t),F=c.getStandardPlatform(e),Ft(G)},Gt=function(t,a){S="",et.text(a),B=c.getStandardPlatform(t),e.search(P)},Vt=function(e){switch(e){case 0:nt.tab("show");break;case 1:it.tab("show")}},Ft=function(t){function a(){tt.text(tt.text().split(" (")[0])}switch(R=!1,U=!1,N=!1,A=!1,k=-1,E=-1,L=-1,_t(),It.addClass("show"),pt.empty(),t){case f.POPULAR:a(),e.getIGNPopularList(F,0);break;case f.UPCOMING:a(),e.getIGNUpcomingList(F,0);break;case f.RELEASED:e.getGTReleasedList(F);break;case f.REVIEWED:e.getIGNReviewedList(F,0)}},Ot=function(e){e?(ht.show(),q.show()):(ht.hide(),q.hide())},zt=function(e){e?(vt.show(),Z.show(),X.show()):(vt.hide(),Z.hide(),X.hide())},Bt=function(e,t,a){t=t!==void 0?t:!1,a&&a.addClass("active").siblings().removeClass("active"),T===g["#searchTab"]?(M=e,ut.find("tbody").removeClass().addClass("display-"+e)):gt.find("tbody").hasClass("display-"+e)===!1&&(t||(O=e),mt.find(".content").removeClass("display-0").removeClass("display-1").removeClass("display-2").addClass("display-"+e))},Mt=function(){clearTimeout(x),e.search(P)},jt=function(t){P=dt.val(),P!==S&&Pt(),x&&clearTimeout(x),13==t.which?e.search(P):x=setTimeout(Mt,p)},Ht=function(){var t=e.getSearchResult(a(this).attr("id"));s.viewFirstSearchItemDetail(t)},Qt=function(){Xt(),P=m.standardizeTitle(a(this).find(".itemName").text()),Vt(g["#searchTab"]),dt.val(P),Gt(F.id,F.name),e.search(P)},Yt=function(t){var n=e.getSearchResult(a(t).attr("data-content"));n.platform=a(t).find("a").text(),a(t).parent().siblings(".dropdown-toggle").html(n.platform).append('<b class="caret"></b>')},Wt=function(e){e?rt.addClass("showAddOn"):rt.removeClass("showAddOn")},Xt=function(){T===g["#searchTab"]?z=ct.scrollTop()||1:T===g["#listTab"]&&(V=ft.scrollTop()||1)},Jt=function(e,t){var n=a(e.elm).find(".releaseDate"),i=a(t.elm).find(".releaseDate"),r=Date.parse(n.text()),s=Date.parse(i.text());return r-s},qt=function(e,t){var n=a(e.elm).find(".releaseDate"),i=a(t.elm).find(".releaseDate"),r=Date.parse(n.text()),s=Date.parse(i.text());return s-r}}(gamedex.module("searchView"),gamedex,jQuery,_,moment,List),function(e,t,a,n,i){var r=(t.module("user"),t.module("tagView")),s=t.module("utilities"),o=(t.module("searchView"),t.module("itemView")),l=t.module("itemData"),c=t.module("amazon"),u=t.module("itemLinker"),d=t.module("metacritic"),m=t.module("giantbomb"),f=t.module("wikipedia"),g=t.module("gameTrailers"),p=t.module("steam"),h=t.module("videoPanel"),v=["#amazonTab","#giantBombTab"],w={0:"None",1:"Own",2:"Sold",3:"Wanted"},I={0:"Not Started",1:"Playing",2:"Played",3:"Finished"},D={NEW:0,EXISTING:1},y=!1,b=null,x=null,P=v[0],S=null,C=!1,_=D.NEW,T={},R={},k={},E=null,L=null,N=a("#detailTabContent"),U=a("#amazonTab"),A=a("#giantBombTab"),G=a("#amazonTabLink"),V=a("#giantBombTabLink"),F=U.find(".itemDetailThumbnail"),O=A.find(".itemDetailThumbnail"),z=F.find(".itemDetailInfo"),B=O.find(".itemDetailInfo"),M=N.find(".showVideo_btn"),j=N.find(".showDiscussion_btn"),H=a("#detailContainer"),Q=(a("#addListContainer"),a("#addList")),Y=a("#saveItem_btn"),W=a("#addItem_btn"),X=a("#itemAttributes"),J=a("#platform"),q=a("#releaseDate"),$=a("#wikipediaPage"),Z=a("#gametrailersPage"),K=a("#giantBombPage"),et=a("#metacriticPage"),tt=X.find("#priceHeader"),at=X.find("#amazonPriceNew"),nt=X.find("#amazonPriceUsed"),it=X.find("#steamPrice"),rt=a("#gameStatus"),st=a("#playStatus"),ot=a("#userRating"),lt=a("#ratingCaption");n.template(a("#description-modal-template").html()),e.init=function(){e.createEventHandlers(),Y.hide(),X.hide(),Rt(),ot.stars({split:2,captionEl:lt,callback:function(e,t,a){T.userRating=a,Ft(T)}})},e.createEventHandlers=function(){J.click(function(e){e.preventDefault()}),q.click(function(e){e.preventDefault()}),G.click(function(e){e.preventDefault(),e.stopPropagation(),Tt(s.SEARCH_PROVIDERS.Amazon)}),V.click(function(e){e.preventDefault(),e.stopPropagation(),Tt(s.SEARCH_PROVIDERS.GiantBomb)}),M.click(function(e){e.preventDefault(),C&&h.showVideoPanel()}),j.click(function(e){e.preventDefault(),pt()}),F.click(function(){}),O.click(function(){}),Y.click(function(e){e.preventDefault(),Gt(T)}),W.click(function(e){e.preventDefault(),Gt(T)}),rt.find("li a").click(function(e){e.preventDefault(),T.gameStatus=a(this).attr("data-content"),rt.find(".currentSelection").text(w[T.gameStatus]),Ft(T)}),st.find("li a").click(function(e){e.preventDefault(),T.playStatus=a(this).attr("data-content"),st.find(".currentSelection").text(I[T.playStatus]),Ft(T)}),a('#detailTab a[data-toggle="tab"]').on("shown",function(e){P=a(e.target).attr("href")}),Q.change(jt)},e.viewFirstSearchItemDetail=function(e){(e.id!==T.id||e.platform!==T.platform)&&(_t(),Rt(),T=a.extend(!0,{},e),b=Et(T.asin,T.gbombID),T.initialProvider=b,T.standardName=u.standardizeTitle(T.name),k=l.getItemByThirdPartyID(T.gbombID,T.asin),S=T.id,kt(b),Tt(b),u.findItemOnAlternateProvider(T,b,!0,function(e){return function(t){ut(t,e)}}(S),function(){}),Nt(T,k),Ut(T,k),ct(T,!0),dt(T,b,0))},e.viewItemDetail=function(t){_t(),Rt(),Lt(D.EXISTING),T=a.extend(!0,{},t),T.standardName=u.standardizeTitle(T.name),b=parseInt(T.initialProvider,10),k=l.getDirectoryItemByItemID(T.itemID),S=T.id,kt(b),Tt(b),u.getLinkedItemData(T,b,e.viewSecondItemDetail),r.selectTagsFromDirectory(k.tags),Ut(T,k),ct(T,!1),mt(T,b,0,t)
},e.viewSecondItemDetail=function(e){R=a.extend(!0,{},e);var t=null;console.info(T,R),(T.asin==R.asin||T.gbombID==R.gbombID)&&(t=Et(R.asin,R.gbombID),mt(R,t,1))},e.resetDetail=function(){r.resetAddList(),Lt(D.NEW)},e.getViewingItemID=function(){return T.id};var ct=function(e,t){f.getWikipediaPage(e.standardName,e,Dt),It(e.standardName,e,t),g.getGametrailersPage(e.standardName,e,yt),p.getSteamGame(e.standardName,e,bt)},ut=function(e,t){if(R=a.extend(!0,{},e),S===t){var n=Et(R.asin,R.gbombID);switch(n){case s.SEARCH_PROVIDERS.Amazon:T.asin=R.asin;break;case s.SEARCH_PROVIDERS.GiantBomb:T.gbombID=R.gbombID}dt(R,n,1)}},dt=function(e,t,a){vt(t,e),ht(e,a),xt(t,T)},mt=function(e,t,a){vt(t,e),ht(T,a),xt(t,T)},ft=function(e,t){t.find(".itemDetailTitle h3").text(e.name),gt(t.find("img"),e.largeImage,t)},gt=function(e,t,a){var n=new Image;a.find(".loadingDetailImage").addClass("show"),n.src=t,n.onload=function(){e.attr("src",t),a.find(".loadingDetailImage").removeClass("show")}},pt=function(){o.viewDiscussion();var e=T.standardName;DISQUS.reset({reload:!0,config:function(){this.page.identifier=e,this.page.url="http://www.gamedex.net/#!"+e}})},ht=function(e,t){X.is(":visible")||X.fadeIn(),("n/a"!==e.platform||0===t)&&J.find(".data").text(e.platform),"1900-01-01"!==e.releaseDate?(0===t||"1900-01-01"===T.releaseDate)&&(T.releaseDate=e.releaseDate,T.calendarDate=i(e.releaseDate,"YYYY-MM-DD").calendar(),q.find(".data").text(T.calendarDate)):"1900-01-01"===T.releaseDate&&q.find(".data").text("unknown")},vt=function(e,t){switch(y||(a("#dataTab").show(),a(".detailTitleBar").show(),y=!0),e){case s.SEARCH_PROVIDERS.Amazon:ft(t,U);break;case s.SEARCH_PROVIDERS.GiantBomb:ft(t,A)}},wt=function(e){e.find(".itemDetailTitle h3").text("No Match found"),e.find("img").attr("src","http://d2sifwlm28j6up.cloudfront.net/no_selection_placeholder.png")},It=function(e,t,n){function i(e){if(S===e.id||S===e.asin||S===e.gbombID)for(var t=0,a=v.length;a>t;t++)r=v[t]+" .metascore",d.displayMetascoreData(e.metascorePage,e.metascore,r),""!==e.metascorePage&&(et.show(),et.find("a").attr("href","http://www.metacritic.com"+e.metascorePage))}for(var r="",s=0,o=v.length;o>s;s++)r=v[s]+" .metascore",a(r).hide();E=d.getMetascore(e,t,n,i)},Dt=function(e){e&&($.show(),$.find("a").attr("href",e))},yt=function(e){e&&(Z.show(),Z.find("a").attr("href",e))},bt=function(e){""!==e.steamPrice?(tt.show(),it.find(".data").text(e.steamPrice),it.find("a").attr("href",e.steamPage),it.show()):it.hide()},xt=function(e,t){switch(e){case s.SEARCH_PROVIDERS.Amazon:c.getAmazonItemOffers(t.asin,t,Pt);break;case s.SEARCH_PROVIDERS.GiantBomb:m.getGiantBombItemData(t.gbombID,St)}},Pt=function(e){(n.has(e,"buyNowPrice")&&""!==e.buyNowPrice||n.has(e,"lowestUsedPrice")&&""!==e.lowestUsedPrice)&&tt.show(),n.has(e,"buyNowPrice")&&""!==e.buyNowPrice?(at.find("a").attr("href",e.productURL),at.find(".data").text(e.buyNowPrice),at.show()):at.hide(),n.has(e,"lowestUsedPrice")&&""!==e.lowestUsedPrice?(nt.find(".data").text(e.lowestUsedPrice),nt.find("a").attr("href",e.offersURLUsed),nt.show()):nt.hide()},St=function(e){K.show(),K.find("a").attr("href",e.site_detail_url),Ct(e.videos,T.name)},Ct=function(e,t){0!==e.length&&(h.initializeVideoPanel(e,t),C=!0,M.removeClass("noVideos"),M.find("span").text("Show Videos"))},_t=function(){C=!1,M.addClass("noVideos"),M.find("span").text("No Videos")},Tt=function(e){switch(e){case s.SEARCH_PROVIDERS.Amazon:x=e,z.append(H),G.tab("show");break;case s.SEARCH_PROVIDERS.GiantBomb:x=e,B.append(H),V.tab("show")}},Rt=function(){$.hide(),K.hide(),Z.hide(),et.hide(),tt.hide(),at.hide(),nt.hide(),it.hide()},kt=function(e){switch(e){case s.SEARCH_PROVIDERS.Amazon:wt(A);break;case s.SEARCH_PROVIDERS.GiantBomb:wt(U)}},Et=function(e,t){var a=null;return 0!==e?a=s.SEARCH_PROVIDERS.Amazon:0!==t&&(a=s.SEARCH_PROVIDERS.GiantBomb),a},Lt=function(e){e===D.EXISTING?(_=D.EXISTING,W.hide(),Y.hide()):e===D.NEW&&(_=D.NEW,Y.hide(),W.show())},Nt=function(e,t){t&&t.tagCount>0?(Lt(D.EXISTING),e.itemID=t.itemID,r.selectTagsFromDirectory(t.tags)):(Lt(D.NEW),r.selectUserTags())},Ut=function(e,t){t?(e.gameStatus=t.gameStatus,e.playStatus=t.playStatus,e.userRating=t.userRating):(e.gameStatus="0",e.playStatus="0",e.userRating="0"),At(e)},At=function(e){rt.find(".currentSelection").text(w[e.gameStatus]),st.find(".currentSelection").text(I[e.playStatus]),ot.stars("select",e.userRating),lt.text(e.userRating/2),rt.find(".currentSelection").attr("data-initial",e.gameStatus),st.find(".currentSelection").attr("data-initial",e.playStatus),ot.attr("data-initial",e.userRating)},Gt=function(e){var t=r.getTagsToAdd(),a=r.getTagsToDelete(),n=a.idsToDelete,i=a.tagsToDelete;t.length>0&&(x!==b&&(x==s.SEARCH_PROVIDERS.Amazon&&0!==e.asin||x==s.SEARCH_PROVIDERS.GiantBomb&&0!==e.gbombID)&&(e.initialProvider=x,e.largeImage=R.largeImage,e.smallImage=R.smallImage,e.thumbnailImage=R.thumbnailImage),L=l.addItemToTags(t,e,zt)),n.length>0&&l.deleteTagsForItem(n,i,e,Bt),Vt(e),Ht()},Vt=function(e){(n.isUndefined(e.metascore)||null===e.metascore)&&a.when(E,L).then(function(){l.updateMetacritic(T),o.refreshView()},function(){}),b===s.SEARCH_PROVIDERS.Amazon&&0===e.gbombID||b===s.SEARCH_PROVIDERS.Amazon&&0===e.asin},Ft=function(e){Mt()&&_===D.EXISTING&&l.updateUserItem(e,Ot)},Ot=function(e,t){"success"===t.status&&(At(e),o.updateListAttributesChanged(e))},zt=function(e,t){_!==D.EXISTING&&Lt(D.EXISTING),o.updateListAdditions(e,t)},Bt=function(e,t){o.updateListDeletions(e,t)},Mt=function(){var e=rt.find(".currentSelection").attr("data-initial"),t=st.find(".currentSelection").attr("data-initial"),a=ot.attr("data-initial");return e!==T.gameStatus||t!==T.playStatus||a!==T.userRating?!0:!1},jt=function(e){y&&!e.reset&&(_===D.NEW&&r.updateUserTags(),Ht())},Ht=function(){_===D.EXISTING&&r.isAddListChanged()?Y.fadeIn():Y.fadeOut()}}(gamedex.module("detailView"),gamedex,jQuery,_,moment),function(e,t,a,n,i){"use strict";var r=t.module("user"),s=t.module("siteView"),o=t.module("tagView"),l=t.module("utilities"),c=t.module("detailView"),u=t.module("importView"),d=t.module("gridView"),m=t.module("itemData"),f=(t.module("itemCache"),t.module("tagData")),g=t.module("amazon"),p=t.module("metacritic"),h=(t.module("itemLinker"),t.module("filterPanel")),v=(t.module("giantbomb"),t.module("steam")),w={List:0,Icons:1},I={collection:"collection",discussion:"discussion"},D={alphabetical:0,metascore:1,releaseDate:2,platform:3,price:4},y=230,b=460,x=10,P=50,S=5,C=10,_="0",T="View All",R=null,k={valueNames:["itemName","metascore","releaseDate","platform","gameStatus","playStatus","userRating"],item:"list-item"},E=_,L=w.Icons,N=0,U=!1,A=!1,G=null,V=b,F=!1,O=I.collection,z=a("#wrapper"),B=a("#itemResults tbody"),M=a("#resizeContainer"),j=a("#viewItemsContainer"),H=a("#itemResultsContainer"),Q=j.find(".displayOptions"),Y=a("#gridView_btn"),W=a("#showCollection_btn"),X=a("#viewList"),J=X.find(".viewName"),q=a("#itemViewMenu"),$=a("#editMenu"),Z=j.find(".sortOptions"),K=Z.find(".sortType"),et=j.find(".filterOptions"),tt=a("#platformFilterSubNav"),at=et.find(".clearFilters_btn"),nt=et.find(".filterType"),it=a("#applyFilters_btn"),rt=a("#deleteListConfirm-modal"),st=a("#deleteListConfirm_btn"),ot=a("#deleteList_btn"),lt=ot.find(".listName"),ct=a("#importMenu"),ut=a("#error-modal"),dt=a("#updateList-modal"),mt=a("#tagNameField"),ft=a("#updateListConfirm_btn"),gt=a("#editList_btn"),pt=H.find(".loadingStatus"),ht=n.template(a("#price-menu-template").html()),vt=n.template(a("#steam-price-menu-template").html()),wt=n.template(a("#item-results-template").html()),It=function(){Dt();var e={sliderMinHeight:20,iOSNativeScrolling:!0,preventPageScrolling:!0,flash:!0,flashDelay:1500};H.nanoScroller(e),setInterval(function(){H.nanoScroller()},1500),ra(!1),tt.BootstrapSubMenu({$mainNav:et})},Dt=function(){q.on("mouseenter",".dropdown-toggle",function(){var e=this;q.find(".dropdown").each(function(){a(this).hasClass("open")&&a(this).find(".dropdown-toggle").get(0)!==a(e).get(0)&&a(e).trigger("click")})}),X.find("ul").on("click","a",function(e){e.preventDefault(),Ft(a(this).attr("data-content"))}),it.click(function(e){e.preventDefault(),z.hasClass("gridView")||(ra(!0),ia(0))}),at.click(function(e){e.preventDefault(),ra(!1),nt.text("None"),h.resetFilters(),ia()}),j.on("click","#itemResults tr",function(){Xt(a(this).attr("id"))}),B.on("click",".deleteItem_btn",function(e){e.preventDefault();var t=a(this).attr("data-content");Jt(t)}),B.on("click",".quickAttributes a",function(e){e.preventDefault(),e.stopPropagation();var t=parseInt(a(this).attr("data-content"),10),n=a(this).parent().parent().attr("data-content");ta(a(this),n,t)}),ot.click(function(e){e.preventDefault(),s.hideSiteGuide(),o.getTagCount()>1?rt.modal("show"):(ut.find(".alertTitle").text("Tag Delete Error"),ut.find(".alertText").text("Cannot delete last tag"),ut.modal("show"))}),st.click(function(e){e.preventDefault(),rt.modal("hide"),$t(E)}),dt.find("form").submit(function(e){e.preventDefault(),Kt(E,mt.val()),dt.modal("hide")}),ft.click(function(e){e.preventDefault(),Kt(E,mt.val()),dt.modal("hide")}),gt.click(function(e){e.preventDefault(),s.hideSiteGuide();var t=o.getTagName(E);mt.val(t),dt.modal("show"),n.delay(function(){mt.focus().select()},1e3)}),ct.find("li").click(function(e){e.preventDefault(),s.hideSiteGuide(),u.startImport(parseInt(a(this).attr("data-importSource"),10))}),Q.find("button").click(function(e){e.preventDefault(),ua(a(this))}),Z.find("li a").click(function(e){e.preventDefault(),sa(parseInt(a(this).attr("data-content"),10))}),et.find("li:not(.dropdown-sub) a").click(function(e){e.preventDefault(),G=a(this).attr("data-content"),"0"==G?(s.hideSiteGuide(),h.showFilterPanel()):(ra(!0),nt.text(a(this).text()),na(G))}),Y.click(function(e){e.preventDefault(),s.hideSiteGuide(),Vt()}),W.click(function(e){e.preventDefault(),At()}),M.resize(Ct),a(window).resize(Ct)},yt=function(e){St();var t=0,i=500,r=25,s=0,o=[];B.addClass("list display-"+L),n.each(e,function(e){Bt(e),t++,o.push(e),0===t%r&&(function(e,t,a){n.delay(function(){bt(t,a),t=[]},i*s)}(t,a.extend(!0,{},o),E),s++,o=[])}),n.delay(function(){bt(o,E),o=[],xt(e,t)},i*s)},bt=function(e,t){if(t===E){var a={items:e,length:length};a.currentViewTagID=E,B.append(wt(a))}},xt=function(e,t){t>0&&(B.find(".quickAttributes a").each(function(e,t){var n=a(t);n.opentip(n.attr("data-ot"),{tipJoint:"bottom"})}),n.each(e,function(e){Qt(e)}),n.each(e,function(e){zt(e)}),R=new i("itemResultsContainer",k),sa(N),ia(),U=!1)},Pt=function(e){return m.getItem(e)},St=function(){B.empty()},Ct=function(){var e=a(window).height(),t=M.height(),n=0,i=0;if(pt.is(":visible")&&(t+=pt.height()),O===I.discussion&&(n=P,i=x),e-V>t-n)H.css({height:t+S+i});else{var r=e-V;H.css({height:r+C+n})}},_t=function(e){V=e?y:b,Ct()},Tt=function(e,t){return E=_,m.getItems(_,e,t)},Rt=function(e){m.itemsAndDirectoryLoaded(e),Ft(_),a.isEmptyObject(e)?c.resetDetail():Wt()},kt=function(e,t){for(var n=null,i=0,r=t.length;r>i;i++)E===_?(n=m.getDirectoryItemByItemID(e).tagCount,0===n&&a("#"+e).remove()):E===t[i]&&a("#"+e).remove()},Et=function(e){var t=!1;if(o.updateViewList(e.tagIDsAdded,E),E!==_)for(var a=0,n=e.tagIDsAdded.length;n>a;a++)e.tagIDsAdded[a]==E&&(t=!0);else m.getDirectoryItemByItemID(e.itemID).tagCount>=1&&(t=!0);t&&Ft(E)},Lt=function(){A=!0},Nt=function(e,t,a,n){G=t,Ft(e),nt.text(a),ra(n)},Ut=function(){O=I.discussion,j.removeClass().addClass(O)},At=function(){O=I.collection,j.removeClass().addClass(O)},Gt=function(){Ot(E)},Vt=function(){d.showGridView(E,G,nt.text(),F)},Ft=function(e){var t="";e!==_?(t=o.getTagName(e),lt.text(t),$.show()):(t=T,$.hide()),J.text(t),Ot(e)},Ot=function(e,t){E=e,m.getItems(e,function(e){yt(e),t&&t()},function(){yt({})})},zt=function(e){zt.getAmazonItemOffersLimited===void 0&&(zt.getAmazonItemOffersLimited=function(e){g.getAmazonItemOffers(e.asin,e,function(t){Mt(e.id,e,t),m.updateSharedItemPrice(e,l.PRICE_PROVIDERS.Amazon,function(){})})}.lazy(250,2e3)),r.isViewUser()||!n.isUndefined(e.offers)&&0!==n.keys(e.offers).length?Mt(e.id,e,e.offers):zt.getAmazonItemOffersLimited(e),!r.isViewUser()&&n.isUndefined(e.steamPrice)?v.getSteamGame(e.standardName,e,function(t){jt(e.id,e,t),m.updateSharedItemPrice(e,l.PRICE_PROVIDERS.Steam,function(){})},function(){m.updateSharedItemPrice(e,l.PRICE_PROVIDERS.Steam,function(){})}):jt(e.id,e,e),r.isViewUser()||null!==e.metascore&&null!==e.metascorePage&&""!==e.metascorePage||p.getMetascore(e.standardName,e,!1,Yt)},Bt=function(e){var t=m.getDirectoryItemByItemID(e.itemID);t&&(e.gameStatus=t.gameStatus,e.playStatus=t.playStatus,e.userRating=t.userRating)},Mt=function(e,t,i){if(i.productURL!==void 0){n.isUndefined(i.lowestNewPrice)&&(i.lowestNewPrice=""),n.isUndefined(i.lowestUsedPrice)&&(i.lowestUsedPrice="");var r="#"+e+" .priceDetails",s=Ht(t);"amazon"==s&&(a(r).html(ht(i)),a(r).find(".priceButton").opentip(a(r).find(".priceButton").attr("data-ot"),{tipJoint:"bottom"}))}},jt=function(e,t,n){if(""!==n.steamPrice){var i="#"+e+" .priceDetails",r=Ht(t);"steam"==r&&(n.steamPageDisplay=n.steamPage.split(".com")[1].split("?")[0],a(i).html(vt(n)),a(i).find(".priceButton").opentip(a(i).find(".priceButton").attr("data-ot"),{tipJoint:"bottom"}))}},Ht=function(e){var t=9999,a=9999,i=9999,r=9999,s="amazon";return n.isUndefined(e.offers)||(n.isUndefined(e.offers.buyNowPrice)||(t=parseFloat(e.offers.buyNowPrice),i=t),n.isUndefined(e.offers.lowestNewPrice)||(a=parseFloat(e.offers.lowestNewPrice))),n.isUndefined(e.steamPrice)||(r=parseFloat(e.steamPrice)),t>a&&(i=a),i>r&&(s="steam"),s},Qt=function(e){e.displayMetascore=-1===e.metascore?"n/a":e.metascore,Yt(e)},Yt=function(e){var t="#"+e.id+" .metascore";p.displayMetascoreData(e.metascorePage,e.metascore,t)},Wt=function(){var e=m.getRandomItemID();Xt(e)},Xt=function(e){var t=Pt(e);c.viewItemDetail(t)},Jt=function(e){m.deleteSingleTagForItem(e,E,qt),c.getViewingItemID()===e&&o.removeTagFromAddList(E),a("#"+e).remove()},qt=function(){},$t=function(e){o.deleteTag(e,function(){Zt()})},Zt=function(){Ft(_)},Kt=function(e,t){f.updateTag(t,e,function(){}),o.getTags(function(e){o.getTags_result(e)}),ea(t,e)},ea=function(e){J.text(e),mt.val(e)},ta=function(e,t,a){if(!r.isViewUser()){var n=Pt(t);switch(A=!0,a){case 0:"1"===n.playStatus?(aa(e,"0"),e.parent().removeClass().addClass("playStatus-0"),n.playStatus="0"):(aa(e,"1"),e.parent().removeClass().addClass("playStatus-1"),n.playStatus="1");break;case 1:"2"===n.playStatus?(aa(e,"0"),e.parent().removeClass().addClass("playStatus-0"),n.playStatus="0"):(aa(e,"2"),e.parent().removeClass().addClass("playStatus-2"),n.playStatus="2");break;case 2:"3"===n.playStatus?(aa(e,"0"),e.parent().removeClass().addClass("playStatus-0"),n.playStatus="0"):(aa(e,"3"),e.parent().removeClass().addClass("playStatus-3"),n.playStatus="3");break;case 3:"10"===n.userRating?(e.parent().removeClass("rating-10"),n.userRating="0"):(e.parent().removeClass().addClass("rating-10"),n.userRating="10");break;case 4:"1"===n.gameStatus?(e.parent().removeClass().addClass("gameStatus-0"),n.gameStatus="0"):(e.parent().removeClass().addClass("gameStatus-1"),n.gameStatus="1")}m.updateUserItem(n,function(e){c.viewItemDetail(e)})}},aa=function(e,t){e.parent().parent().find('span[class*="playStatus"]').each(function(){a(this).removeClass().addClass("playStatus-"+t)})},na=function(e){var t=parseInt(e,10);if(h.resetFilters(),isNaN(e))h.platformQuickFilter(e);else switch(t){case 1:sa(D.releaseDate),h.upcomingQuickFilter(R);break;case 2:sa(D.releaseDate),h.newReleasesQuickFilter(R);break;case 3:sa(D.metascore),h.neverPlayedQuickFilter(R);break;case 4:sa(D.metascore),h.gamesPlayingQuickFilter(R);break;case 5:sa(D.metascore),h.gamesPlayedQuickFilter(R);break;case 6:sa(D.metascore),h.finishedGamesQuickFilter(R);break;case 7:sa(D.metascore),h.ownedGamesQuickFilter(R);break;case 8:sa(D.metascore),h.wantedGamesQuickFilter(R)}ia(t)},ia=function(e){0===e&&nt.text("Custom"),A?(A=!1,Ft(E,function(){h.applyListJSFiltering(R)})):h.applyListJSFiltering(R)},ra=function(e){F=e,e?(at.show(),at.next().show()):(at.hide(),at.next().hide())},sa=function(e){switch(N=e){case D.alphabetical:K.text("Alphabetical"),R.sort("itemName",{asc:!0});break;case D.metascore:K.text("Review Score"),R.sort("scoreDetails",{sortFunction:oa});break;case D.releaseDate:K.text("Release Date"),R.sort("releaseDate",{sortFunction:ca});break;case D.platform:K.text("Platform"),R.sort("platform",{asc:!0});break;case D.price:K.text("Price"),R.sort("priceDetails",{sortFunction:la})}},oa=function(e,t){var n=a(e.elm).find(".metascore"),i=a(t.elm).find(".metascore"),r=parseInt(n.attr("data-score"),10),s=parseInt(i.attr("data-score"),10);return s>r?1:-1},la=function(e,t){var n=a(e.elm).find(".priceDetails .lowestNew"),i=a(t.elm).find(".priceDetails .lowestNew"),r=0,s=0;return n.length>0&&(r=parseFloat(n.attr("data-price"))),i.length>0&&(s=parseFloat(i.attr("data-price"))),s>r?-1:1},ca=function(e,t){var n=a(e.elm).find(".releaseDate"),i=a(t.elm).find(".releaseDate"),r=Date.parse(n.text()),s=Date.parse(i.text());return s-r},ua=function(e){e.addClass("active").siblings().removeClass("active");var t=e.attr("data-content");L!==t&&(L=t,B.removeClass().addClass("list display-"+L),H.nanoScroller())},da={init:It,createEventHandlers:Dt,getItem:Pt,clearItemView:St,resizePanel:Ct,loggedInView:_t,initializeUserItems:Tt,initializeUserItems_result:Rt,updateListDeletions:kt,updateListAdditions:Et,updateListAttributesChanged:Lt,showListView:Nt,viewDiscussion:Ut,viewCollection:At,refreshView:Gt,showGridView:Vt,viewRandomItem:Wt};a.extend(e,da)}(gamedex.module("itemView"),gamedex,jQuery,_,List),function(e,t,a,n,i){"use strict";var r=t.module("detailView"),s=t.module("itemData"),o=t.module("itemView"),l=(t.module("tagView"),t.module("amazon"),t.module("utilities"),t.module("filterPanel")),c={itemName:0,metacriticScore:1,releaseDate:2,platform:3,rawPrice:4},u=null,d=0,m=null,f=!0,g=null,p=!1,h=a("#panel4"),v=a("#wrapper"),w=a("#gridViewContainer"),I=a("#gridList"),D=(I.find(".viewName"),a("#gridViewMenu")),y=h.find(".loadingStatus"),b=D.find(".grid_displayOptions"),x=b.find(".displayType"),P=D.find(".sortOptions"),S=P.find(".sortType"),C=D.find(".filterOptions"),_=C.find(".clearFilters_btn"),T=C.find(".filterType"),R=C.find(".listFilters_btn"),k=a("#applyFilters_btn"),E=a("#filters-modal"),L=n.template(a("#grid-results-template").html()),N={},U=!1,A=null;e.init=function(){G(),et(!1)};var G=function(){D.on("mouseenter",".dropdown-toggle",function(){var e=this;D.find(".dropdown").each(function(){a(this).hasClass("open")&&a(this).find(".dropdown-toggle").get(0)!==a(e).get(0)&&a(e).trigger("click")})}),a("#exitGridView_btn").click(function(e){e.preventDefault(),F()}),R.click(function(e){e.preventDefault(),E.modal("show")}),_.click(function(e){e.preventDefault(),et(!1),T.text("None"),l.resetFilters(),Y()}),k.click(function(e){e.preventDefault(),Y(),et(!0)}),I.find("ul").on("click","a",function(e){e.preventDefault(),O(a(this).attr("data-content"))}),w.on("click",".gridItem img",function(e){e.preventDefault(),H(a(this).parent().parent().attr("data-content"))}),w.on("mouseover",".gridItem",function(e){e.preventDefault();var t=a(this),n=t.attr("data-content"),i=N[n];i||(i=t.width(),N[n]=i),Math.round((1.2*i-i)/2),t.css({"z-index":"999",width:1.2*i+"px","-webkit-transition-timing-function":"cubic-bezier(0.01,0.53,0.00,1.00)","-webkit-transition-property":"top,left,width","-webkit-transition-duration":"1s"})}),w.on("mouseout",".gridItem",function(e){e.preventDefault();var t=a(this);t.css({"z-index":"",width:"","-webkit-transition-timing-function":"cubic-bezier(0.01,0.53,0.00,1.00)","-webkit-transition-property":"top,left,width","-webkit-transition-duration":"1s"})}),b.find("li a").click(function(e){e.preventDefault(),x.text(a(this).text()),tt(a(this).attr("data-content"))}),P.find("li a").click(function(e){e.preventDefault(),W(a(this).attr("data-content"))}),C.find("li a").click(function(e){e.preventDefault(),g=parseInt(a(this).attr("data-content"),10),0===g?l.showFilterPanel():(et(!0),T.text(a(this).text()),Q(parseInt(a(this).attr("data-content"),10)))})};e.showGridView=function(e,t,a,n){i.success("Loading Grid View images"),y.addClass("show"),v.removeClass("standardView"),v.addClass("gridView"),g=t,V(e),z(e),T.text(a),et(n)},e.exitGridView=function(){v.removeClass("gridView"),v.addClass("standardView")};var V=function(e){var t=I.find('a[data-content="'+e+'"]');I.find(".viewName").text(t.text())},F=function(){e.exitGridView(),o.showListView(u,g,T.text(),p)},O=function(e){u=e,V(e),z(e)},z=function(e){u=e,w.hide(),U&&w.isotope("destroy"),s.getItems(e,B)},B=function(e){M(e)},M=function(e){var t={items:e};w.html(L(t)),j(),w.imagesLoaded(function(){y.removeClass("show"),w.show(),j(),Y()})},j=function(){U=!0,w.isotope({itemSelector:".gridItem",getSortData:{itemName:X,releaseDate:J,platform:q,userRating:$,metacriticScore:Z,rawPrice:K},sortBy:"itemName",sortAscending:!0,transformsEnabled:!1})},H=function(e){var t=s.getItem(e);r.viewItemDetail(t)},Q=function(e){at();var t=parseInt(e,10);switch(l.resetFilters(),t){case 1:l.upcomingQuickFilter(),S.text("Release Date"),m="releaseDate",f=!0;break;case 2:l.newReleasesQuickFilter(),S.text("Release Date"),m="releaseDate",f=!1;break;case 3:l.neverPlayedQuickFilter(),S.text("Review Score"),m="metacriticScore",f=!1;break;case 4:l.gamesPlayingQuickFilter(),S.text("Review Score"),m="metacriticScore",f=!1;break;case 5:l.gamesPlayedQuickFilter(),S.text("Review Score"),m="metacriticScore",f=!1;break;case 6:l.finishedGamesQuickFilter(),S.text("Review Score"),m="metacriticScore",f=!1;break;case 7:l.ownedGamesQuickFilter(),S.text("Review Score"),m="metacriticScore",f=!1;break;case 8:l.wantedGamesQuickFilter(),S.text("Review Score"),m="metacriticScore",f=!1}Y()},Y=function(){0===g&&T.text("Custom"),et(l.applyIsotopeFiltering(w,m,f))},W=function(e){switch(at(),d=parseInt(e,10)){case c.itemName:S.text("Alphabetical"),m="itemName",w.isotope({sortBy:m,sortAscending:!0});break;case c.metacriticScore:S.text("Review Score"),m="metacriticScore",w.isotope({sortBy:m,sortAscending:!1});break;case c.releaseDate:S.text("Release Date"),m="releaseDate",w.isotope({sortBy:m,sortAscending:!1});break;case c.platform:S.text("Platform"),m="platform",w.isotope({sortBy:m,sortAscending:!0});break;case c.rawPrice:S.text("Price"),m="rawPrice",w.isotope({sortBy:m,sortAscending:!0})}},X=function(e){return e.find(".itemName").text()},J=function(e){return e.find(".releaseDate").text()},q=function(e){return e.find(".platform").text()},$=function(e){return parseInt(e.find(".userRating").text(),10)},Z=function(e){return parseInt(e.find(".metacriticScore").text(),10)},K=function(e){return parseInt(e.find(".rawPrice").text(),10)},et=function(e){p=e,e?(_.show(),_.next().show()):(_.hide(),_.next().hide())},tt=function(e){at(),N={},A!==e&&(w.removeClass("display-"+A).addClass("display-"+e),A=e,w.isotope("reLayout",function(){}))},at=function(){a(".gridItem").each(function(e,t){a(t).css({"z-index":"","-webkit-transition-property":""})})}}(gamedex.module("gridView"),gamedex,jQuery,_,alertify),function(e,t,a,n){"use strict";var i=(t.module("user"),t.module("tagData")),r=t.module("itemData"),s=t.module("itemCache"),o=a("#addListContainer"),l=a("#addList"),c=a("#viewList"),u=a("#gridList"),d={},m={},f={},g={},p={},h={},v=[],w=n.template(a("#view-list-template").html()),I=function(){D()},D=function(){l.change(function(){var e=l.val().split(","),t=e[e.length-1];""!==t&&R(t)})},y=function(e,t){return O(),i.getTags(e,t)},b=function(e){j(),H(e),x(),F()},x=function(){var e=[],t=[];n.each(m,function(t){e.push(t)}),n.each(f,function(e){t.push(e)}),e.sort(Q);var a={orderedList:e,emptyList:t};c.find("ul").html(w(a)),u.find("ul").html(w(a))},P=function(e){return g[e]},S=function(){var e=0;return n.each(d,function(){e++}),e},C=function(){var e=[],t=B();return n.each(t,function(t){n.has(h,t)||(h[t]="placeholder",e.push(t))}),e},_=function(){var e=[],t=[],a=B();return n.each(h,function(i,r){-1===n.indexOf(a,r)&&(delete h[r],t.push(r),e.push(i))}),{idsToDelete:e,tagsToDelete:t}},T=function(e,t){for(var a=0,n=t.length;n>a;a++)h[e[a]]=t[a]},R=function(e,t){if(n.has(d,e)){if(t){var a={tagID:d[e].id,tagName:d[e].name};t(a)}}else i.addTag(e,function(e){z(e),t&&t(e)})},k=function(e,t){var a=s.getCachedItemsByTag(e);n.each(a,function(t){r.deleteClientItem(e,t.itemID),r.deleteTagFromDirectory(t.itemID,e)}),E(e),s.deleteCachedTag(e),i.deleteTag(e),y(function(e){b(e)}),t()},E=function(e){delete h[e],M(h)},L=function(e){h={},n.each(e,function(e,t){h[t]=e}),M(e)},N=function(){v=l.val().split(",")},U=function(){h={},l.val(v).trigger({type:"change",reset:!1})},A=function(e){for(var t=!1,a=0,n=e.length;n>a;a++)p[e[a]]===void 0&&(p[e[a]]=!0,delete f[g[e[a]]],m[g[e[a]]]={id:e[a],name:g[e[a]]},t=!0);return t&&x(),t},G=function(){h={},v=[],l.val([""]).trigger({type:"change",reset:!0})},V=function(){var e=!1,t=B();return n.each(t,function(t){n.has(h,t)||(e=!0)}),n.each(h,function(a,i){-1===n.indexOf(t,i)&&(e=!0)}),e},F=function(){var e=[],t=[];n.each(d,function(a){e.push(a),t.push(a.name)}),e.sort(Q),l.select2({tags:t,placeholder:"Type a tag name",allowClear:!0})},O=function(){d={},m={},f={},g={},p={},h={},v=[]},z=function(e){var t={name:e.tagName.toLowerCase(),id:e.tagID};d[t.name]=t,f[t.name]=t,g[t.id]=t.name,x(),F(),o.find(".select2-search-field input").focus()},B=function(){var e=l.val(),t=[];return""!==e&&n.each(e.split(","),function(e){n.has(d,e)?t.push(d[e].id):t.push(e)}),t},M=function(e){var t=[];n.each(e,function(e,a){var n=P(a);t.push(n)}),l.val(t).trigger({type:"change",reset:!1})},j=function(){var e=r.getItemDirectory();p={},n.each(e,function(e){n.each(e.tags,function(e,t){p[t]===void 0&&(p[t]=!0)})})},H=function(e){for(var t={},a=0,n=e.length;n>a;a++)t={},t.name=e[a].tagName.toLowerCase(),t.id=e[a].tagID,p[t.id]!==void 0?m[t.name]=t:f[t.name]=t,d[t.name]=t,g[t.id]=t.name},Q=function(e,t){var a=e.name,n=t.name;return a.toLowerCase().localeCompare(n.toLowerCase())},Y={init:I,getTags:y,getTags_result:b,renderViewLists:x,getTagName:P,getTagCount:S,getTagsToAdd:C,getTagsToDelete:_,updateInitialItemTags:T,addTag:R,deleteTag:k,removeTagFromAddList:E,selectTagsFromDirectory:L,updateUserTags:N,selectUserTags:U,updateViewList:A,resetAddList:G,isAddListChanged:V};a.extend(e,Y)}(gamedex.module("tagView"),gamedex,jQuery,_),function(e,t,a,n,i){"use strict";var r=t.module("utilities"),s=a("#filters-modal"),o=a("#releaseDate_filter"),l=a("#gameStatus_filter"),c=a("#playStatus_filter"),u=a("#metascore_filter"),d=a("#platformFilterList");e.init=function(){e.createEventHandlers(),d.select2({placeholder:"Select platform",allowClear:!0})},e.createEventHandlers=function(){s.on("click",".btn-group button",function(e){e.preventDefault()})},e.showFilterPanel=function(){s.modal("show")},e.getFilters=function(){var e={};e.releaseDateFilters=[],e.metascoreFilters=[],e.platformFilters=[],e.gameStatusFilters=[],e.playStatusFilters=[],o.find("button").each(function(){a(this).hasClass("active")?e.releaseDateFilters.push(!0):e.releaseDateFilters.push(!1)}),u.find("button").each(function(){a(this).hasClass("active")?e.metascoreFilters.push(!0):e.metascoreFilters.push(!1)}),l.find("button").each(function(){a(this).hasClass("active")?e.gameStatusFilters.push(!0):e.gameStatusFilters.push(!1)}),c.find("button").each(function(){a(this).hasClass("active")?e.playStatusFilters.push(!0):e.playStatusFilters.push(!1)});var t=d.val(),i=[];return t&&""!==t&&(i=t.split(",")),n.each(i,function(t,a){e.platformFilters[a]=r.getStandardPlatform(t)}),e},e.applyListJSFiltering=function(t){var a=e.getFilters(),n=!1;return t.filter(function(t){var i=e.releaseDateFilter(t.values().releaseDate,a.releaseDateFilters),r=e.metascoreFilter(t.values().metascore,a.metascoreFilters),s=e.platformFilter(t.values().platform,a.platformFilters),o=e.gameStatusFilter(t.values().gameStatus,a.gameStatusFilters),l=e.playStatusFilter(t.values().playStatus,a.playStatusFilters);return i&&r&&s&&l&&o?!0:(n=!0,!1)}),n},e.applyIsotopeFiltering=function(t,n,i){var r=e.getFilters(),s=!1,o=a(".gridItem").filter(function(){var t=a(this),n=t.find(".releaseDate").text(),i=e.releaseDateFilter(n,r.releaseDateFilters),o=t.find(".metacriticScore").text(),l=e.metascoreFilter(o,r.metascoreFilters),c=t.find(".platform .data").text(),u=e.platformFilter(c,r.platformFilters),d=t.find(".gameStatus").text(),m=e.gameStatusFilter(d,r.gameStatusFilters),f=t.find(".playStatus").text(),g=e.playStatusFilter(f,r.playStatusFilters);return i&&m&&g&&l&&u?!0:(s=!0,!1)});return t.isotope({filter:o,sortBy:n,sortAscending:i}),s},e.resetFilters=function(){o.find("button").each(function(){a(this).removeClass("active")}),u.find("button").each(function(){a(this).removeClass("active")}),l.find("button").each(function(){a(this).removeClass("active")}),c.find("button").each(function(){a(this).removeClass("active")}),d.val([""]).trigger("change")},e.upcomingQuickFilter=function(){o.find('button[data-content="0"]').addClass("active")},e.newReleasesQuickFilter=function(){o.find('button[data-content="1"]').addClass("active")},e.neverPlayedQuickFilter=function(){c.find('button[data-content="0"]').addClass("active")},e.gamesPlayingQuickFilter=function(){c.find('button[data-content="1"]').addClass("active")},e.gamesPlayedQuickFilter=function(){c.find('button[data-content="2"]').addClass("active")},e.finishedGamesQuickFilter=function(){c.find('button[data-content="3"]').addClass("active")},e.ownedGamesQuickFilter=function(){l.find('button[data-content="1"]').addClass("active")},e.wantedGamesQuickFilter=function(){l.find('button[data-content="3"]').addClass("active")},e.platformQuickFilter=function(e){d.val(e).trigger("change")},e.releaseDateFilter=function(e,t){var a=t[0],n=t[1],r=null;r="1900-01-01"===e?i().add("days",1):i(e,"YYYY-MM-DD");var s=i(),o=r.diff(s,"seconds");return a&&n?!0:a||n?a&&o>0?!0:n&&0>o?!0:!1:!0},e.gameStatusFilter=function(e,t){var a=t[0],n=t[1],i=t[2],r=t[3];return a&&n&&i&&r?!0:a||n||i||r?a&&"0"===e?!0:n&&"1"===e?!0:i&&"2"===e?!0:r&&"3"===e?!0:!1:!0},e.playStatusFilter=function(e,t){var a=t[0],n=t[1],i=t[2],r=t[3];return a&&n&&i&&r?!0:a||n||i||r?a&&"0"===e?!0:n&&"1"===e?!0:i&&"2"===e?!0:r&&"3"===e?!0:!1:!0},e.metascoreFilter=function(e,t){var a=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],l=t[6],c=parseInt(e,10);return a&&n&&i&&r&&s&&o&&l?!0:a||n||i||r||s||o||l?a&&c>=90?!0:n&&c>=80&&90>c?!0:i&&c>=70&&80>c?!0:r&&c>=60&&70>c?!0:s&&c>=50&&60>c?!0:o&&c>=25&&50>c?!0:l&&c>=0&&25>c?!0:!1:!0},e.platformFilter=function(e,t){if(0===t.length)return!0;for(var a=0,n=t.length;n>a;a++)if(t[a].name===e)return!0;return!1}}(gamedex.module("filterPanel"),gamedex,$,_,moment),function(e,t,a,n,i,r,s){"use strict";var o=a.module("giantbomb"),l="videoPlayer",c=89,u=5,d=!1,m=0,f=null,g=0,p=0,h=0,v=0,w=!0,I=null,D={valueNames:["publishDate"]},y=[],b=[],x=null,P=null,S=null,C=null,_=null,T=n("#video-modal"),R=(n("#videoListContainer"),n("#videoList")),k=(n("#videoPlayer"),n("#videoModalTitle")),E=n("#videoListNavigation"),L=E.find(".navigateLeft"),N=E.find(".navigateRight"),U=E.find(".pageNumber"),A=i.template(n("#video-results-template").html());e.init=function(){_=t(l),e.createEventHandlers(),C=i.debounce(O,1e3),T.modal({backdrop:!0,show:!1})},e.createEventHandlers=function(){R.on("click","li",function(e){e.preventDefault();var t=n(this).attr("data-id");M(Number(t)),H()}),L.click(function(){X()}),N.click(function(){J()}),T.on("hidden",function(){Q()}),_.addEvent("ended",B)},e.showVideoPanel=function(){n.when(x).then(function(){if(d){d=!1;var e=F(y[g-1]);e&&M(g-1),G()}H()},function(){}),T.modal("show")},e.initializeVideoPanel=function(e,t){d=!0,f=1,h=-1,m=0,p=0,w=!0,g=e.length,P=null,S=null,k.text(t),y=n.extend(!0,[],e),R.empty(),$(0),Y(),i.each(y,function(e,t){e.index=t}),x=V(y[g-1],function(){})};var G=function(){i.each(y,function(e){V(e,function(e,t){-1===h&&t&&(M(e.index),H())})})},V=function(e,t){var a=o.getGiantBombVideo(e.id,function(a){n.extend(!0,e,a);var i=F(e);t(e,i)});return a},F=function(e){if(!i.has(e,"attached")&&i.has(e,"image")){p++,z(e);
var t={video:e};R.append(A(t)),e.attached=!0;var a=R.find("#video_"+e.id);i.delay(function(){a.addClass("showFade"),C()},200),a.opentip(a.attr("data-ot"),a.attr("data-ot-title"),{tipJoint:"bottom",group:"video"}),$(m),p>u&&W()}return i.has(e,"image")?!0:!1},O=function(){b=[],I=new s("videoListContainer",D),I.sort("publishDate",{asc:!1}),i.each(I.items,function(e){b.push(parseInt(n(e.elm).attr("data-id"),10))}),w&&j()},z=function(e){e.calendarDate=r(e.publish_date,"YYYY-MM-DD").calendar();var t=Math.floor(e.length_seconds/60),a=""+e.length_seconds%60;1===a.length&&(a="0"+a),delete e.length_seconds,e.runningTime=t+":"+a},B=function(){var e=i.indexOf(b,h);h=e+1===b.length?b[0]:b[e+1],M(h),H()},M=function(e){h=e;var t=y[e].url;P=R.find('li[data-id="'+e+'"]'),S=R.find('li[data-id="'+v+'"]'),S.removeClass("playing"),P.addClass("playing"),t.split(".");var a=y[e].high_url;_.src(a),v=e,j()},j=function(){var e=i.indexOf(b,h);if(-1!==e){var t=Math.floor(e/u);$(t)}},H=function(){_.play()},Q=function(){_.pause()},Y=function(){E.removeClass("show")},W=function(){E.addClass("show")},X=function(){w=!1;var e=q();m>0?$(--m):$(e)},J=function(){w=!1;var e=q();e>m?$(++m):$(0)},q=function(){return f=Math.ceil(p/u)-1},$=function(e){var t=-(e*c);m=e,R.stop().animate({top:t},250,function(){}),U.text(Number(e+1)+" / "+Number(q()+1))}}(gamedex.module("videoPanel"),_V_,gamedex,jQuery,_,moment,List),function(e,t,a,n,i){"use strict";var r=(t.module("user"),t.module("utilities")),s=t.module("itemData"),o=t.module("tagView"),l=t.module("itemView"),c=(t.module("amazon"),t.module("metacritic")),u=t.module("itemLinker"),d=t.module("giantbomb"),m=["Steam","PSN","XBL"],f=["Steam ID","PSN ID","Gamertag"],g=["http://steamcommunity.com/id/[steam_id]/games/","http://us.playstation.com/mytrophies/","http://www.xboxgamertag.com/search/[gamer_tag]"],p=[["PC","Mac"],["PSN","PS3","Vita"],["Xbox","X360","XBL"]],h="http://d2sifwlm28j6up.cloudfront.net/no_match.png",v="Loading Data: ",w="Importing: ",I=0,D=0,y=0,b=0,x=0,P=0,S=null,C={},_=0,T=[],R=[],k=[],E=a("#importContainer"),L=(a("#importResults"),a("#importResults tbody")),N=a("#startImport_btn"),U=a("#confirmImport_btn"),A=a("#cancelImport_btn"),G=a("#sourceUser"),V=a(".importSourceID"),F=a(".importSourceName"),O=a(".importSourceURL"),z=a("#importConfig-modal"),B=a("#import-modal"),M=a("#importProgressContainer"),j=a("#importProgress"),H=j.find(".bar"),Q=a("#importStatus"),Y=Q.find(".statusTitle"),W=Q.find(".statusText"),X=null,J=n.template(a("#import-results-template").html()),q=function(){var e={sliderMinHeight:20,iOSNativeScrolling:!0,preventPageScrolling:!0,flash:!0,flashDelay:1500,alwaysVisible:!0};E.nanoScroller(e),$()},$=function(){N.click(function(e){e.preventDefault(),""!==G.val()&&et(G.val())}),G.keyup(function(e){e.preventDefault(),13===e.which&&""!==G.val()&&et(G.val())}),U.click(function(e){e.preventDefault(),It()}),A.click(function(e){e.preventDefault(),tt()})},Z=function(e){S=e,n.has(C,e)?(z.modal("hide"),B.modal("show")):K(),n.delay(function(){E.nanoScroller()},1e3)},K=function(){V.text(f[S]),F.text(m[S]);var e=g[S],t='<a href="'+e+'" target="_blank">'+e+"</a>";O.html(t),z.modal("show"),n.delay(function(){G.focus().select()},800)},et=function(e){C[S]=!0,R=[],I=0,D=0,y=0,b=0,X=st.lazy(500,1e4),_++,L.empty(),pt(v),z.modal("hide"),B.modal("show"),s.importGames(S,e,function(e){at(e,p[S])}),i.success("Importing "+m[S]+" games for: "+e)},tt=function(){delete C[S],_++,n.each(k,function(e){e&&n.has(e,"abort")&&e.abort()}),K(),B.modal("hide"),i.error(m[S]+" import cancelled")},at=function(e,t){T=e,y=T.length,k=[],n.each(T,function(e){e=u.standardizeTitle(e);var a=nt(e,t);k.push(a)})},nt=function(e,t){var a={initialProvider:1,standardName:e},n=u.findItemOnAlternateProvider(a,r.SEARCH_PROVIDERS.Amazon,!1,function(n){it(e,n,a,t)},function(){lt(e)});return n},it=function(e,t,i,s){a.extend(!0,i,t);var o=d.getGiantBombItemPlatform(i.id,function(t){for(var a=[],o=0,l=t.results.platforms.length;l>o;o++){var c=r.matchPlatformToIndex(t.results.platforms[o].name).name;a.push(c)}var u=n.intersection(a,s);i.platform=u[0],i.platform?(I+=2,X(i,ut,_),rt(i),ot(i)):lt(e)});k.push(o)},rt=function(e){var t=c.getMetascore(e.standardName,e,!0,dt);k.push(t)},st=function(e,t,a){if(_===a){var n=u.findItemOnAlternateProvider(e,r.SEARCH_PROVIDERS.GiantBomb,!1,function(a){e.asin=a.asin,t()},function(e){e||t()});k.push(n)}},ot=function(e){e.importClass="imported",0===b&&ht(),b++,R.push(e),ct(e),ft()},lt=function(e){var t={thumbnailImage:h,name:e,calendarDate:"",platform:"Title not found: please add manually",importClass:"importFailed"};ct(t)},ct=function(e){var t={item:e};L.append(J(t)),E.nanoScroller()},ut=function(){mt()},dt=function(){mt()},mt=function(){D++,ft(),I==D&&wt()},ft=function(){var e=y+I,t=b+D,a=Math.round(100*(t/e));H.css({width:a+"%"}),W.text(t+" of "+e)},gt=function(){var e=Math.round(100*(P/x));H.css({width:e+"%"}),W.text(P+" of "+x)},pt=function(e){B.removeClass("ready").addClass("loading"),M.removeClass("show"),H.css({width:"0%"}),Y.text(e)},ht=function(){M.addClass("show"),B.removeClass("ready").removeClass("loading")},vt=function(){M.removeClass("show"),n.delay(function(){H.css({width:"0%"})},1e3)},wt=function(){vt(),n.delay(function(){B.addClass("ready")},1e3),i.success(y+" titles found and linked for "+m[S])},It=function(){Y.text(w),ht();var e=m[S].toLowerCase()+" import";x=R.length,P=0,o.addTag(e,function(t){var a=[t.tagID];n.each(R,function(t){s.addItemToTags(a,t,function(){P++,gt(),P===x&&Dt(a,e)})})})},Dt=function(e,t){i.success(m[S]+" Import Complete"),i.log("Games added to tag: "+t),B.modal("hide"),l.refreshView(),o.updateViewList(e),l.viewRandomItem(),delete C[S],S=null},yt={init:q,startImport:Z};a.extend(e,yt)}(gamedex.module("importView"),gamedex,jQuery,_,alertify),gamedex.initialize();
