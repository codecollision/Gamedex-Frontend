(function(t){function e(e,s){this.element=e,this.options=t.extend({},i,s),this._defaults=i,this._name=n,this.init()}var n="BootstrapSubMenu",i={propertyName:"value"},s=null,a=null,r=!1;e.prototype.init=function(){this.createEventHandlers(t(this.element),this.options.$mainNav)},e.prototype.createEventHandlers=function(e,n){n.click(function(){r=!1}),n.find("li:not(.dropdown-sub li)").hover(function(){clearTimeout(s),s=null,a||(a=setTimeout(function(){e.removeClass("active")},500))}),e.hover(function(){clearTimeout(a),a=null,s||(s=setTimeout(function(){r||e.addClass("active")},300))}),e.click(function(t){t.preventDefault(),t.stopPropagation()}),e.find("li").hover(function(){clearTimeout(a),a=null}),e.find("li").click(function(){r=!0,e.removeClass("active"),n.removeClass("open")}),n.find(".dropdown-toggle").click(function(){e.removeClass("active")}),t(document).click(function(){e.removeClass("active")})},t.fn[n]=function(i){return this.each(function(){t.data(this,"plugin_"+n)||t.data(this,"plugin_"+n,new e(this,i))})}})(jQuery);var gamedex={module:function(){var t={};return function(e){return t[e]?t[e]:t[e]={}}}()};gamedex.api="/",gamedex.initialize=function(){gamedex.initializeLibraries(),gamedex.initializeModules()},gamedex.initializeLibraries=function(){moment.calendar={lastDay:"LL",sameDay:"LL",nextDay:"LL",lastWeek:"LL",nextWeek:"LL",sameElse:"LL"},moment.longDateFormat={L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D YYYY h:mm A",LLLL:"dddd, MMMM D YYYY h:mm A"}},gamedex.initializeModules=function(){var t=gamedex.module("itemData"),e=gamedex.module("searchView"),n=gamedex.module("detailView"),i=gamedex.module("itemView"),s=gamedex.module("tagView"),a=gamedex.module("gridView"),r=gamedex.module("filterPanel"),o=gamedex.module("videoPanel"),l=gamedex.module("importView"),c=gamedex.module("siteView");t.init(),e.init(),n.init(),i.init(),s.init(),a.init(),r.init(),o.init(),l.init(),c.init()},function(t,e,n){"use strict";var i=(e.module("user"),[{id:"all",gt:"",ign:"",amazon:468642,name:"All Platforms",alias:"all"},{id:"pc",gt:"pc",ign:"pc",amazon:229575,name:"PC",alias:"pc,windows"},{id:"mac",gt:"",ign:"mac",amazon:229647,name:"Mac",alias:"mac,macwindows,osx,os x,apple,macintosh"},{id:"xbox",gt:"",ign:"xbox",amazon:537504,name:"Xbox",alias:"xbox,microsoft xbox"},{id:"x360",gt:"xbox 360",ign:"xbox-360",amazon:14220161,name:"X360",alias:"x360,xbox 360,microsoft xbox360,360"},{id:"xbl",gt:"xbla",ign:"xbox-360",amazon:14220161,name:"XBL",alias:"xbl,xbox live"},{id:"ds",gt:"ds",ign:"ds",amazon:11075831,name:"DS",alias:"ds,nintendo ds"},{id:"3ds",gt:"3ds",ign:"ds",amazon:2622269011,name:"3DS",alias:"3ds,nintendo 3ds"},{id:"wii",gt:"wii",ign:"wii",amazon:14218901,name:"Wii",alias:"wii,nintendo wii"},{id:"wiiu",gt:"wii u",ign:"wii-u",amazon:3075112011,name:"Wii U",alias:"wiiu,wii u,wii-u,nintendo wii u,nintendo wiiu"},{id:"ps",gt:"",ign:"ps",amazon:229773,name:"PS1",alias:"ps,ps1,playstation,playstation1,playstation 1,sony playstation 1,sony playstation"},{id:"ps2",gt:"",ign:"ps2",amazon:301712,name:"PS2",alias:"ps2,playstation 2,playstation2,sony playstation 2"},{id:"ps3",gt:"ps3",ign:"ps3",amazon:14210751,name:"PS3",alias:"ps3,playstation 3,playstation3,sony playstation 3"},{id:"psn",gt:"",ign:"ps3",amazon:14210751,name:"PSN",alias:"psn,playstation network"},{id:"vita",gt:"vita",ign:"vita",amazon:3010556011,name:"Vita",alias:"vita,psvita,ps vita,playstation vita,sony vita,sony playstation vita"},{id:"psp",gt:"",ign:"psp",amazon:11075221,name:"PSP",alias:"psp,sony psp"},{id:"gc",gt:"",ign:"gcn",amazon:541022,name:"Gamecube",alias:"gamecube,gc,nintendo gamecube"},{id:"n64",gt:"",ign:"n64",amazon:229763,name:"N64",alias:"n64,nintendo 64,nintendo64"},{id:"nes",gt:"",ign:"",amazon:566458,name:"NES",alias:"nes,nintendo nes"},{id:"snes",gt:"",ign:"",amazon:294945,name:"SNES",alias:"snes,super nintendo,nintendo snes"},{id:"gba",gt:"",ign:"gba",amazon:1272528011,name:"Game Boy",alias:"gb,gameboy"},{id:"gb",gt:"",ign:"gb",amazon:541020,name:"GBA",alias:"gba,gameboy advance,game boy,advance,gbadvance"},{id:"gbc",gt:"",ign:"",amazon:229783,name:"GBC",alias:"gbc,gbcolor,gameboy color"},{id:"dc",gt:"",ign:"dc",amazon:229793,name:"Dreamcast",alias:"dc,dreamcast,sega dreamcast,sega dream cast,dream cast"},{id:"saturn",gt:"",ign:"",amazon:294944,name:"Saturn",alias:"saturn,sega saturn"},{id:"genesis",gt:"",ign:"",amazon:294943,name:"Genesis",alias:"genesis,sega genesis"},{id:"gamegear",gt:"",ign:"",amazon:294942,name:"Gamegear",alias:"gamegear,game gear,sega gamegear"},{id:"segacd",gt:"",ign:"",amazon:11000181,name:"Sega CD",alias:"cd,sega cd"}]),s={Amazon:0,GiantBomb:1},a={Amazon:0,Steam:1},r="0",o={URL:"http://ecx.images-amazon.com/images",RE:/http:\/\/ecx\.images-amazon\.com\/images/gi,TOKEN:"~1~"},l={URL:"http://media.giantbomb.com/uploads",RE:/http:\/\/media\.giantbomb\.com\/uploads/gi,TOKEN:"~1~"},c=function(t){for(var e=RegExp(t,"gi"),n=0,s=i.length;s>n;n++)if(e.test(i[n].alias))return i[n];return i[0]},u=function(t){for(var e=null,n=[],s=null,a=t.length,r=0,o=null,l=0,c=i.length;c>l;l++){n=i[l].alias.split(",");for(var u=0,d=n.length;d>u;u++){if(e=RegExp(n[u],"gi"),o=e.exec(t),o&&o[0].length===a)return i[l];o&&o[0].length>r&&(r=o[0].length,s=i[l])}}return s?s:i[0]},d={PLATFORM_INDEX:i,SEARCH_PROVIDERS:s,PRICE_PROVIDERS:a,VIEW_ALL_TAG_ID:r,AMAZON_IMAGE:o,GIANTBOMB_IMAGE:l,getStandardPlatform:c,matchPlatformToIndex:u};n.extend(t,d)}(gamedex.module("utilities"),gamedex,jQuery,_),function(t,e,n,i,s){"use strict";var a=(e.module("utilities"),e.module("storage")),r=(e.module("itemView"),e.module("itemCache")),o=e.api+"user/login/",l=e.api+"user/logout/",c=e.api+"user/",u=e.api+"user/create/",d=e.api+"user/delete/",h=e.api+"user/update/",f=e.api+"user/resetcode/send/",p=e.api+"user/resetcode/submit/",m=e.api+"user/password/update/",g={user_id:"",secret_key:"",viewUser:null},v={user_id:"ag1zfnQtbWludXN6ZXJvcgwLEgVVc2Vycxj6VQw",secret_key:"1"};"localhost"===document.location.hostname&&(v={user_id:"ag9kZXZ-dC1taW51c3plcm9yEwsSBVVzZXJzGICAgICAgICARAw",secret_key:"1"}),t.getUserData=function(){return g},t.getUserCredentials=function(t){return t=t!==void 0?t:!1,g.timestamp=(new Date).getTime(),t&&a.set("timestamp",g.timestamp),g.viewUser?{user_name:g.viewUser}:t?{uid:g.user_id,uk:g.secret_key,ts:g.timestamp}:{uid:g.user_id,uk:g.secret_key}},t.getUserID=function(){return g.user_id},t.login=function(e,n,i,a){s.success("Logging in... "+e),t.verifyUser(e,n,function(t,e){_(t,e),i(t,e)},a)},t.verifyUser=function(t,e,i,s){var a={user_email:t,user_password:e};n.ajax({url:o,type:"POST",data:a,dataType:"json",cache:!0,success:function(e){i(e,t)},error:s})},t.deleteAccount=function(t,e,i,s){var a={uid:t,user_password:e};n.ajax({url:d,type:"POST",data:a,dataType:"json",cache:!0,success:function(t){i(t)},error:s})},t.demoLogin=function(){g.user_id=v.user_id,g.secret_key=v.secret_key},t.validateUser=function(t,e){var i={user_name:t};n.ajax({url:c,type:"POST",data:i,dataType:"json",cache:!0,success:function(t){b(t),e(t)},error:function(){}})},t.logout=function(){s.success("Logged out");var t={uid:g.user_id,uk:g.secret_key};n.ajax({url:l,type:"POST",data:t,dataType:"json",cache:!0,success:function(){},error:function(){}}),g.user_id=null,g.secret_key=null,g.userName=null,g.email=null,g.viewUser=null},t.createUser=function(t,e,i,a){s.success("Creating account : "+t);var r={user_email:t,user_password:e};n.ajax({url:u,type:"POST",data:r,dataType:"json",cache:!0,success:function(e){_(e,t),i(e,t)},error:a})},t.updateUser=function(t,e,i,s,a){if(""!==t){var r={uid:g.user_id,user_password:t};""!==i&&i!==g.userName&&(r.user_name=i),""!==i&&e!==g.email&&(r.user_email=e),""!==s&&(r.user_new_password=s),r.user_password=t,n.ajax({url:h,type:"POST",data:r,dataType:"json",cache:!0,success:function(t){"success"===t.status&&y(r),a(t)},error:function(){}})}},t.sendResetPasswordCode=function(t,e){var i={user_email:t};n.ajax({url:f,type:"POST",data:i,dataType:"json",cache:!0,success:function(t){e(t)},error:function(){}})},t.submitResetPasswordCode=function(t,e,i){var s={user_email:t,user_reset_code:e};n.ajax({url:p,type:"POST",data:s,dataType:"json",cache:!0,success:function(t){i(t)},error:function(){}})},t.updatePassword=function(t,e,i,s){var a={user_email:t,user_reset_code:e,user_new_password:i};n.ajax({url:m,type:"POST",data:a,dataType:"json",cache:!0,success:function(t){s(t)},error:function(){}})},t.isViewUser=function(){return g.viewUser?!0:!1};var y=function(t){t.user_name!==void 0&&(g.userName=t.user_name),t.user_email!==void 0&&(g.email=t.user_email)},_=function(t,e){if(t.userID){g.user_id=t.userID,g.secret_key=t.secretKey,g.userName=t.userName,g.email=e,g.viewUser=null,s.success("Welcome "+t.userName);var n=window.location.pathname;history&&"/"!==n&&history.pushState(null,null,"/");var i=a.get("timestamp");i?t.timestamp!=i&&(r.clearStoredData(),a.set("timestamp",t.timestamp)):a.set("timestamp",t.timestamp)}},b=function(t){"success"===t.status&&(g.viewUser=t.userName,g.user_id=t.userName,g.secret_key=0)}}(gamedex.module("user"),gamedex,jQuery,_,alertify),function(t,e){"use strict";var n=e.module("user");t.get=function(t){var e=n.getUserID(),i=localStorage.getItem(e+"_"+t),s=null;return"undefined"!==i&&i&&(s=JSON.parse(i)),s},t.set=function(t,e){if(!n.isViewUser()){var i=n.getUserID();localStorage.setItem(i+"_"+t,JSON.stringify(e)),e||(e={})}return e},t.remove=function(t){var e=n.getUserID();localStorage.removeItem(e+"_"+t)},t.setGlobal=function(t,e){return localStorage.setItem(t,JSON.stringify(e)),e||(e={}),e},t.getGlobal=function(t){var e=localStorage.getItem(t),n=null;return e&&(n=JSON.parse(e)),n},t.removeGlobal=function(t){localStorage.removeItem(t)},t.clearStorage=function(){localStorage.clear()}}(gamedex.module("storage"),gamedex,jQuery,_),function(t,e,n,i){"use strict";var s=(e.module("user"),e.module("storage")),a=e.module("utilities"),r=a.VIEW_ALL_TAG_ID,o={},l={},c=function(t){var e=null;return e=o[t]!==void 0?o[t]:b(t)},u=function(t,e){i.each(t,function(t){e[t.itemID]!==void 0&&i.each(e[t.itemID].tags,function(e,n){d(n,t),d(r,t)})})},d=function(t,e){o[t]!==void 0?o[t][e.itemID]=e:(o[t]={},o[t][e.itemID]=e),m(t,e)},h=function(t,e){o[t][e.itemID]=e,m(t,e,!0)},f=function(){return s.get("itemDataDirectory")},p=function(t){s.set("itemDataDirectory",t)},m=function(t,e,n){if(l[t+"_"+e.itemID]===void 0||n){var i=s.get("itemsCacheByTag");i?i[t]!==void 0?i[t][e.itemID]=e:(i[t]={},i[t][e.itemID]=e):(i={},i[t]={},i[t][e.itemID]=e),s.set("itemsCacheByTag",i)}},g=function(t,e){o[e]&&delete o[e][t],_(t,e)},v=function(t){o[t]&&delete o[t],y(t)},y=function(t){var e=s.get("itemsCacheByTag");e&&(delete e[t],s.set("itemsCacheByTag",e))},_=function(t,e){var n=s.get("itemsCacheByTag");n&&(delete n[e][t],s.set("itemsCacheByTag",n))},b=function(t){var e=s.get("itemsCacheByTag"),n=null;return e&&e[t]!==void 0&&(n=e[t],i.each(n,function(e,n){l[t+"_"+n]=!0})),n},w=function(){o={},l={}},C=function(){s.remove("itemsCacheByTag"),s.remove("itemDataDirectory"),s.remove("tag")},x={getCachedItemsByTag:c,cacheItemsByTag:u,cacheItemByTag:d,updateCacheItemByTag:h,getStoredItemDirectory:f,storeItemDirectory:p,deleteCachedItem:g,deleteCachedTag:v,clearItemCache:w,clearStoredData:C};n.extend(t,x)}(gamedex.module("itemCache"),gamedex,$,_),function(t,e,n,i,s){"use strict";var a=e.module("utilities"),r=["accessory","case","codes","combo","console","controller","covers","face plate","faceplate","head set","headset","import","japan","kit","map","membership","new","pack","poster","pre-paid","set","shell","skin","software","stylus","wireless"],o=e.api+"amazon/search/",l=e.api+"amazon/detail/",c=500,u=3e3,d={},h={},f={},p={},m=null,g=0;t.searchAmazon=function(e,i,s,a,r){a=a!==void 0?a:null,r=r!==void 0?r:!1,encodeURIComponent(e);var l={keywords:e,browse_node:i,search_index:"VideoGames",response_group:"ItemAttributes,Images",page:1};m&&r&&m.abort();var d=++g;return m=n.ajax({url:o,type:"GET",data:l,dataType:"xml",cache:!0,success:function(t){d!==g&&r||(m=null,s(t))},error:function(){var n=Math.floor(Math.random()*(u-c+1))+c;(function(){t.searchAmazon(e,i,s,a,r)}).delay(n),a&&a(!0)}})},t.parseAmazonResultItem=function(t){var e="("+r.join("|")+")",n=RegExp(e,"i"),i={name:t.find("Title").text(),platform:t.find("Platform").text()};return n.test(i.name)||""===i.platform?i.isFiltered=!0:(i.id=t.find("ASIN").text(),i.asin=t.find("ASIN").text(),i.gbombID=0,i.smallImage=t.find("ThumbnailImage > URL:first").text()||"",i.thumbnailImage=t.find("MediumImage > URL:first").text()||"",i.largeImage=t.find("LargeImage > URL:first").text()||"",i.description=t.find("EditorialReview > Content:first").text()||"",i.releaseDate=t.find("ReleaseDate").text()||"1900-01-01",i.platform=a.matchPlatformToIndex(i.platform).name,i.calendarDate="1900-01-01"!==i.releaseDate?s(i.releaseDate,"YYYY-MM-DD").calendar():"Unknown"),i},t.getAmazonItemDetail=function(t,e,s){var a=_(t);if(a)e(a);else if(i.has(p,t)||(p[t]=[]),p[t].push(e),1===p[t].length){var r={asin:t,response_group:"Medium"};n.ajax({url:l,type:"GET",data:r,dataType:"xml",cache:!0,success:function(e){i.each(p[t],function(n){h[t]=e,n(e)}),p[t]=[]},error:s})}},t.getAmazonItemOffers=function(t,e,s,a){var r=y(t);if(r)e.offers=r,s(r);else if(i.has(f,t)||(f[t]=[]),f[t].push(s),1===f[t].length){var o={asin:t,response_group:"OfferFull"};n.ajax({url:l,type:"GET",data:o,dataType:"xml",cache:!0,success:function(n){i.each(f[t],function(i){var s=b(n,e);d[t]=s,i(s)}),f[t]=[]},error:a})}};var v=function(t){for(var e=null,n=null,i=0,s=t.offers.length;s>i;i++)"now"===t.offers[i].availability&&(e=t.offers[i].price,n=t.offers[i].rawPrice);e=e||t.lowestNewPrice,"Too low to display"===e&&(e="n/a",n=0),"Too low to display"===t.lowestNewPrice&&(t.lowestNewPrice="n/a"),t.buyNowPrice=e,t.buyNowRawPrice=n},y=function(t){var e=null;return d[t]!==void 0&&(e=d[t]),e},_=function(t){var e=null;return h[t]!==void 0&&(e=h[t]),e},b=function(t,e){var i={};return n("Item",t).each(function(){i=w(n(this))}),e.offers=i,i},w=function(t){var e={},i={},s=/\$/,a=parseInt(t.find("TotalNew").text(),10),r=parseInt(t.find("TotalUsed").text(),10);if(0!==a||0!==r){e.totalNew=a,e.totalUsed=r,e.lowestNewPrice=t.find("LowestNewPrice FormattedPrice").text().replace(s,""),e.lowestUsedPrice=t.find("LowestUsedPrice FormattedPrice").text().replace(s,""),e.totalOffers=t.find("TotalOffers").text(),e.offersURL=t.find("MoreOffersUrl").text(),e.offersURLNew=t.find("MoreOffersUrl").text()+"&condition=new",e.offersURLUsed=t.find("MoreOffersUrl").text()+"&condition=used";var o=/offer-listing/gi;e.productURL=e.offersURL.replace(o,"product"),e.offers=[],n("Offer",t).each(function(){i={},i.price=n(this).find("Price FormattedPrice").text().replace(s,""),i.rawPrice=n(this).find("Price Amount").text(),i.availability=n(this).find("AvailabilityType").text(),i.freeShipping=n(this).find("IsEligibleForSuperSaverShipping").text(),e.offers.push(i)}),v(e)}return e}}(gamedex.module("amazon"),gamedex,jQuery,_,moment),function(t,e,n,i,s){"use strict";var a=(e.module("amazon"),e.api+"giantbomb/search/"),r=e.api+"giantbomb/detail/",o=e.api+"giantbomb/video/",l={},c={},u={},d={},h={};t.searchGiantBomb=function(t,e,i){encodeURIComponent(t);var s=["id","name","original_release_date","image","platforms","site_detail_url","expected_release_day","expected_release_month","expected_release_quarter","expected_release_year"],r={field_list:s.join(","),keywords:t,page:0},o=n.ajax({url:a,type:"GET",data:r,dataType:"json",cache:!0,success:e,error:i});return o},t.parseGiantBombResultItem=function(t){var e={id:t.id,asin:0,gbombID:t.id,name:t.name,platform:"n/a",platforms:t.platforms};return t.original_release_date&&""!==t.original_release_date?e.releaseDate=t.original_release_date.split(" ")[0]:t.expected_release_day&&t.expected_release_month&&t.expected_release_year?(1===(""+t.expected_release_day).length&&(t.expected_release_day="0"+(""+t.expected_release_day)),1===(""+t.expected_release_month).length&&(t.expected_release_month="0"+(""+t.expected_release_month)),e.releaseDate=t.expected_release_year+"-"+t.expected_release_month+"-"+t.expected_release_day):t.expected_release_quarter&&(e.releaseDate="year-03-31",e.calendarDate="Q1 YEAR"),e.calendarDate="1900-01-01"!==e.releaseDate?s(e.releaseDate,"YYYY-MM-DD").calendar():"Unknown",e.smallImage=t.image&&t.image.small_url&&""!==t.image.small_url?t.image.small_url:"no image.png",e.thumbnailImage=t.image&&t.image.thumb_url&&""!==t.image.thumb_url?t.image.thumb_url:"no image.png",e.largeImage=t.image&&t.image.small_url&&""!==t.image.small_url?t.image.small_url:"no image.png",e.description=t.description&&""!==t.description?t.description:"No Description",e},t.getGiantBombItemPlatform=function(t,e,n){var i=["platforms"],s=f(r,t,i,function(n){e(n,t)},n);return s},t.getGiantBombItemData=function(t,e,n){var s=m(t);if(s)e(s);else if(i.has(d,t)||(d[t]=[]),d[t].push(e),1===d[t].length){var a=["description","site_detail_url","videos"];f(r,t,a,function(e){i.each(d[t],function(n){l[t]=e.results,n(e.results)}),d[t]=[]},n)}},t.getGiantBombVideo=function(t,e,n){var i=p(t),s=null;if(i)e(i);else{var a=[];s=f(o,t,a,function(n){u[t]=n.results,e(n.results)},n)}return s},t.getGiantBombItemDetail=function(t,e,n){var s=g(t);if(s)e(s);else if(i.has(h,t)||(h[t]=[]),h[t].push(e),1===h[t].length){var a=["id","name","original_release_date","image"];f(r,t,a,function(e){i.each(h[t],function(n){c[t]=e.results,n(e.results)}),h[t]=[]},n)}};var f=function(t,e,i,s,a){var r={field_list:i.join(","),id:e},o=n.ajax({url:t,type:"GET",data:r,dataType:"json",cache:!0,success:s,error:a});return o},p=function(t){var e=null;return u[t]!==void 0&&(e=u[t]),e},m=function(t){var e=null;return l[t]!==void 0&&(e=l[t]),e},g=function(t){var e=null;return c[t]!==void 0&&(e=c[t]),e}}(gamedex.module("giantbomb"),gamedex,jQuery,_,moment),function(t,e,n){"use strict";var i=e.module("amazon"),s=e.module("giantbomb"),a=e.module("utilities");t.standardizeTitle=function(t){var e=t,n=null,i=null;return e=e.replace(/\s*[\[\(].*[\)\]]/gi,""),e=e.replace(/\s*trophies/gi,""),e=e.replace(/\S+ edition$/gi,""),e=e.replace(/\swith\s.*/gi,""),e=e.replace(/^\s*the\s/gi,""),i&&i[0].length>3&&(e=e.replace(n,"")),e.toLowerCase()},t.getSimilarityScore=function(t,e){var n=100,i=u(t.standardName,e.name);if(n-=i,e.releaseDate!==void 0){var s=Math.floor((Date.parse(t.releaseDate)-Date.parse(e.releaseDate))/864e5);0===s&&(n+=100),isNaN(s)||"1900-01-01"===e.releaseDate||(n-=Math.abs(s/365))}if(e.platform!==void 0){var r=a.matchPlatformToIndex(e.platform).name;t.platform===r&&(n+=20)}return n},t.convertRomanNumerals=function(t){var e=RegExp("\\s[XVI]+","gi"),n=e.exec(t);if(n&&n[0].length>0){var i=n[0],s=RegExp("III","gi"),a=s.exec(i),r="";a&&a[0].length>0&&(r=3,i=i.replace(s,""));for(var o=i.split(""),l=null,c=o.length-1;c>=1;c--){switch(o[c]){case"I":l=1;break;case"V":l=5;break;case"X":l=10}r>l?r-=l:r+=l}t=t.replace(e," "+r)}return t},t.findItemOnAlternateProvider=function(t,e,n,r,o){var u=null;switch(o=o!==void 0?o:null,e){case a.SEARCH_PROVIDERS.Amazon:var d=t.standardName;u=s.searchGiantBomb(d,function(e){c(e,t,r,o)});break;case a.SEARCH_PROVIDERS.GiantBomb:var h=0;"n/a"!==t.platform&&(h=a.getStandardPlatform(t.platform).amazon),u=i.searchAmazon(t.name,h,function(e){l(e,t,r,o,!1)},o,n)}return u},t.getLinkedItemData=function(t,e,n){switch(e){case a.SEARCH_PROVIDERS.Amazon:s.getGiantBombItemDetail(t.gbombID,function(t){o(t,n)});break;case a.SEARCH_PROVIDERS.GiantBomb:i.getAmazonItemDetail(t.asin,function(t){r(t,n)})}},t.findWikipediaMatch=function(e,n,i){for(var s=e,a={},r=null,o=-99999,l=0,c=0,u=s.length;u>c;c++)a={name:s[c]},0===c&&(r=a),l=t.getSimilarityScore(n,a),l>o&&(r=a,o=l);0!==s.length&&i(r)};var r=function(t,e){var s={};n("Item",t).each(function(){s=i.parseAmazonResultItem(n(this))}),e(s)},o=function(t,e){var n=s.parseGiantBombResultItem(t);e(n)},l=function(e,s,a,r,o){n("Item",e).length;var c={},u=0,d=null,h=-99999,f=0;n("Item",e).each(function(){c=i.parseAmazonResultItem(n(this)),c.isFiltered===void 0&&(0===u&&(d=c),u++,f=t.getSimilarityScore(s,c),f>h&&(d=c,h=f))}),d?a(d):o?r():i.searchAmazon(s.name,0,function(t){l(t,s,a,r,!0)},r)},c=function(e,n,i,a){for(var r=e.results,o={},l=null,c=-99999,u=0,d=0,h=r.length;h>d;d++)o=s.parseGiantBombResultItem(r[d]),0===d&&(l=o),u=t.getSimilarityScore(n,o),u>c&&(l=o,c=u);0!==r.length?i(l):a()},u=function(t,e){if(t==e)return 0;var n=t.length,i=e.length;if(0===n)return i;if(0===i)return n;var s=!1;try{s=!"0"[0]}catch(a){s=!0}s&&(t=t.split(""),e=e.split(""));var r=Array(n+1),o=Array(n+1),l=0,c=0,u=0;for(l=0;n+1>l;l++)r[l]=l;var d="",h="";for(c=1;i>=c;c++){for(o[0]=c,h=e[c-1],l=0;n>l;l++){d=t[l],u=d==h?0:1;var f=r[l+1]+1,p=o[l]+1,m=r[l]+u;f>p&&(f=p),f>m&&(f=m),o[l+1]=f}var g=r;r=o,o=g}return r[n]}}(gamedex.module("itemLinker"),gamedex,jQuery,_),function(t,e,n,i,s,a){"use strict";var r=e.module("user"),o=e.module("itemLinker"),l=e.module("itemCache"),c=e.module("tagView"),u=e.module("utilities"),d=e.api+"item/directory/",h=e.api+"item/",f=e.api+"item/add/",p=e.api+"item/delete/batch/",m=e.api+"item/delete/",g=e.api+"item/user/update/",v=e.api+"item/shared/price/update/",y=e.api+"item/metacritic/update/",_=e.api+"import/",b=u.VIEW_ALL_TAG_ID,w={},C={},x={},S={},T=function(){n(document).keypress(function(t){96==t.which&&(console.warn("------------ itemDataDirectory: -------",C),console.warn("------------ amazonDirectory: -------",x),console.warn("------------ giantBombDirectory: -------",S),console.warn("------------ items: -------------------",w))})},E=function(t){l.cacheItemsByTag(t,C)},k=function(t){var e=null,i=r.getUserCredentials(),s=l.getStoredItemDirectory();if(s)I(s),t&&t(s);else{var a={};n.extend(!0,a,i),e=n.ajax({url:d,type:"POST",data:a,dataType:"json",cache:!0,success:function(e){D(e),l.storeItemDirectory(C),t&&t(e)},error:function(){}})}return e},D=function(t){var e={};i.each(t.directory,function(t,n){e={itemID:n,asin:t.aid,gbombID:t.gid,gameStatus:t.gs,playStatus:t.ps,tags:t.t,tagCount:t.tc,userRating:t.ur},q(e)})},I=function(t){i.each(t,function(t){q(t)})},P=function(t,e,i){var s=null,a=l.getCachedItemsByTag(t);if(a)w=a,e(a);else{var o={list_id:t},c=r.getUserCredentials();n.extend(!0,o,c),s=n.ajax({url:h,type:"POST",data:o,dataType:"json",cache:!0,success:function(t){w=V(t),e(w)},error:i})}return s},V=function(t){var e={},n={};return i.each(t.items,function(t){n={};var i=t.ip,s=t.ib||"",a=M(t.si,s,i),r=M(t.ti,s,i),o=M(t.li,s,i);n.id=t.iid,n.initialProvider=t.ip,n.itemID=t.iid,n.asin=t.aid,n.gbombID=t.gid,n.name=t.n,n.releaseDate=t.rd,n.platform=t.p,n.smallImage=a,n.thumbnailImage=r,n.largeImage=o,n.metascore=t.ms,n.metascorePage=t.mp,n.offers={},null!==t.ap&&(n.offers.buyNowPrice=t.ap,n.offers.buyNowRawPrice=t.ap.replace(".",""),n.offers.offersURL=t.apu,n.offers.productURL=t.apu),null!==t.anp&&(n.offers.lowestNewPrice=t.anp,n.offers.offersURLNew=t.anpu),null!==t.aup&&(n.offers.lowestUsedPrice=t.aup,n.offers.offersURLUsed=t.aupu),null!==t.sp&&(n.steamPrice=t.sp,n.steamPage=t.spu),n.description="",$(n),e[n.itemID]=n}),e},A=function(t){return w[t]},O=function(t,e,s,o){var l=null,u=r.getUserCredentials(!0),d=n.extend(!0,{},e),h=N(d.smallImage,d.initialProvider),p=N(d.thumbnailImage,d.initialProvider),m=N(d.largeImage,d.initialProvider),g=h.split(""),v=p.split(""),y=m.split(""),_=R(g,v,y),b=g.slice(0,_).join("");h=g.slice(_).join(""),p=v.slice(_).join(""),m=y.slice(_).join("");var w={lids:t,n:d.name,rd:d.releaseDate,aid:d.asin,gid:d.gbombID,ip:d.initialProvider,p:d.platform,ib:b,si:h,ti:p,li:m,mp:d.metascorePage,ms:d.metascore,gs:d.gameStatus,ps:d.playStatus,ur:d.userRating};return i.isUndefined(d.offers)||(i.isUndefined(d.offers.buyNowPrice)||(w.ap=d.offers.buyNowPrice,w.apu=d.offers.productURL),i.isUndefined(d.offers.lowestNewPrice)||(w.anp=d.offers.lowestNewPrice,w.anpu=d.offers.offersURLNew),i.isUndefined(d.offers.lowestUsedPrice)||(w.aup=d.offers.lowestUsedPrice,w.aupu=d.offers.offersURLUsed)),i.isUndefined(d.steamPrice)||(w.sp=d.steamPrice,w.spu=d.steamPage),n.extend(!0,w,u),l=n.ajax({url:f,type:"POST",data:w,dataType:"json",cache:!0,success:function(n){e.id=n.itemID,e.itemID=n.itemID;var r=U(e,n);c.updateInitialItemTags(n.tagIDsAdded,n.idsAdded);var o=[],l=" added to tag: ";i.each(t,function(t){o.push(c.getTagName(t))}),t.length>1&&(l=" added to tags: "),a.success(d.name+l+o.join(", ")),s(n,r)},error:o})},R=function(t,e,n){for(var i=0,s=0,a=t.length;a>s&&t[s]===e[s]&&t[s]===n[s];s++)i=s;return i+1},N=function(t,e){var n=t;return e===u.SEARCH_PROVIDERS.Amazon?n=t.replace(u.AMAZON_IMAGE.RE,u.AMAZON_IMAGE.TOKEN):e===u.SEARCH_PROVIDERS.GiantBomb&&(n=t.replace(u.GIANTBOMB_IMAGE.RE,u.GIANTBOMB_IMAGE.TOKEN)),n},M=function(t,e,n){var i=t,s=null;return t=e+t,n==u.SEARCH_PROVIDERS.Amazon?(s=RegExp(u.AMAZON_IMAGE.TOKEN,"g"),i=t.replace(s,u.AMAZON_IMAGE.URL)):n==u.SEARCH_PROVIDERS.GiantBomb&&(s=RegExp(u.GIANTBOMB_IMAGE.TOKEN,"g"),i=t.replace(s,u.GIANTBOMB_IMAGE.URL)),i},L=function(t,e,s,o,l){var u=r.getUserCredentials(!0),d={ids:t};n.extend(!0,d,u),n.ajax({url:p,type:"POST",data:d,dataType:"json",cache:!0,success:function(){var t=[],n=" removed from tag: ";i.each(e,function(e){t.push(c.getTagName(e))}),e.length>1&&(n=" removed from tags: "),a.error(s.name+n+t.join(", "))},error:l}),j(s.itemID,t,e),o(s.itemID,e)},j=function(t,e,n){for(var i=0,s=e.length;s>i;i++)G(n[i],t)},F=function(t,e,i,s){var a=K(t).tags[e],o=r.getUserCredentials(!0),l={id:a};return n.extend(!0,l,o),n.ajax({url:m,type:"POST",data:l,dataType:"json",cache:!0,success:function(){},error:s}),G(e,t),i(a,e),t},B=function(t,e,s,a){var o=!1,l=n.extend(!0,{},t),c={id:l.itemID};if(e==u.PRICE_PROVIDERS.Amazon?i.isUndefined(l.offers)||0===i.keys(l.offers).length?(l.offers={buyNowPrice:"",buyNowRawPrice:"",lowestNewPrice:"",lowestUsedPrice:"",offersURL:"",offersURLNew:"",offersURLUsed:"",productURL:""},c.ap="",c.apu="",c.anp="",c.anpu="",c.aup="",c.aupu=""):(i.isUndefined(l.offers.buyNowPrice)||""===l.offers.buyNowPrice||(o=!0,c.ap=l.offers.buyNowPrice,c.apu=l.offers.productURL),i.isUndefined(l.offers.lowestNewPrice)||""===l.offers.lowestNewPrice||(o=!0,c.anp=l.offers.lowestNewPrice,c.anpu=l.offers.offersURLNew),i.isUndefined(l.offers.lowestUsedPrice)||""===l.offers.lowestUsedPrice||(o=!0,c.aup=l.offers.lowestUsedPrice,c.aupu=l.offers.offersURLUsed)):e==u.PRICE_PROVIDERS.Steam&&(i.isUndefined(l.steamPrice)?(o=!0,l.steamPrice="",l.steamPage="",c.sp="",c.spu=""):i.isUndefined(l.steamPrice)||""===l.steamPrice||(o=!0,c.sp=l.steamPrice,c.spu=l.steamPage)),o){var d=K(t.itemID).tags,h=r.getUserCredentials(!0);Y(l,d),n.extend(!0,c,h),n.ajax({url:v,type:"POST",data:c,dataType:"json",cache:!0,success:function(t){s(l,t)},error:a})}},z=function(t,e,i){var s=r.getUserCredentials(!0),o=n.extend(!0,{},t),l={id:o.itemID,gs:o.gameStatus,ps:o.playStatus,ur:o.userRating};n.extend(!0,l,s),n.ajax({url:g,type:"POST",data:l,dataType:"json",cache:!0,success:function(t){W(o),e(o,t),a.success(o.name+" status updated")},error:i})},H=function(t,e,i){var s=K(t.itemID).tags,a=r.getUserCredentials(!0),o=n.extend(!0,{},t),l={id:o.itemID,mp:o.metascorePage,ms:o.metascore};n.extend(!0,l,a),Y(o,s),n.ajax({url:y,type:"POST",data:l,dataType:"json",cache:!0,success:function(t){e&&e(o,t)},error:i})},U=function(t,e){var s=null,a=null,r=[];t.itemID=e.itemID;for(var o=0,c=e.tagIDsAdded.length;c>o;o++)a=n.extend(!0,{},t),a.id=e.itemID,$(a),l.cacheItemByTag(e.tagIDsAdded[o],a),r.push(a);Q(a,e),s=l.getCachedItemsByTag(b);var u=!1;return i.each(s,function(t){t.itemID===a.itemID&&(u=!0)}),u||l.cacheItemByTag(b,a),r},G=function(t,e){l.deleteCachedItem(e,t),J(e,t),0===C[e].tagCount&&l.deleteCachedItem(e,b)},$=function(t){t.calendarDate="1900-01-01"!==t.releaseDate?s(t.releaseDate,"YYYY-MM-DD").calendar():"Unknown",t.standardName=o.standardizeTitle(t.name)},W=function(t){var e=C[t.itemID];e.gameStatus=t.gameStatus,e.playStatus=t.playStatus,e.userRating=t.userRating,l.storeItemDirectory(C)},Y=function(t,e){i.each(e,function(e,n){l.updateCacheItemByTag(n,t)}),l.updateCacheItemByTag(0,t)},Q=function(t,e){if(!C[e.itemID]){var n={itemID:t.itemID,asin:t.asin,gbombID:t.gbombID,gameStatus:t.gameStatus,playStatus:t.playStatus,tags:{},tagCount:0,userRating:t.userRating};q(n)}for(var i=0,s=e.tagIDsAdded.length;s>i;i++)C[e.itemID].tags[e.tagIDsAdded[i]]=e.idsAdded[i],C[e.itemID].tagCount+=1;l.storeItemDirectory(C)},J=function(t,e){var n=C[t];delete n.tags[e],n.tagCount+=-1,l.storeItemDirectory(C)},q=function(t){C[t.itemID]=t,0!==parseInt(t.asin,10)&&(x[t.asin]=t),0!==parseInt(t.gbombID,10)&&(S[t.gbombID]=t)},X=function(){return C},K=function(t){return C[t]||null},Z=function(t,e){var n=null;return 0!==t?n=S[t]:0!==e&&(n=x[e]),n},te=function(){w={},C={},x={},S={},l.clearItemCache()},ee=function(){var t=[];i.each(w,function(e,n){t.push(n)});var e=Math.floor(Math.random()*t.length);return t[e]},ne=function(t,e,i){var s=r.getUserCredentials(!0),a={source:t,source_user:e};n.extend(!0,a,s),n.ajax({url:_,type:"POST",data:a,dataType:"json",cache:!0,success:i,error:function(){}})},ie={init:T,itemsAndDirectoryLoaded:E,getItemDirectory:X,getDirectoryItemByItemID:K,getItemByThirdPartyID:Z,resetItemData:te,getRandomItemID:ee,getItems:P,getItem:A,downloadItemDirectory:k,addItemToTags:O,updateUserItem:z,updateSharedItemPrice:B,updateMetacritic:H,deleteTagsForItem:L,deleteSingleTagForItem:F,deleteTagFromDirectory:J,deleteClientItem:G,importGames:ne};n.extend(t,ie)}(gamedex.module("itemData"),gamedex,$,_,moment,alertify),function(t,e,n){"use strict";var i=e.api+"tag/",s=e.api+"tag/add/",a=e.api+"tag/update/",r=e.api+"tag/delete/",o=e.module("user"),l=e.module("storage"),c=(e.module("itemData"),{});t.getTags=function(t,e){var s=null,a=o.getUserCredentials(),r={};return n.extend(!0,r,a),c=l.get("tag"),c?t&&t(c):s=n.ajax({url:i,type:"POST",data:r,dataType:"json",cache:!0,success:function(e){c=l.set("tag",e.list),t(e.list)},error:e}),s},t.addTag=function(t,e,i){var a=o.getUserCredentials(!0),r={tag_name:t};n.extend(!0,r,a),n.ajax({url:s,type:"POST",data:r,dataType:"json",cache:!0,success:function(t){c.push({tagName:t.tagName.toLowerCase(),tagID:t.tagID}),l.set("tag",c),e(t)},error:i})},t.updateTag=function(t,e,i,s){var r=o.getUserCredentials(!0),u={tag_name:t,tag_id:e};n.extend(!0,u,r),n.ajax({url:a,type:"POST",data:u,dataType:"json",cache:!0,success:function(t){i(t)},error:s});for(var d=0,h=c.length;h>d;d++)c[d].tagID===e&&(c[d].tagName=t,l.set("tag",c))},t.deleteTag=function(t,e,i){var s=o.getUserCredentials(!0),a={id:t};n.extend(!0,a,s),n.ajax({url:r,type:"POST",data:a,dataType:"json",cache:!0,success:e,error:i});for(var u=0,d=c.length;d>u;u++)if(c[u].tagID===t){c.splice(u,1),l.set("tag",c);break}}}(gamedex.module("tagData"),gamedex,jQuery,_),function(t,e,n,i){"use strict";var s=(e.module("amazon"),e.module("itemLinker")),a=e.module("itemData"),r=e.api+"metacritic/search/",o=e.api+"metacritic/cache/",l="metacritic.com",c={},u={};t.getMetascore=function(t,e,s,o){var l=null,c=h(e.asin,e.gbombID,e.platform);if(c)l=c,e.metascore=c.metascore,e.metascorePage=c.metascorePage,o(e);else{var g=t+"_"+e.platform;if(i.has(u,g)||(u[g]=[]),u[g].push(o),1===u[g].length){var v=d(t),y={keywords:encodeURI(v),platform:encodeURI(e.platform)};l=n.ajax({url:r,type:"GET",data:y,cache:!0,success:function(t){var n=e.metascore,r=p(v,t,e);m(r,e),s||e.metascore==n||a.updateMetacritic(e),i.each(u[g],function(t){f(e.asin,e.gbombID,e.platform,e),t(e)}),u[g]=[]}})}}return l},t.displayMetascoreData=function(t,e,i){var s=n(i),a=e,r="favorable";0>e?(a="n/a",r="unavailable"):50>e?r="unfavorable":75>e&&(r="neutral"),s.html(a).removeClass("unavailable").removeClass("unfavorable").removeClass("neutral").removeClass("favorable").addClass(r).attr("href","http://www."+l+t).attr("data-score",e).attr("data-original-title",l+" "+t).show();var o=s.data("opentips");o&&o.length>0?o[0].setContent(s.attr("data-original-title")):s.opentip(s.attr("data-original-title"),{tipJoint:"bottom"})};var d=function(t){n=/\s*[:&]\s*/g;var e=t.replace(n," "),n=/\s/g;return e=e.replace(n,"+")},h=function(t,e,n){var i=null;return c[t+"_"+n]!==void 0?i=c[t+"_"+n]:c[e+"_"+n]!==void 0&&(i=c[e+"_"+n]),i
},f=function(t,e,n,i){"0"!=t&&(c[t+"_"+n]={metascorePage:i.metascorePage,metascore:i.metascore}),"0"!=e&&(c[e+"_"+n]={metascorePage:i.metascorePage,metascore:i.metascore})},p=function(t,e,n){var i=null;return e.metascore===void 0?(i=v(e,n),i&&g(t,n.platform,i.metascore,i.metascorePage)):i=e,i},m=function(t,e){t&&""!==t.metascore?(e.metascore=t.metascore,e.displayMetascore=t.metascore,e.metascorePage=t.metascorePage):t?(e.metascore=-1,e.displayMetascore="n/a",e.metascorePage=t.metascorePage):(e.metascore=-1,e.displayMetascore="n/a",e.metascorePage="")},g=function(t,e,i,s){var a={keywords:encodeURI(t),platform:encodeURI(e),metascore:encodeURI(i),metascorePage:encodeURI(s)};n.ajax({url:o,type:"GET",data:a,cache:!0,success:function(){}})},v=function(t,e){var i=n("#main",t).find(".result"),a={},r=null,o=-99999,l=0;return n(i).each(function(){var t=new Date(n(this).find(".release_date .data").text()),i=t.getMonth()+1;i=10>i?"0"+i:i;var c=t.getDate();c=10>c?"0"+c:c,a={name:n(this).find(".product_title a").text(),releaseDate:t.getFullYear()+"-"+i+"-"+c,platform:n(this).find(".platform").text(),metascore:n(this).find(".metascore").text(),metascorePage:n(this).find(".product_title a").attr("href")},l=s.getSimilarityScore(e,a),l>o&&(r=a,o=l)}),r}}(gamedex.module("metacritic"),gamedex,jQuery,_),function(t){var e=(gamedex.module("user"),gamedex.module("utilities"),gamedex.module("itemLinker")),n={};t.getWikipediaPage=function(t,a,r){var o=n[a.id];o&&o.wikipediaPage!==void 0?r(o.wikipediaPage):i(t,function(t){pageArray=t[1],e.findWikipediaMatch(pageArray,a,function(t){s(t.name,function(t){_.each(t.query.pages,function(t){o?o.wikipediaPage=t.fullurl:n[a.id]={wikipediaPage:t.fullurl},r(t.fullurl)})})})})};var i=function(t,e,n){var i="http://en.wikipedia.org/w/api.php?action=opensearch&format=json&callback=?",s={search:t,prop:"revisions",rvprop:"content"};$.ajax({url:i,type:"GET",data:s,dataType:"jsonp",cache:!1,crossDomain:!0,success:e,error:n})},s=function(t,e,n){var i="http://en.wikipedia.org/w/api.php?action=query&format=json&callback=?",s={titles:t,prop:"info",inprop:"url"};$.ajax({url:i,type:"GET",data:s,dataType:"jsonp",cache:!1,crossDomain:!0,success:e,error:n})}}(gamedex.module("wikipedia")),function(t,e,n,i){"use strict";var s=(e.module("amazon"),e.module("itemLinker")),a=(e.module("itemData"),e.api+"gametrailers/search/"),r=e.api+"gametrailers/cache/",o={},l={};t.getGametrailersPage=function(t,e,s){var r=null,o=u(t);if(o)e.gametrailersPage=o.gametrailersPage,s(e.gametrailersPage);else{var f=t+"_";if(i.has(l,f)||(l[f]=[]),l[f].push(s),1===l[f].length){var p=c(t),m={keywords:encodeURI(p)};r=n.ajax({url:a,type:"GET",data:m,cache:!0,success:function(n){var s=h(p,n,e);i.each(l[f],function(n){e.gametrailersPage=s,d(t,s),n(s)}),l[f]=[]}})}}return r};var c=function(t){n=/\s*[:&]\s*/g;var e=t.replace(n," "),n=/\s/g;return e=e.replace(n,"+")},u=function(t){var e=null;return o[t]!==void 0&&(e=o[t]),e},d=function(t,e){o[t]={gametrailersPage:e}},h=function(t,e,n){var i=null;return e.gametrailersPage===void 0?(i=p(e,n),i&&f(t,i)):i=e.gametrailersPage,i},f=function(t,e){var i={keywords:encodeURI(t),gametrailersPage:encodeURI(e)};n.ajax({url:r,type:"GET",data:i,cache:!0,success:function(){}})},p=function(t,e){var i=n("#games",t).find(".video_game_information_child"),a={},r=null,o=-99999,l=0;return n(i).each(function(){a={name:n(this).find(".content h3 a").text(),releaseDate:n(this).find(".content dl dd:eq(1) a").text(),gametrailersPage:n(this).find(".content h3 a").attr("href")},l=s.getSimilarityScore(e,a),l>o&&(r=a,o=l)}),r?r.gametrailersPage+"/videos-trailers":null}}(gamedex.module("gameTrailers"),gamedex,jQuery,_),function(t,e,n,i){"use strict";var s=e.module("itemLinker"),a=e.api+"steam/search/",r=e.api+"steam/cache/",o={},l={};t.getSteamGame=function(t,e,s,r){var o=null,f=u(t);if(f)e.steamPage=f.steamPage,e.steamPrice=f.steamPrice,s(f);else{var p=t+"_";if(i.has(l,p)||(l[p]=[]),l[p].push(s),1===l[p].length){var m=c(t),g={keywords:m};o=n.ajax({url:a,type:"GET",data:g,cache:!0,success:function(n){var s=h(m,n,e);s?i.each(l[p],function(n){e.steamPage=s.steamPage,e.steamPrice=s.steamPrice,d(t,s.steamPage,s.steamPrice),n(s)}):i.isUndefined(r)||r(),l[p]=[]}})}}return o};var c=function(t){var e=/\s*[:&]\s*/g,n=t.replace(e," ");return n},u=function(t){var e=null;return o[t]!==void 0&&(e=o[t]),e},d=function(t,e,n){o[t]={steamPage:e,steamPrice:n}},h=function(t,e,n){var i={};return e.url===void 0?(i=p(e,n),i&&f(t,i.steamPage,i.steamPrice)):i={steamPage:e.url,steamPrice:e.price},i},f=function(t,e,i){var s={keywords:encodeURI(t),url:encodeURI(e),price:encodeURI(i)};n.ajax({url:r,type:"GET",data:s,cache:!0,success:function(){}})},p=function(t,e){var n=null,a=-99999,r=0;return i.each(t,function(t){r=s.getSimilarityScore(e,t),r>a&&(n={steamPage:t.page,steamPrice:t.price.replace("$","")},a=r)}),n}}(gamedex.module("steam"),gamedex,jQuery,_),function(t,e,n){var i=e.api+"list/ign/upcoming/popular/",s=e.api+"list/ign/upcoming/",a=e.api+"list/ign/reviewed/",r={};IGNUpcomingListCache={},IGNReviewedListCache={},t.getPopularGames=function(t,e,s){var a=o(r,t,e);if(a)s(a);else{var l={platform:t,page:e};n.ajax({url:i,type:"GET",data:l,cache:!0,success:function(n){r[t+"_"+e]=n,s(n)}})}},t.getUpcomingGames=function(t,e,i){var a=o(IGNUpcomingListCache,t,e);if(a)i(a);else{var r={platform:t,page:e};n.ajax({url:s,type:"GET",data:r,cache:!0,success:function(n){IGNUpcomingListCache[t+"_"+e]=n,i(n)}})}},t.getReviewedGames=function(t,e,i){var s=o(IGNReviewedListCache,t,e);if(s)i(s);else{var r={platform:t,page:e};n.ajax({url:a,type:"GET",data:r,cache:!0,success:function(n){IGNReviewedListCache[t+"_"+e]=n,i(n)}})}};var o=function(t,e,n){var i=null;return t[e+"_"+n]!==void 0&&(i=t[e+"_"+n]),i}}(gamedex.module("ign"),gamedex,jQuery,_),function(t,e,n,i){"use strict";var s=e.module("utilities"),a=e.api+"list/gt/released/",r={},o={},l={};t.getReleasedGames=function(t,e,s,f,p){var m=h(e,s,f),g=null;if(m){var v=d(m,t);p(v,o)}else{var y=e+"_"+s+"_"+f;if(i.has(l,y))l[y].platform=t;else{var _={platform:t};l[y]=_;var b={year:e,month:s,day:f};g=n.ajax({url:a,type:"GET",data:b,cache:!0,success:function(t){c(t),u(t);var n=d(t,l[y].platform);r[e+"_"+s+"_"+f]=t,p(n,o),delete l[y]}})}}return g};var c=function(t){i.each(t,function(t){var e=t.platforms.split(",");t.linkedPlatforms={all:void 0},i.each(e,function(e){var n=i.str.trim(e),a=s.getStandardPlatform(n);t.linkedPlatforms[a.id]=a.name})})},u=function(t){i.each(t,function(t){i.each(t.linkedPlatforms,function(t,e){o[e]=i.has(o,e)?o[e]+1:1})})},d=function(t,e){var n=[];return i.each(t,function(t){t.name=t.name.replace(/\sbox\s*.*/gi,""),i.has(t.linkedPlatforms,e)&&n.push(t)}),n},h=function(t,e,n){var i=null;return r[t+"_"+e+"_"+n]!==void 0&&(i=r[t+"_"+e+"_"+n]),i}}(gamedex.module("releasedList"),gamedex,jQuery,_),function(t,e,n,i,s,a){"use strict";var r=e.module("user"),o=e.module("itemData"),l=e.module("tagView"),c=e.module("itemView"),u=e.module("searchView"),d=e.module("storage"),h=e.module("gridView"),f={login:0,signup:1},p=600,m="Demo",g=!1,v=f.login,y=!1,_=1,b=n("#content"),w=(n("#infoHeader"),n("#header"),n("#userMenu")),C=n("#loggedInButton"),x=n(".miniLogo"),S=n("#managementButton"),T=n("#updateProfileButton"),E=n("#changePasswordButton"),k=n("#logoutButton"),D=n("#hideInfoHeader_btn"),I=n("#showInfoHeader_btn"),P=n("#loginForm"),V=n("#buttonContainer"),A=n("#loginButton"),O=n("#loginHitArea"),R=n("#signupButton"),N=n("#signupHitArea"),M=n("#loginSubmitButton"),L=n("#signupSubmitButton"),j=n("#backButton"),F=n("#email").find("input"),B=n("#password").find("input"),z=n("#rememberCheckboxToggle"),H=n("#resetPasswordButton"),U=n("#invalidLoginTag"),G=n("#accountExistsTag"),$=n("#accountManagement-modal"),W=$.find("#clearLocalStorage_btn"),Y=($.find(".alert-success"),$.find(".alert-error")),Q=$.find(".existingPasswordGroup"),J=n("#accountPasswordField"),q=n("#deleteAccount_btn"),X=n("#deleteAccountConfirm-modal"),K=n("#deleteAccountConfirm_btn"),Z=n("#updateProfile-modal"),te=Z.find(".usernameGroup"),ee=Z.find("#userNameUpdateField"),ne=Z.find(".emailGroup"),ie=Z.find("#emailUpdateField"),se=Z.find("#profilePasswordField"),ae=Z.find(".existingPasswordGroup"),re=Z.find(".alert-success"),oe=Z.find(".alert-error"),le=Z.find("#updateAccount_btn"),ce=Z.find(".profileURL"),ue=n("#changePassword-modal"),de=ue.find(".existingPasswordGroup"),he=ue.find(".confirmPasswordGroup"),fe=ue.find(".newPasswordGroup"),pe=ue.find("#passwordUpdateField"),me=ue.find("#passwordConfirmField"),ge=ue.find("#existingPasswordField"),ve=ue.find(".alert-error"),ye=ue.find(".alert-success"),_e=ue.find("#changePassword_btn"),be=n("#resetpassword-modal"),we=be.find(".resetCodeForm"),Ce=be.find(".updatePasswordForm"),xe=be.find(".passwordResetCodeContainer"),Se=be.find(".passwordResetEmailContainer"),Te=be.find(".alert-success"),Ee=be.find(".alert-error"),ke=n("#resetPasswordEmailField"),De=n("#resetPasswordCodeField"),Ie=n("#resetPasswordPasswordField"),Pe=n("#sendResetCode_btn"),Ve=n("#submitResetCode_btn"),Ae=n("#updatePassword_btn"),Oe=n("#guideHitArea"),Re=n("#guideButton"),Ne=n("#siteGuide"),Me=(n("#siteGuideBackdrop"),Ne.find(".siteGuideExit_btn")),Le=Ne.find(".siteGuidePrevious_btn"),je=Ne.find(".siteGuideNext_btn"),Fe=(n("#searchField input"),n("#itemResultsContainer").find(".loadingStatus")),Be=function(){s.set({labels:{ok:"Close",cancel:"Close"},delay:2e3}),ze(),He(),Ge(),be.modal({backdrop:!0,keyboard:!0,show:!1}),Qe()},ze=function(){a.lastZIndex=1e5,a.styles.info={"extends":"standard",title:void 0,escapeTitle:!0,escapeContent:!1,className:"info",stem:!0,delay:null,hideDelay:0,fixed:!0,showOn:"mouseover",hideTrigger:"trigger",hideTriggers:[],hideOn:null,offset:[0,0],containInViewport:!0,autoOffset:!0,showEffect:"appear",hideEffect:"fade",showEffectDuration:.3,hideEffectDuration:.2,stemLength:8,stemBase:8,tipJoint:"top",target:!0,targetJoint:null,ajax:!1,ajaxMethod:"GET",ajaxCache:!0,group:null,style:null,background:"rgba(50, 63, 66, .9);",backgroundGradientHorizontal:!1,closeButtonOffset:[5,5],closeButtonRadius:7,closeButtonCrossSize:4,closeButtonCrossColor:"#d2c35b",closeButtonCrossLineWidth:1.5,closeButtonLinkOverscan:6,borderRadius:3,borderWidth:1,borderColor:"rgba(255, 255, 255, .5)",shadow:!0,shadowBlur:10,shadowOffset:[3,3],shadowColor:"rgba(0, 0, 0, 0.4)"},a.defaultStyle="info"},He=function(){window.addEventListener("popstate",function(){var t=window.location.pathname;Ue(t)}),D.click(function(t){t.preventDefault();var e=D.data("opentips");e[0].hide(),gn()}),I.click(function(t){t.preventDefault(),vn()}),S.click(function(t){t.preventDefault(),Tn()}),T.click(function(t){t.preventDefault(),En()}),E.click(function(t){t.preventDefault(),kn()}),le.click(function(t){t.preventDefault(),In()}),_e.click(function(t){t.preventDefault(),Dn()}),F.on("keydown",function(t){Sn(t.which)}),B.on("keydown",function(t){Sn(t.which)}),k.click(function(t){t.preventDefault(),tn()}),x.on("click",function(){tn()}),W.click(function(t){t.preventDefault(),d.clearStorage()}),q.click(function(t){t.preventDefault(),Pn()}),K.click(function(t){t.preventDefault(),Vn()}),N.click(function(t){t.preventDefault(),wn()}),N.mouseover(function(){R.addClass("hover")}),N.mouseout(function(){R.removeClass()}),N.mousedown(function(){R.addClass("active")}),N.mouseup(function(){R.removeClass("active")}),O.click(function(t){t.preventDefault(),bn()}),O.mouseover(function(){A.addClass("hover")}),O.mouseout(function(){A.removeClass()}),O.mousedown(function(){A.addClass("active")}),O.mouseup(function(){A.removeClass("active")}),Oe.click(function(){an(1)}),Oe.mouseover(function(){Re.addClass("hover")}),Oe.mouseout(function(){Re.removeClass()}),Oe.mousedown(function(){Re.addClass("active")}),Oe.mouseup(function(){Re.removeClass("active")}),M.click(function(t){t.preventDefault(),We(F.val(),B.val())}),L.click(function(t){t.preventDefault(),en(F.val(),B.val())}),j.click(function(t){t.preventDefault(),xn()}),z.click(function(){y?(y=!1,n(this).removeClass("on"),$e()):(y=!0,n(this).addClass("on"))}),H.click(function(t){t.preventDefault();var e=F.val()||d.getGlobal("email");e&&ke.val(e),be.modal("show"),i.delay(function(){ke.focus().select()},1e3)}),Pe.click(function(t){t.preventDefault(),on(ke.val())}),Ve.click(function(t){t.preventDefault(),cn(ke.val(),De.val())}),Ae.click(function(t){t.preventDefault(),dn(ke.val(),De.val(),Ie.val())}),ke.keydown(function(t){13===t.which&&(t.preventDefault(),on(ke.val()))}),De.keydown(function(t){13===t.which&&(t.preventDefault(),cn(ke.val(),De.val()))}),Ie.keydown(function(t){13===t.which&&(t.preventDefault(),dn(ke.val(),De.val(),Ie.val()))}),Ne.click(function(t){t.preventDefault(),t.stopPropagation()}),je.click(function(t){t.preventDefault(),an(++_)}),Le.click(function(t){t.preventDefault(),an(--_)}),Me.click(function(t){t.preventDefault(),_=1,an(0),rn()})},Ue=function(){m="Demo",g&&Qe()},Ge=function(){var t=d.getGlobal("email");t&&(y=!0,F.val(t),z.addClass("on"),B.focus())},$e=function(){y?d.setGlobal("email",F.val()):d.removeGlobal("email")},We=function(t,e){Ye(),r.login(t,e,nn)},Ye=function(){B.val(""),U.hide(),G.hide()},Qe=function(){var t=window.location.pathname.split("/"),e=t[1];""!==e?r.validateUser(e,function(t){"success"===t.status?qe(e):Xe(e)}):g||Je()},Je=function(){s.success("Loading Demo"),Ke(),r.demoLogin(),Ze()},qe=function(t){m=t,s.success("Loading User: "+t),mn(t),Ze()},Xe=function(t){s.alert('User "'+t+'" not found'),Je()},Ke=function(){var t=window.location.pathname;history&&"/"!==t&&history.pushState(null,null,"/"),n("body").removeClass("viewOnly")},Ze=function(){Fe.addClass("show"),c.clearItemView(),c.resizePanel(),o.resetItemData(),window.setTimeout(function(){var t=null,e=null,i=o.downloadItemDirectory(),s=c.initializeUserItems(function(e){t=e},function(){t={}}),a=l.getTags(function(t){e=t},function(){});n.when(s,i,a).then(function(){l.getTags_result(e),c.initializeUserItems_result(t),Fe.removeClass("show"),g=!0},function(){})},p)},tn=function(){m="Demo",vn(),c.clearItemView(),h.exitGridView(),r.logout(),Je()},en=function(t,e){Ye(),""!==t&&""!==e&&r.createUser(t,e,sn)},nn=function(t,e){"success"===t.status?($e(),pn(e),Ze()):t.status!==void 0&&"invalid_login"===t.status&&(s.error("Login Failed: "+e),U.fadeIn())},sn=function(t,e){t.status!==void 0&&"user_exists"===t.status?G.fadeIn():($e(),nn(t,e))},an=function(t){t&&(b.removeClass(),b.addClass("step"+t)),Ne.is(":visible")||Ne.show()},rn=function(){Ne.is(":visible")&&(Ne.hide(),b.removeClass())},on=function(t){r.sendResetPasswordCode(t,ln)},ln=function(t){t.status!==void 0&&"success"===t.status?(Pe.hide(),Ve.show(),Se.hide(),xe.show(),Te.find(".alertTitle").text("E-mail sent:"),Te.show().find(".alertText").html("Check your e-mail and enter the <strong>3-digit code</strong> into the field above"),Ee.hide()):t.status!==void 0&&"invalid_email"===t.status&&(Ee.find(".alertTitle").text("Invalid E-mail address:"),Ee.show().find(".alertText").html("Cannot send password reset code"))},cn=function(t,e){r.submitResetPasswordCode(t,e,un)},un=function(t){t.status!==void 0&&"success"===t.status?(we.hide(),Ve.hide(),Ce.show(),Ae.show(),Te.hide(),Ee.hide()):(Te.hide(),Ee.find(".alertTitle").text("Invalid code:"),Ee.show().find(".alertText").html("Reset code is incorrect, please try again"))},dn=function(t,e,n){r.updatePassword(t,e,n,function(e){hn(e,t,n)})},hn=function(t,e,n){t.status!==void 0&&"success"===t.status&&(fn(),F.val(e),B.val(n),We(F.val(),B.val()))},fn=function(){be.modal("hide"),Pe.show(),Ve.hide(),Ae.hide(),we.hide(),Ce.hide(),Se.show(),xe.hide(),Te.hide(),Ee.hide(),ke.val(""),De.val(""),Ie.val("")},pn=function(t){Ke(),yn(),C.find(".userEmail").text(t),w.show()},mn=function(t){yn(),n("body").addClass("viewOnly"),C.find(".userEmail").text(t)},gn=function(){yn(),n("body").addClass("demo"),C.find(".userEmail").text(m)},vn=function(){_n()},yn=function(){n("body").removeClass("infoHeader"),n("body").addClass("useHeader"),c.loggedInView(!0),u.loggedInView(!0),w.show()},_n=function(){n("body").removeClass("useHeader"),n("body").addClass("infoHeader"),n("body").removeClass("viewOnly"),n("body").removeClass("demo"),c.loggedInView(!1),u.loggedInView(!1),w.hide()},bn=function(){v=f.login,Cn(),M.show(),L.hide(),j.removeClass("signup"),j.addClass("login")},wn=function(){v=f.signup,Cn(),L.show(),M.hide(),j.removeClass("login"),j.addClass("signup")},Cn=function(){Ye(),P.show(),j.show(),y&&""!==F.val()?B.focus():F.focus(),V.hide()},xn=function(){P.hide(),M.hide(),L.hide(),j.hide(),V.show()},Sn=function(t){13===t&&v===f.login?We(F.val(),B.val()):13===t&&v===f.signup&&en(F.val(),B.val())},Tn=function(){An(),$.modal("show")},En=function(){An();var t=r.getUserData();ee.val(t.userName),ie.val(t.email),ce.text("http://www.gamedex.net/"+t.userName),Z.modal("show")},kn=function(){An(),ue.modal("show")},Dn=function(){An();var t=ge.val(),e=r.getUserData().email,n=pe.val(),i=me.val();""!==t&&""!==e&""!==n&""!==i&n==i&&r.updateUser(t,e,"",n,function(t){"success"===t.status?(ye.fadeIn().find(".alertText").text("Password Changed"),pe.val(""),me.val(""),ge.val("")):"incorrect_password"===t.status&&(de.addClass("error"),ve.fadeIn().find(".alertText").text("Incorrect password"),ge.val(""))}),""===n?(fe.addClass("error"),ve.fadeIn().find(".alertText").text("Please enter new password")):""===i?(he.addClass("error"),ve.fadeIn().find(".alertText").text("Please confirm password")):n!==i?(pe.val(""),me.val(""),fe.addClass("error"),he.addClass("error"),ve.fadeIn().find(".alertText").text("Passwords do not match")):""===t&&(de.addClass("error"),ve.fadeIn().find(".alertText").text("Please enter existing password"))},In=function(){An();var t=se.val(),e=ie.val(),n=ee.val();""!==t&&""!==e&&r.updateUser(t,e,n,"",function(t){"success"===t.status?(ce.text("http://www.gamedex.net/"+n),C.find(".userEmail").text(e),se.val(""),re.fadeIn().find(".alertText").text("Account updated")):"incorrect_password"===t.status?(se.val(""),ae.addClass("error"),oe.fadeIn().find(".alertText").text("Incorrect password")):"username_exists"===t.status&&(te.addClass("error"),oe.fadeIn().find(".alertText").text("User name exists"))}),""===t&&(ae.addClass("error"),oe.fadeIn().find(".alertText").text("Please enter existing password")),""===e&&(ne.addClass("error"),oe.fadeIn().find(".alertText").text("E-mail cannot be blank")),pe.val("")},Pn=function(){An();var t=J.val(),e=r.getUserData().email;""!==t&&""!==e?r.verifyUser(e,t,function(t){t.status!==void 0&&"success"==t.status?($.modal("hide"),X.modal("show")):(J.val(""),Q.addClass("error"),Y.show().find(".alertText").html("Incorrect Password"))},function(){J.val("")}):(Q.addClass("error"),Y.show().find(".alertText").html("Please enter existing password"))},Vn=function(){var t=J.val(),e=r.getUserData().user_id;J.val(""),r.deleteAccount(e,t,function(){X.modal("hide"),d.clearStorage(),tn()},function(){})},An=function(){Y.hide(),Q.removeClass("error"),te.removeClass("error"),ne.removeClass("error"),ae.removeClass("error"),re.hide(),oe.hide(),fe.removeClass("error"),he.removeClass("error"),de.removeClass("error"),ye.hide(),ve.hide()},On={init:Be,hideSiteGuide:rn};n.extend(t,On)}(gamedex.module("siteView"),gamedex,jQuery,_,alertify,Opentip),function(t,e,n,i,s,a){"use strict";var r=e.module("detailView"),o=e.module("amazon"),l=e.module("giantbomb"),c=e.module("utilities"),u=e.module("ign"),d=e.module("releasedList"),h=e.module("itemLinker"),f={POPULAR:0,UPCOMING:1,RELEASED:2,REVIEWED:3},p={"#searchTab":0,"#listTab":1},m=400,g={List:0,Icons:1,Cover:2},v=258,y=503,_=5,b=13,w=1500,C=1,x=null,S="skyrim",T="",E={},k=[],D=p["#searchTab"],I=!1,P=-1,V=-1,A=-1,O=!1,R=!1,N=!1,M=null,L=0,j=null,F=g.Icons,B=0,z=null,H=g.Icons,U=y,G=null,$={valueNames:["itemName","releaseDate"],item:"list-item"},W=n("#searchContainer"),Y=n("#searchViewMenu"),Q=n("#listType"),J=Q.find(".listTypeName"),q=n("#searchPlatforms"),X=n("#legacySubNav"),K=(n("#platformSelect_btn"),n("#listPlatforms")),Z=n("#listPlatforms").find("ul"),te=q.find(".platformName"),ee=K.find(".platformName"),ne=n("#finderTabLinks"),ie=(n("#finderTabContent"),n("#searchTab"),n("#listTab"),n("#searchTabLink")),se=n("#listTabLink"),ae=n("#searchField"),re=n("#search_btn"),oe=n("#clearSearch_btn"),le=(oe.find("i"),n("#searchResultsContainer")),ce=le.find(".content"),ue=n("#searchResults"),de=ae.find("input"),he=n("#listResultsContainer"),fe=he.find(".content"),pe=n("#listResults"),me=pe.find(".list"),ge=W.find(".searchDisplayOptions"),ve=W.find(".listDisplayOptions"),ye=le.find(".loadingStatus"),_e=he.find(".loadingStatus"),be=i.template(n("#search-results-template").html()),we=i.template(n("#list-results-template").html()),Ce=i.template(n("#list-platform-template").html()),xe=i.template(n("#search-results-platform-dropdown-template").html());t.init=function(){t.createEventHandlers(),ke(),z=c.PLATFORM_INDEX[0],j=c.getStandardPlatform(""),Ye(!1);var e={sliderMinHeight:20,iOSNativeScrolling:!0,preventPageScrolling:!0};le.nanoScroller(e),he.nanoScroller(e),setInterval(function(){Qe(),le.nanoScroller(),he.nanoScroller()},1500),fe.on("scroll",function(){var e=fe.scrollTop(),n=pe.height(),i=fe.height(),s=n-(e+i);w>s&&(I||(I=!0,t.loadNextListPages()))}),X.BootstrapSubMenu({$mainNav:q})},t.createEventHandlers=function(){ne.find('a[data-toggle="tab"]').on("shown",function(t){D=p[n(t.target).attr("href")],Oe(D)}),de.keyup(Ue),Y.on("mouseenter",".dropdown-toggle",function(){var t=this;Y.find(".dropdown").each(function(){n(this).hasClass("open")&&n(this).find(".dropdown-toggle").get(0)!==n(t).get(0)&&n(t).trigger("click")})}),Q.find("li a").click(function(t){t.preventDefault(),Q.attr("data-content",n(this).attr("data-content")),Re()}),K.on("click","li a",function(t){t.preventDefault(),n(this).attr("data-content")&&Ne(n(this).attr("data-content"),n(this).text())}),q.find("li:not(.dropdown-sub) a").click(function(t){t.preventDefault(),Me(n(this).attr("data-content"),n(this).text())}),ue.on("click","tr",Ge),pe.on("click","tr",$e),ue.on("click",".dropdown-menu li",function(t){t.preventDefault(),We(this)}),ge.on("click","button",function(t){t.preventDefault(),ze(n(this).attr("data-content"),!1,n(this))}),ve.on("click","button",function(t){t.preventDefault(),(M==f.UPCOMING||M==f.RELEASED||M==f.REVIEWED||M==f.POPULAR)&&ze(n(this).attr("data-content"),!1,n(this))}),re.click(function(e){e.preventDefault(),t.search(S)}),oe.click(function(){de.val(""),de.focus(),Ye(!1)}),ue.resize(t.resizePanel),pe.resize(t.resizePanel),n(window).resize(t.resizePanel)},t.renderSearchResults=function(t){k=[],ye.removeClass("show"),i.each(t,function(t){k.push(t)}),k.sort(Ae);var e={sortedSearchResults:k};e.displayType=H,ue.html(be(e))},t.renderListResults=function(t,e){_e.removeClass("show");var n={listResults:t};me.append(we(n)),"none"!==e&&Te(e)},t.search=function(t){""===t?Ye(!1):Ye(!0),D!==p["#searchTab"]&&(ie.trigger("click"),Oe(p["#searchTab"])),t!==T&&(Se(),le.find(".noResults").hide(),ye.addClass("show"),T=t,o.searchAmazon(t,z.amazon,function(e){De(e,t)}),l.searchGiantBomb(t,function(e){Ie(e,t)}))},t.loadNextListPages=function(){switch(_e.addClass("show"),M){case f.POPULAR:t.getIGNPopularList(j,A+1);break;case f.UPCOMING:t.getIGNUpcomingList(j,P+1);break;case f.RELEASED:break;case f.REVIEWED:t.getIGNReviewedList(j,V+1)}},t.getIGNPopularList=function(t,e){function n(t){0===t.length&&(N=!0),I=!1,Ee(t,"none",f.POPULAR),A++}if(N)return _e.removeClass("show"),void 0;for(var i=0;C>i;i++)u.getPopularGames(t.ign,e+i,n)},t.getIGNUpcomingList=function(t,e){function n(t){0===t.length&&(O=!0),I=!1,Ee(t,"asc",f.UPCOMING),P++}if(O)return _e.addClass("show"),void 0;for(var i=0;C>i;i++)u.getUpcomingGames(t.ign,e+i,n)},t.getIGNReviewedList=function(t,e){function n(t){0===t.length&&(R=!0),I=!1,Ee(t,"desc",f.REVIEWED),V++}if(R)return _e.remove("show"),void 0;for(var i=0;C>i;i++)u.getReviewedGames(t.ign,e+i,n)},t.getGTReleasedList=function(t){function e(t,e){Ee(t,"desc",f.RELEASED,e)}for(var n=14,i=s().day(0),a=i,r=0,o=n;o>r;r++)d.getReleasedGames(t.id,a.year(),a.month()+1,a.date(),e),a=a.subtract("weeks",1)},t.resizePanel=function(){var t=null,e=null;switch(D){case p["#searchTab"]:t=ue.height(),e=le,ye.is(":visible")&&(t+=ye.height());break;case p["#listTab"]:t=pe.height(),_e.is(":visible")&&(t+=_e.height()),e=he}var i=n(window).height();if(i-U>t)e.css({height:t+_});else{var s=i-U;e.css({height:s+b})}},t.loggedInView=function(e){U=e?v:y,t.resizePanel()};var Se=function(){ue.empty(),ye.addClass("show"),E={},k=[]},Te=function(t){G=new a("listResults",$),"asc"===t?G.sort("releaseDate",{sortFunction:Je}):G.sort("releaseDate",{sortFunction:qe})},Ee=function(e,n,i,s){s=s!==void 0?s:null,s&&ke(s),i===M&&t.renderListResults(e,n)},ke=function(t){var e={};t!==void 0&&t?i.each(t,function(t,n){e[n]="("+t+") "}):e={all:"",pc:"",x360:"",xbl:"",ps3:"",psn:"",vita:"",ds:"","3ds":"",wii:"",wiiu:""},Z.html(Ce({found:e}))},De=function(e,i){var s={},a={};n("Item",e).each(function(){if(a=o.parseAmazonResultItem(n(this)),a.isFiltered===void 0){var t=a.releaseDate.split("-"),e=parseInt(t[0],10)-100;a.sortDate=e+"-"+t[1]+"-"+t[2],s[a.id]=a}}),n.extend(!0,E,s),S===i&&t.renderSearchResults(E)},Ie=function(e,s){var a=e.results,r={},o={};i.each(a,function(t){o=l.parseGiantBombResultItem(t),o.sortDate=o.releaseDate,"1900-01-01"==o.releaseDate&&(o.sortDate="2100-01-01"),r[o.id]=o}),n.extend(!0,E,r),S===s&&(t.renderSearchResults(E),i.each(a,function(t){i.delay(function(){Pe(t.platforms,t.id)},500)}))},Pe=function(e,n){var s=[],a="";if(e){i.each(e,function(t){a=c.matchPlatformToIndex(t.platform.name).name||t.platform.name,"Mac"!==a&&s.push(a)}),Ve(n,s);var r=t.getSearchResult(n);r&&(r.platformList=s,r.platform=s[0])}},Ve=function(t,e){var i={platformList:e,gbombID:t};n("#"+t).find(".platformDropdown").html(xe(i))},Ae=function(t,e){var n=s(t.sortDate),i=s(e.sortDate);return i>n?1:-1};t.getSearchResult=function(t){return E[t]};var Oe=function(t){switch(t){case 0:le.nanoScroller({scrollTop:B-1}),Fe(!0),Be(!1);break;case 1:he.nanoScroller({scrollTop:parseInt(L-1,10)}),Be(!0),Fe(!1),Re()}},Re=function(){var t=parseInt(Q.attr("data-content"),10);if(t!==M){switch(t){case 0:ze(F),ve.find("button:eq("+F+")").button("toggle"),ve.fadeTo(100,1),J.text("Popular"),M=f.POPULAR;break;case 1:ze(F),ve.find("button:eq("+F+")").button("toggle"),ve.fadeTo(100,1),J.text("Upcoming"),M=f.UPCOMING;break;case 2:ze(F),ve.find("button:eq("+F+")").button("toggle"),ve.fadeTo(100,1),J.text("Released"),M=f.RELEASED;break;case 3:ze(F),ve.find("button:eq("+F+")").button("toggle"),ve.fadeTo(100,1),J.text("Reviewed"),M=f.REVIEWED}je(M)}},Ne=function(t,e){ee.text(e),j=c.getStandardPlatform(t),je(M)},Me=function(e,n){T="",te.text(n),z=c.getStandardPlatform(e),t.search(S)},Le=function(t){switch(t){case 0:ie.tab("show");break;case 1:se.tab("show")}},je=function(e){function n(){ee.text(ee.text().split(" (")[0])}switch(I=!1,R=!1,O=!1,N=!1,P=-1,V=-1,A=-1,ke(),_e.addClass("show"),me.empty(),e){case f.POPULAR:n(),t.getIGNPopularList(j,0);break;case f.UPCOMING:n(),t.getIGNUpcomingList(j,0);break;case f.RELEASED:t.getGTReleasedList(j);break;case f.REVIEWED:t.getIGNReviewedList(j,0)}},Fe=function(t){t?(ge.show(),q.show()):(ge.hide(),q.hide())},Be=function(t){t?(ve.show(),K.show(),Q.show()):(ve.hide(),K.hide(),Q.hide())},ze=function(t,e,n){e=e!==void 0?e:!1,n&&n.addClass("active").siblings().removeClass("active"),D===p["#searchTab"]?(H=t,ue.find("tbody").removeClass().addClass("display-"+t)):pe.find("tbody").hasClass("display-"+t)===!1&&(e||(F=t),he.find(".content").removeClass("display-0").removeClass("display-1").removeClass("display-2").addClass("display-"+t))},He=function(){clearTimeout(x),t.search(S)},Ue=function(e){S=de.val(),S!==T&&Se(),x&&clearTimeout(x),13==e.which?t.search(S):x=setTimeout(He,m)},Ge=function(){var e=t.getSearchResult(n(this).attr("id"));r.viewFirstSearchItemDetail(e)},$e=function(){Qe(),S=h.standardizeTitle(n(this).find(".itemName").text()),Le(p["#searchTab"]),de.val(S),Me(j.id,j.name),t.search(S)},We=function(e){var i=t.getSearchResult(n(e).attr("data-content"));i.platform=n(e).find("a").text(),n(e).parent().siblings(".dropdown-toggle").html(i.platform).append('<b class="caret"></b>')},Ye=function(t){t?ae.addClass("showAddOn"):ae.removeClass("showAddOn")},Qe=function(){D===p["#searchTab"]?B=ce.scrollTop()||1:D===p["#listTab"]&&(L=fe.scrollTop()||1)},Je=function(t,e){var i=n(t.elm).find(".releaseDate"),s=n(e.elm).find(".releaseDate"),a=Date.parse(i.text()),r=Date.parse(s.text());return a-r},qe=function(t,e){var i=n(t.elm).find(".releaseDate"),s=n(e.elm).find(".releaseDate"),a=Date.parse(i.text()),r=Date.parse(s.text());return r-a}}(gamedex.module("searchView"),gamedex,jQuery,_,moment,List),function(t,e,n,i,s){var a=(e.module("user"),e.module("tagView")),r=e.module("utilities"),o=(e.module("searchView"),e.module("itemView")),l=e.module("itemData"),c=e.module("amazon"),u=e.module("itemLinker"),d=e.module("metacritic"),h=e.module("giantbomb"),f=e.module("wikipedia"),p=e.module("gameTrailers"),m=e.module("steam"),g=e.module("videoPanel"),v=["#amazonTab","#giantBombTab"],y={0:"None",1:"Own",2:"Sold",3:"Wanted"},_={0:"Not Started",1:"Playing",2:"Played",3:"Finished"},b={NEW:0,EXISTING:1},w=!1,C=null,x=null,S=v[0],T=null,E=!1,k=b.NEW,D={},I={},P={},V=null,A=null,O=n("#detailTabContent"),R=n("#amazonTab"),N=n("#giantBombTab"),M=n("#amazonTabLink"),L=n("#giantBombTabLink"),j=R.find(".itemDetailThumbnail"),F=N.find(".itemDetailThumbnail"),B=j.find(".itemDetailInfo"),z=F.find(".itemDetailInfo"),H=O.find(".showVideo_btn"),U=O.find(".showDiscussion_btn"),G=n("#detailContainer"),$=(n("#addListContainer"),n("#addList")),W=n("#saveItem_btn"),Y=n("#addItem_btn"),Q=n("#itemAttributes"),J=n("#platform"),q=n("#releaseDate"),X=n("#wikipediaPage"),K=n("#gametrailersPage"),Z=n("#giantBombPage"),te=n("#metacriticPage"),ee=Q.find("#priceHeader"),ne=Q.find("#amazonPriceNew"),ie=Q.find("#amazonPriceUsed"),se=Q.find("#steamPrice"),ae=n("#gameStatus"),re=n("#playStatus"),oe=n("#userRating"),le=n("#ratingCaption");i.template(n("#description-modal-template").html()),t.init=function(){t.createEventHandlers(),W.hide(),Q.hide(),Ie(),oe.stars({split:2,captionEl:le,callback:function(t,e,n){D.userRating=n,je(D)}})},t.createEventHandlers=function(){J.click(function(t){t.preventDefault()}),q.click(function(t){t.preventDefault()}),M.click(function(t){t.preventDefault(),t.stopPropagation(),De(r.SEARCH_PROVIDERS.Amazon)}),L.click(function(t){t.preventDefault(),t.stopPropagation(),De(r.SEARCH_PROVIDERS.GiantBomb)}),H.click(function(t){t.preventDefault(),E&&g.showVideoPanel()}),U.click(function(t){t.preventDefault(),me()}),j.click(function(){}),F.click(function(){}),W.click(function(t){t.preventDefault(),Me(D)}),Y.click(function(t){t.preventDefault(),Me(D)}),ae.find("li a").click(function(t){t.preventDefault(),D.gameStatus=n(this).attr("data-content"),ae.find(".currentSelection").text(y[D.gameStatus]),je(D)}),re.find("li a").click(function(t){t.preventDefault(),D.playStatus=n(this).attr("data-content"),re.find(".currentSelection").text(_[D.playStatus]),je(D)}),n('#detailTab a[data-toggle="tab"]').on("shown",function(t){S=n(t.target).attr("href")}),$.change(Ue)},t.viewFirstSearchItemDetail=function(t){(t.id!==D.id||t.platform!==D.platform)&&(ke(),Ie(),D=n.extend(!0,{},t),C=Ve(D.asin,D.gbombID),D.initialProvider=C,D.standardName=u.standardizeTitle(D.name),P=l.getItemByThirdPartyID(D.gbombID,D.asin),T=D.id,Pe(C),De(C),u.findItemOnAlternateProvider(D,C,!0,function(t){return function(e){ue(e,t)}}(T),function(){}),Oe(D,P),Re(D,P),ce(D,!0),de(D,C,0))},t.viewItemDetail=function(e){ke(),Ie(),Ae(b.EXISTING),D=n.extend(!0,{},e),D.standardName=u.standardizeTitle(D.name),C=parseInt(D.initialProvider,10),P=l.getDirectoryItemByItemID(D.itemID),T=D.id,Pe(C),De(C),u.getLinkedItemData(D,C,t.viewSecondItemDetail),a.selectTagsFromDirectory(P.tags),Re(D,P),ce(D,!1),he(D,C,0,e)},t.viewSecondItemDetail=function(t){I=n.extend(!0,{},t);var e=null;(D.asin==I.asin||D.gbombID==I.gbombID)&&(e=Ve(I.asin,I.gbombID),he(I,e,1))},t.resetDetail=function(){a.resetAddList(),Ae(b.NEW)
},t.getViewingItemID=function(){return D.id};var ce=function(t,e){f.getWikipediaPage(t.standardName,t,be),_e(t.standardName,t,e),p.getGametrailersPage(t.standardName,t,we),m.getSteamGame(t.standardName,t,Ce)},ue=function(t,e){if(I=n.extend(!0,{},t),T===e){var i=Ve(I.asin,I.gbombID);switch(i){case r.SEARCH_PROVIDERS.Amazon:D.asin=I.asin;break;case r.SEARCH_PROVIDERS.GiantBomb:D.gbombID=I.gbombID}de(I,i,1)}},de=function(t,e,n){ve(e,t),ge(t,n),xe(e,D)},he=function(t,e,n){ve(e,t),ge(D,n),xe(e,D)},fe=function(t,e){e.find(".itemDetailTitle h3").text(t.name),pe(e.find("img"),t.largeImage,e)},pe=function(t,e,n){var i=new Image;n.find(".loadingDetailImage").addClass("show"),i.src=e,i.onload=function(){t.attr("src",e),n.find(".loadingDetailImage").removeClass("show")}},me=function(){o.viewDiscussion();var t=D.standardName;DISQUS.reset({reload:!0,config:function(){this.page.identifier=t,this.page.url="http://www.gamedex.net/#!"+t}})},ge=function(t,e){Q.is(":visible")||Q.fadeIn(),("n/a"!==t.platform||0===e)&&J.find(".data").text(t.platform),"1900-01-01"!==t.releaseDate?(0===e||"1900-01-01"===D.releaseDate)&&(D.releaseDate=t.releaseDate,D.calendarDate=s(t.releaseDate,"YYYY-MM-DD").calendar(),q.find(".data").text(D.calendarDate)):"1900-01-01"===D.releaseDate&&q.find(".data").text("unknown")},ve=function(t,e){switch(w||(n("#dataTab").show(),n(".detailTitleBar").show(),w=!0),t){case r.SEARCH_PROVIDERS.Amazon:fe(e,R);break;case r.SEARCH_PROVIDERS.GiantBomb:fe(e,N)}},ye=function(t){t.find(".itemDetailTitle h3").text("No Match found"),t.find("img").attr("src","http://d2sifwlm28j6up.cloudfront.net/no_selection_placeholder.png")},_e=function(t,e,i){function s(t){if(T===t.id||T===t.asin||T===t.gbombID)for(var e=0,n=v.length;n>e;e++)a=v[e]+" .metascore",d.displayMetascoreData(t.metascorePage,t.metascore,a),""!==t.metascorePage&&(te.show(),te.find("a").attr("href","http://www.metacritic.com"+t.metascorePage))}for(var a="",r=0,o=v.length;o>r;r++)a=v[r]+" .metascore",n(a).hide();V=d.getMetascore(t,e,i,s)},be=function(t){t&&(X.show(),X.find("a").attr("href",t))},we=function(t){t&&(K.show(),K.find("a").attr("href",t))},Ce=function(t){""!==t.steamPrice?(ee.show(),se.find(".data").text(t.steamPrice),se.find("a").attr("href",t.steamPage),se.show()):se.hide()},xe=function(t,e){switch(t){case r.SEARCH_PROVIDERS.Amazon:c.getAmazonItemOffers(e.asin,e,Se);break;case r.SEARCH_PROVIDERS.GiantBomb:h.getGiantBombItemData(e.gbombID,Te)}},Se=function(t){(i.has(t,"buyNowPrice")&&""!==t.buyNowPrice||i.has(t,"lowestUsedPrice")&&""!==t.lowestUsedPrice)&&ee.show(),i.has(t,"buyNowPrice")&&""!==t.buyNowPrice?(ne.find("a").attr("href",t.productURL),ne.find(".data").text(t.buyNowPrice),ne.show()):ne.hide(),i.has(t,"lowestUsedPrice")&&""!==t.lowestUsedPrice?(ie.find(".data").text(t.lowestUsedPrice),ie.find("a").attr("href",t.offersURLUsed),ie.show()):ie.hide()},Te=function(t){Z.show(),Z.find("a").attr("href",t.site_detail_url),Ee(t.videos,D.name)},Ee=function(t,e){0!==t.length&&(g.initializeVideoPanel(t,e),E=!0,H.removeClass("noVideos"),H.find("span").text("Show Videos"))},ke=function(){E=!1,H.addClass("noVideos"),H.find("span").text("No Videos")},De=function(t){switch(t){case r.SEARCH_PROVIDERS.Amazon:x=t,B.append(G),M.tab("show");break;case r.SEARCH_PROVIDERS.GiantBomb:x=t,z.append(G),L.tab("show")}},Ie=function(){X.hide(),Z.hide(),K.hide(),te.hide(),ee.hide(),ne.hide(),ie.hide(),se.hide()},Pe=function(t){switch(t){case r.SEARCH_PROVIDERS.Amazon:ye(N);break;case r.SEARCH_PROVIDERS.GiantBomb:ye(R)}},Ve=function(t,e){var n=null;return 0!==t?n=r.SEARCH_PROVIDERS.Amazon:0!==e&&(n=r.SEARCH_PROVIDERS.GiantBomb),n},Ae=function(t){t===b.EXISTING?(k=b.EXISTING,Y.hide(),W.hide()):t===b.NEW&&(k=b.NEW,W.hide(),Y.show())},Oe=function(t,e){e&&e.tagCount>0?(Ae(b.EXISTING),t.itemID=e.itemID,a.selectTagsFromDirectory(e.tags)):(Ae(b.NEW),a.selectUserTags())},Re=function(t,e){e?(t.gameStatus=e.gameStatus,t.playStatus=e.playStatus,t.userRating=e.userRating):(t.gameStatus="0",t.playStatus="0",t.userRating="0"),Ne(t)},Ne=function(t){ae.find(".currentSelection").text(y[t.gameStatus]),re.find(".currentSelection").text(_[t.playStatus]),oe.stars("select",t.userRating),le.text(t.userRating/2),ae.find(".currentSelection").attr("data-initial",t.gameStatus),re.find(".currentSelection").attr("data-initial",t.playStatus),oe.attr("data-initial",t.userRating)},Me=function(t){var e=a.getTagsToAdd(),n=a.getTagsToDelete(),i=n.idsToDelete,s=n.tagsToDelete;e.length>0&&(x!==C&&(x==r.SEARCH_PROVIDERS.Amazon&&0!==t.asin||x==r.SEARCH_PROVIDERS.GiantBomb&&0!==t.gbombID)&&(t.initialProvider=x,t.largeImage=I.largeImage,t.smallImage=I.smallImage,t.thumbnailImage=I.thumbnailImage),A=l.addItemToTags(e,t,Be)),i.length>0&&l.deleteTagsForItem(i,s,t,ze),Le(t),Ge()},Le=function(t){(i.isUndefined(t.metascore)||null===t.metascore)&&n.when(V,A).then(function(){l.updateMetacritic(D),o.refreshView()},function(){}),C===r.SEARCH_PROVIDERS.Amazon&&0===t.gbombID||C===r.SEARCH_PROVIDERS.Amazon&&0===t.asin},je=function(t){He()&&k===b.EXISTING&&l.updateUserItem(t,Fe)},Fe=function(t,e){"success"===e.status&&(Ne(t),o.updateListAttributesChanged(t))},Be=function(t,e){k!==b.EXISTING&&Ae(b.EXISTING),o.updateListAdditions(t,e)},ze=function(t,e){o.updateListDeletions(t,e)},He=function(){var t=ae.find(".currentSelection").attr("data-initial"),e=re.find(".currentSelection").attr("data-initial"),n=oe.attr("data-initial");return t!==D.gameStatus||e!==D.playStatus||n!==D.userRating?!0:!1},Ue=function(t){w&&!t.reset&&(k===b.NEW&&a.updateUserTags(),Ge())},Ge=function(){k===b.EXISTING&&a.isAddListChanged()?W.fadeIn():W.fadeOut()}}(gamedex.module("detailView"),gamedex,jQuery,_,moment),function(t,e,n,i,s){"use strict";var a=e.module("user"),r=e.module("siteView"),o=e.module("tagView"),l=e.module("utilities"),c=e.module("detailView"),u=e.module("importView"),d=e.module("gridView"),h=e.module("itemData"),f=(e.module("itemCache"),e.module("tagData")),p=e.module("amazon"),m=e.module("metacritic"),g=(e.module("itemLinker"),e.module("filterPanel")),v=(e.module("giantbomb"),e.module("steam")),y={List:0,Icons:1},_={collection:"collection",discussion:"discussion"},b={alphabetical:0,metascore:1,releaseDate:2,platform:3,price:4},w=230,C=460,x=10,S=50,T=5,E=10,k="0",D="View All",I=null,P={valueNames:["itemName","metascore","releaseDate","platform","gameStatus","playStatus","userRating"],item:"list-item"},V=k,A=y.Icons,O=0,R=!1,N=!1,M=null,L=C,j=!1,F=_.collection,B=n("#wrapper"),z=n("#itemResults tbody"),H=n("#resizeContainer"),U=n("#viewItemsContainer"),G=n("#itemResultsContainer"),$=U.find(".displayOptions"),W=n("#gridView_btn"),Y=n("#showCollection_btn"),Q=n("#viewList"),J=Q.find(".viewName"),q=n("#itemViewMenu"),X=n("#editMenu"),K=U.find(".sortOptions"),Z=K.find(".sortType"),te=U.find(".filterOptions"),ee=n("#platformFilterSubNav"),ne=te.find(".clearFilters_btn"),ie=te.find(".filterType"),se=n("#applyFilters_btn"),ae=n("#deleteListConfirm-modal"),re=n("#deleteListConfirm_btn"),oe=n("#deleteList_btn"),le=oe.find(".listName"),ce=n("#importMenu"),ue=n("#error-modal"),de=n("#updateList-modal"),he=n("#tagNameField"),fe=n("#updateListConfirm_btn"),pe=n("#editList_btn"),me=G.find(".loadingStatus"),ge=i.template(n("#price-menu-template").html()),ve=i.template(n("#steam-price-menu-template").html()),ye=i.template(n("#item-results-template").html()),_e=function(){be();var t={sliderMinHeight:20,iOSNativeScrolling:!0,preventPageScrolling:!0,flash:!0,flashDelay:1500};G.nanoScroller(t),setInterval(function(){G.nanoScroller()},1500),rn(!1),ee.BootstrapSubMenu({$mainNav:te})},be=function(){q.on("mouseenter",".dropdown-toggle",function(){var t=this;q.find(".dropdown").each(function(){n(this).hasClass("open")&&n(this).find(".dropdown-toggle").get(0)!==n(t).get(0)&&n(t).trigger("click")})}),Q.find("ul").on("click","a",function(t){t.preventDefault(),je(n(this).attr("data-content"))}),se.click(function(t){t.preventDefault(),B.hasClass("gridView")||(rn(!0),an(0))}),ne.click(function(t){t.preventDefault(),rn(!1),ie.text("None"),g.resetFilters(),an()}),U.on("click","#itemResults tr",function(){Qe(n(this).attr("id"))}),z.on("click",".deleteItem_btn",function(t){t.preventDefault();var e=n(this).attr("data-content");Je(e)}),z.on("click",".quickAttributes a",function(t){t.preventDefault(),t.stopPropagation();var e=parseInt(n(this).attr("data-content"),10),i=n(this).parent().parent().attr("data-content");en(n(this),i,e)}),oe.click(function(t){t.preventDefault(),r.hideSiteGuide(),o.getTagCount()>1?ae.modal("show"):(ue.find(".alertTitle").text("Tag Delete Error"),ue.find(".alertText").text("Cannot delete last tag"),ue.modal("show"))}),re.click(function(t){t.preventDefault(),ae.modal("hide"),Xe(V)}),de.find("form").submit(function(t){t.preventDefault(),Ze(V,he.val()),de.modal("hide")}),fe.click(function(t){t.preventDefault(),Ze(V,he.val()),de.modal("hide")}),pe.click(function(t){t.preventDefault(),r.hideSiteGuide();var e=o.getTagName(V);he.val(e),de.modal("show"),i.delay(function(){he.focus().select()},1e3)}),ce.find("li").click(function(t){t.preventDefault(),r.hideSiteGuide(),u.startImport(parseInt(n(this).attr("data-importSource"),10))}),$.find("button").click(function(t){t.preventDefault(),dn(n(this))}),K.find("li a").click(function(t){t.preventDefault(),on(parseInt(n(this).attr("data-content"),10))}),te.find("li:not(.dropdown-sub) a").click(function(t){t.preventDefault(),M=n(this).attr("data-content"),"0"==M?(r.hideSiteGuide(),g.showFilterPanel()):(rn(!0),ie.text(n(this).text()),sn(M))}),W.click(function(t){t.preventDefault(),r.hideSiteGuide(),Le()}),Y.click(function(t){t.preventDefault(),Ne()}),H.resize(Ee),n(window).resize(Ee)},we=function(t){Te();var e=0,s=500,a=25,r=0,o=[];z.addClass("list display-"+A),i.each(t,function(t){ze(t),e++,o.push(t),0===e%a&&(function(t,e,n){i.delay(function(){Ce(e,n),e=[]},s*r)}(e,n.extend(!0,{},o),V),r++,o=[])}),i.delay(function(){Ce(o,V),o=[],xe(t,e)},s*r)},Ce=function(t,e){if(e===V){var n={items:t,length:length};n.currentViewTagID=V,z.append(ye(n))}},xe=function(t,e){e>0&&(z.find(".quickAttributes a").each(function(t,e){var i=n(e);i.opentip(i.attr("data-ot"),{tipJoint:"bottom"})}),i.each(t,function(t){$e(t)}),i.each(t,function(t){Be(t)}),I=new s("itemResultsContainer",P),on(O),an(),R=!1)},Se=function(t){return h.getItem(t)},Te=function(){z.empty()},Ee=function(){var t=n(window).height(),e=H.height(),i=0,s=0;if(me.is(":visible")&&(e+=me.height()),F===_.discussion&&(i=S,s=x),t-L>e-i)G.css({height:e+T+s});else{var a=t-L;G.css({height:a+E+i})}},ke=function(t){L=t?w:C,Ee()},De=function(t,e){return V=k,h.getItems(k,t,e)},Ie=function(t){h.itemsAndDirectoryLoaded(t),je(k),n.isEmptyObject(t)?c.resetDetail():Ye()},Pe=function(t,e){for(var i=null,s=0,a=e.length;a>s;s++)V===k?(i=h.getDirectoryItemByItemID(t).tagCount,0===i&&n("#"+t).remove()):V===e[s]&&n("#"+t).remove()},Ve=function(t){var e=!1;if(o.updateViewList(t.tagIDsAdded,V),V!==k)for(var n=0,i=t.tagIDsAdded.length;i>n;n++)t.tagIDsAdded[n]==V&&(e=!0);else h.getDirectoryItemByItemID(t.itemID).tagCount>=1&&(e=!0);e&&je(V)},Ae=function(){N=!0},Oe=function(t,e,n,i){M=e,je(t),ie.text(n),rn(i)},Re=function(){F=_.discussion,U.removeClass().addClass(F)},Ne=function(){F=_.collection,U.removeClass().addClass(F)},Me=function(){Fe(V)},Le=function(){d.showGridView(V,M,ie.text(),j)},je=function(t){var e="";t!==k?(e=o.getTagName(t),le.text(e),X.show()):(e=D,X.hide()),J.text(e),Fe(t)},Fe=function(t,e){V=t,h.getItems(t,function(t){we(t),e&&e()},function(){we({})})},Be=function(t){Be.getAmazonItemOffersLimited===void 0&&(Be.getAmazonItemOffersLimited=function(t){p.getAmazonItemOffers(t.asin,t,function(e){He(t.id,t,e),h.updateSharedItemPrice(t,l.PRICE_PROVIDERS.Amazon,function(){})})}.lazy(250,2e3)),a.isViewUser()||!i.isUndefined(t.offers)&&0!==i.keys(t.offers).length?He(t.id,t,t.offers):Be.getAmazonItemOffersLimited(t),!a.isViewUser()&&i.isUndefined(t.steamPrice)?v.getSteamGame(t.standardName,t,function(e){Ue(t.id,t,e),h.updateSharedItemPrice(t,l.PRICE_PROVIDERS.Steam,function(){})},function(){h.updateSharedItemPrice(t,l.PRICE_PROVIDERS.Steam,function(){})}):Ue(t.id,t,t),a.isViewUser()||null!==t.metascore&&null!==t.metascorePage&&""!==t.metascorePage||m.getMetascore(t.standardName,t,!1,We)},ze=function(t){var e=h.getDirectoryItemByItemID(t.itemID);e&&(t.gameStatus=e.gameStatus,t.playStatus=e.playStatus,t.userRating=e.userRating)},He=function(t,e,s){if(s.productURL!==void 0){i.isUndefined(s.lowestNewPrice)&&(s.lowestNewPrice=""),i.isUndefined(s.lowestUsedPrice)&&(s.lowestUsedPrice="");var a="#"+t+" .priceDetails",r=Ge(e);"amazon"==r&&(n(a).html(ge(s)),n(a).find(".priceButton").opentip(n(a).find(".priceButton").attr("data-ot"),{tipJoint:"bottom"}))}},Ue=function(t,e,i){if(""!==i.steamPrice){var s="#"+t+" .priceDetails",a=Ge(e);"steam"==a&&(i.steamPageDisplay=i.steamPage.split(".com")[1].split("?")[0],n(s).html(ve(i)),n(s).find(".priceButton").opentip(n(s).find(".priceButton").attr("data-ot"),{tipJoint:"bottom"}))}},Ge=function(t){var e=9999,n=9999,s=9999,a=9999,r="amazon";return i.isUndefined(t.offers)||(i.isUndefined(t.offers.buyNowPrice)||(e=parseFloat(t.offers.buyNowPrice),s=e),i.isUndefined(t.offers.lowestNewPrice)||(n=parseFloat(t.offers.lowestNewPrice))),i.isUndefined(t.steamPrice)||(a=parseFloat(t.steamPrice)),e>n&&(s=n),s>a&&(r="steam"),r},$e=function(t){t.displayMetascore=-1===t.metascore?"n/a":t.metascore,We(t)},We=function(t){var e="#"+t.id+" .metascore";m.displayMetascoreData(t.metascorePage,t.metascore,e)},Ye=function(){var t=h.getRandomItemID();Qe(t)},Qe=function(t){var e=Se(t);c.viewItemDetail(e)},Je=function(t){h.deleteSingleTagForItem(t,V,qe),c.getViewingItemID()===t&&o.removeTagFromAddList(V),n("#"+t).remove()},qe=function(){},Xe=function(t){o.deleteTag(t,function(){Ke()})},Ke=function(){je(k)},Ze=function(t,e){f.updateTag(e,t,function(){}),o.getTags(function(t){o.getTags_result(t)}),tn(e,t)},tn=function(t){J.text(t),he.val(t)},en=function(t,e,n){if(!a.isViewUser()){var i=Se(e);switch(N=!0,n){case 0:"1"===i.playStatus?(nn(t,"0"),t.parent().removeClass().addClass("playStatus-0"),i.playStatus="0"):(nn(t,"1"),t.parent().removeClass().addClass("playStatus-1"),i.playStatus="1");break;case 1:"2"===i.playStatus?(nn(t,"0"),t.parent().removeClass().addClass("playStatus-0"),i.playStatus="0"):(nn(t,"2"),t.parent().removeClass().addClass("playStatus-2"),i.playStatus="2");break;case 2:"3"===i.playStatus?(nn(t,"0"),t.parent().removeClass().addClass("playStatus-0"),i.playStatus="0"):(nn(t,"3"),t.parent().removeClass().addClass("playStatus-3"),i.playStatus="3");break;case 3:"10"===i.userRating?(t.parent().removeClass("rating-10"),i.userRating="0"):(t.parent().removeClass().addClass("rating-10"),i.userRating="10");break;case 4:"1"===i.gameStatus?(t.parent().removeClass().addClass("gameStatus-0"),i.gameStatus="0"):(t.parent().removeClass().addClass("gameStatus-1"),i.gameStatus="1")}h.updateUserItem(i,function(t){c.viewItemDetail(t)})}},nn=function(t,e){t.parent().parent().find('span[class*="playStatus"]').each(function(){n(this).removeClass().addClass("playStatus-"+e)})},sn=function(t){var e=parseInt(t,10);if(g.resetFilters(),isNaN(t))g.platformQuickFilter(t);else switch(e){case 1:on(b.releaseDate),g.upcomingQuickFilter(I);break;case 2:on(b.releaseDate),g.newReleasesQuickFilter(I);break;case 3:on(b.metascore),g.neverPlayedQuickFilter(I);break;case 4:on(b.metascore),g.gamesPlayingQuickFilter(I);break;case 5:on(b.metascore),g.gamesPlayedQuickFilter(I);break;case 6:on(b.metascore),g.finishedGamesQuickFilter(I);break;case 7:on(b.metascore),g.ownedGamesQuickFilter(I);break;case 8:on(b.metascore),g.wantedGamesQuickFilter(I)}an(e)},an=function(t){0===t&&ie.text("Custom"),N?(N=!1,je(V,function(){g.applyListJSFiltering(I)})):g.applyListJSFiltering(I)},rn=function(t){j=t,t?(ne.show(),ne.next().show()):(ne.hide(),ne.next().hide())},on=function(t){switch(O=t){case b.alphabetical:Z.text("Alphabetical"),I.sort("itemName",{asc:!0});break;case b.metascore:Z.text("Review Score"),I.sort("scoreDetails",{sortFunction:ln});break;case b.releaseDate:Z.text("Release Date"),I.sort("releaseDate",{sortFunction:un});break;case b.platform:Z.text("Platform"),I.sort("platform",{asc:!0});break;case b.price:Z.text("Price"),I.sort("priceDetails",{sortFunction:cn})}},ln=function(t,e){var i=n(t.elm).find(".metascore"),s=n(e.elm).find(".metascore"),a=parseInt(i.attr("data-score"),10),r=parseInt(s.attr("data-score"),10);return r>a?1:-1},cn=function(t,e){var i=n(t.elm).find(".priceDetails .lowestNew"),s=n(e.elm).find(".priceDetails .lowestNew"),a=0,r=0;return i.length>0&&(a=parseFloat(i.attr("data-price"))),s.length>0&&(r=parseFloat(s.attr("data-price"))),r>a?-1:1},un=function(t,e){var i=n(t.elm).find(".releaseDate"),s=n(e.elm).find(".releaseDate"),a=Date.parse(i.text()),r=Date.parse(s.text());return r-a},dn=function(t){t.addClass("active").siblings().removeClass("active");var e=t.attr("data-content");A!==e&&(A=e,z.removeClass().addClass("list display-"+A),G.nanoScroller())},hn={init:_e,createEventHandlers:be,getItem:Se,clearItemView:Te,resizePanel:Ee,loggedInView:ke,initializeUserItems:De,initializeUserItems_result:Ie,updateListDeletions:Pe,updateListAdditions:Ve,updateListAttributesChanged:Ae,showListView:Oe,viewDiscussion:Re,viewCollection:Ne,refreshView:Me,showGridView:Le,viewRandomItem:Ye};n.extend(t,hn)}(gamedex.module("itemView"),gamedex,jQuery,_,List),function(t,e,n,i,s){"use strict";var a=e.module("detailView"),r=e.module("itemData"),o=e.module("itemView"),l=(e.module("tagView"),e.module("amazon"),e.module("utilities"),e.module("filterPanel")),c={itemName:0,metacriticScore:1,releaseDate:2,platform:3,rawPrice:4},u=null,d=0,h=null,f=!0,p=null,m=!1,g=n("#panel4"),v=n("#wrapper"),y=n("#gridViewContainer"),_=n("#gridList"),b=(_.find(".viewName"),n("#gridViewMenu")),w=g.find(".loadingStatus"),C=b.find(".grid_displayOptions"),x=C.find(".displayType"),S=b.find(".sortOptions"),T=S.find(".sortType"),E=b.find(".filterOptions"),k=E.find(".clearFilters_btn"),D=E.find(".filterType"),I=E.find(".listFilters_btn"),P=n("#applyFilters_btn"),V=n("#filters-modal"),A=i.template(n("#grid-results-template").html()),O={},R=!1,N=null;t.init=function(){M(),te(!1)};var M=function(){b.on("mouseenter",".dropdown-toggle",function(){var t=this;b.find(".dropdown").each(function(){n(this).hasClass("open")&&n(this).find(".dropdown-toggle").get(0)!==n(t).get(0)&&n(t).trigger("click")})}),n("#exitGridView_btn").click(function(t){t.preventDefault(),j()}),I.click(function(t){t.preventDefault(),V.modal("show")}),k.click(function(t){t.preventDefault(),te(!1),D.text("None"),l.resetFilters(),W()}),P.click(function(t){t.preventDefault(),W(),te(!0)}),_.find("ul").on("click","a",function(t){t.preventDefault(),F(n(this).attr("data-content"))}),y.on("click",".gridItem img",function(t){t.preventDefault(),G(n(this).parent().parent().attr("data-content"))}),y.on("mouseover",".gridItem",function(t){t.preventDefault();var e=n(this),i=e.attr("data-content"),s=O[i];s||(s=e.width(),O[i]=s),Math.round((1.2*s-s)/2),e.css({"z-index":"999",width:1.2*s+"px","-webkit-transition-timing-function":"cubic-bezier(0.01,0.53,0.00,1.00)","-webkit-transition-property":"top,left,width","-webkit-transition-duration":"1s"})}),y.on("mouseout",".gridItem",function(t){t.preventDefault();var e=n(this);e.css({"z-index":"",width:"","-webkit-transition-timing-function":"cubic-bezier(0.01,0.53,0.00,1.00)","-webkit-transition-property":"top,left,width","-webkit-transition-duration":"1s"})}),C.find("li a").click(function(t){t.preventDefault(),x.text(n(this).text()),ee(n(this).attr("data-content"))}),S.find("li a").click(function(t){t.preventDefault(),Y(n(this).attr("data-content"))}),E.find("li a").click(function(t){t.preventDefault(),p=parseInt(n(this).attr("data-content"),10),0===p?l.showFilterPanel():(te(!0),D.text(n(this).text()),$(parseInt(n(this).attr("data-content"),10)))})};t.showGridView=function(t,e,n,i){s.success("Loading Grid View images"),w.addClass("show"),v.removeClass("standardView"),v.addClass("gridView"),p=e,L(t),B(t),D.text(n),te(i)},t.exitGridView=function(){v.removeClass("gridView"),v.addClass("standardView")};var L=function(t){var e=_.find('a[data-content="'+t+'"]');_.find(".viewName").text(e.text())},j=function(){t.exitGridView(),o.showListView(u,p,D.text(),m)},F=function(t){u=t,L(t),B(t)},B=function(t){u=t,y.hide(),R&&y.isotope("destroy"),r.getItems(t,z)},z=function(t){H(t)},H=function(t){var e={items:t};y.html(A(e)),U(),y.imagesLoaded(function(){w.removeClass("show"),y.show(),U(),W()})},U=function(){R=!0,y.isotope({itemSelector:".gridItem",getSortData:{itemName:Q,releaseDate:J,platform:q,userRating:X,metacriticScore:K,rawPrice:Z},sortBy:"itemName",sortAscending:!0,transformsEnabled:!1})},G=function(t){var e=r.getItem(t);a.viewItemDetail(e)},$=function(t){ne();var e=parseInt(t,10);switch(l.resetFilters(),e){case 1:l.upcomingQuickFilter(),T.text("Release Date"),h="releaseDate",f=!0;break;case 2:l.newReleasesQuickFilter(),T.text("Release Date"),h="releaseDate",f=!1;break;case 3:l.neverPlayedQuickFilter(),T.text("Review Score"),h="metacriticScore",f=!1;break;case 4:l.gamesPlayingQuickFilter(),T.text("Review Score"),h="metacriticScore",f=!1;break;case 5:l.gamesPlayedQuickFilter(),T.text("Review Score"),h="metacriticScore",f=!1;break;case 6:l.finishedGamesQuickFilter(),T.text("Review Score"),h="metacriticScore",f=!1;break;case 7:l.ownedGamesQuickFilter(),T.text("Review Score"),h="metacriticScore",f=!1;break;case 8:l.wantedGamesQuickFilter(),T.text("Review Score"),h="metacriticScore",f=!1}W()},W=function(){0===p&&D.text("Custom"),te(l.applyIsotopeFiltering(y,h,f))},Y=function(t){switch(ne(),d=parseInt(t,10)){case c.itemName:T.text("Alphabetical"),h="itemName",y.isotope({sortBy:h,sortAscending:!0});break;case c.metacriticScore:T.text("Review Score"),h="metacriticScore",y.isotope({sortBy:h,sortAscending:!1});break;case c.releaseDate:T.text("Release Date"),h="releaseDate",y.isotope({sortBy:h,sortAscending:!1});break;case c.platform:T.text("Platform"),h="platform",y.isotope({sortBy:h,sortAscending:!0});break;case c.rawPrice:T.text("Price"),h="rawPrice",y.isotope({sortBy:h,sortAscending:!0})}},Q=function(t){return t.find(".itemName").text()},J=function(t){return t.find(".releaseDate").text()},q=function(t){return t.find(".platform").text()},X=function(t){return parseInt(t.find(".userRating").text(),10)},K=function(t){return parseInt(t.find(".metacriticScore").text(),10)},Z=function(t){return parseInt(t.find(".rawPrice").text(),10)},te=function(t){m=t,t?(k.show(),k.next().show()):(k.hide(),k.next().hide())},ee=function(t){ne(),O={},N!==t&&(y.removeClass("display-"+N).addClass("display-"+t),N=t,y.isotope("reLayout",function(){}))},ne=function(){n(".gridItem").each(function(t,e){n(e).css({"z-index":"","-webkit-transition-property":""})})}}(gamedex.module("gridView"),gamedex,jQuery,_,alertify),function(t,e,n,i){"use strict";var s=(e.module("user"),e.module("tagData")),a=e.module("itemData"),r=e.module("itemCache"),o=n("#addListContainer"),l=n("#addList"),c=n("#viewList"),u=n("#gridList"),d={},h={},f={},p={},m={},g={},v=[],y=i.template(n("#view-list-template").html()),_=function(){b()},b=function(){l.change(function(){var t=l.val().split(","),e=t[t.length-1];""!==e&&I(e)})},w=function(t,e){return F(),s.getTags(t,e)},C=function(t){U(),G(t),x(),j()},x=function(){var t=[],e=[];i.each(h,function(e){t.push(e)}),i.each(f,function(t){e.push(t)}),t.sort($);var n={orderedList:t,emptyList:e};c.find("ul").html(y(n)),u.find("ul").html(y(n))},S=function(t){return p[t]},T=function(){var t=0;return i.each(d,function(){t++}),t},E=function(){var t=[],e=z();return i.each(e,function(e){i.has(g,e)||(g[e]="placeholder",t.push(e))}),t},k=function(){var t=[],e=[],n=z();return i.each(g,function(s,a){-1===i.indexOf(n,a)&&(delete g[a],e.push(a),t.push(s))}),{idsToDelete:t,tagsToDelete:e}},D=function(t,e){for(var n=0,i=e.length;i>n;n++)g[t[n]]=e[n]},I=function(t,e){if(i.has(d,t)){if(e){var n={tagID:d[t].id,tagName:d[t].name};e(n)}}else s.addTag(t,function(t){B(t),e&&e(t)})},P=function(t,e){var n=r.getCachedItemsByTag(t);i.each(n,function(e){a.deleteClientItem(t,e.itemID),a.deleteTagFromDirectory(e.itemID,t)}),V(t),r.deleteCachedTag(t),s.deleteTag(t),w(function(t){C(t)}),e()},V=function(t){delete g[t],H(g)},A=function(t){g={},i.each(t,function(t,e){g[e]=t}),H(t)},O=function(){v=l.val().split(",")},R=function(){g={},l.val(v).trigger({type:"change",reset:!1})},N=function(t){for(var e=!1,n=0,i=t.length;i>n;n++)m[t[n]]===void 0&&(m[t[n]]=!0,delete f[p[t[n]]],h[p[t[n]]]={id:t[n],name:p[t[n]]},e=!0);return e&&x(),e},M=function(){g={},v=[],l.val([""]).trigger({type:"change",reset:!0})},L=function(){var t=!1,e=z();return i.each(e,function(e){i.has(g,e)||(t=!0)}),i.each(g,function(n,s){-1===i.indexOf(e,s)&&(t=!0)}),t},j=function(){var t=[],e=[];i.each(d,function(n){t.push(n),e.push(n.name)}),t.sort($),l.select2({tags:e,placeholder:"Type a tag name",allowClear:!0})},F=function(){d={},h={},f={},p={},m={},g={},v=[]},B=function(t){var e={name:t.tagName.toLowerCase(),id:t.tagID};d[e.name]=e,f[e.name]=e,p[e.id]=e.name,x(),j(),o.find(".select2-search-field input").focus()},z=function(){var t=l.val(),e=[];return""!==t&&i.each(t.split(","),function(t){i.has(d,t)?e.push(d[t].id):e.push(t)}),e},H=function(t){var e=[];i.each(t,function(t,n){var i=S(n);e.push(i)}),l.val(e).trigger({type:"change",reset:!1})},U=function(){var t=a.getItemDirectory();m={},i.each(t,function(t){i.each(t.tags,function(t,e){m[e]===void 0&&(m[e]=!0)})})},G=function(t){for(var e={},n=0,i=t.length;i>n;n++)e={},e.name=t[n].tagName.toLowerCase(),e.id=t[n].tagID,m[e.id]!==void 0?h[e.name]=e:f[e.name]=e,d[e.name]=e,p[e.id]=e.name},$=function(t,e){var n=t.name,i=e.name;return n.toLowerCase().localeCompare(i.toLowerCase())},W={init:_,getTags:w,getTags_result:C,renderViewLists:x,getTagName:S,getTagCount:T,getTagsToAdd:E,getTagsToDelete:k,updateInitialItemTags:D,addTag:I,deleteTag:P,removeTagFromAddList:V,selectTagsFromDirectory:A,updateUserTags:O,selectUserTags:R,updateViewList:N,resetAddList:M,isAddListChanged:L};n.extend(t,W)}(gamedex.module("tagView"),gamedex,jQuery,_),function(t,e,n,i,s){"use strict";var a=e.module("utilities"),r=n("#filters-modal"),o=n("#releaseDate_filter"),l=n("#gameStatus_filter"),c=n("#playStatus_filter"),u=n("#metascore_filter"),d=n("#platformFilterList");t.init=function(){t.createEventHandlers(),d.select2({placeholder:"Select platform",allowClear:!0})},t.createEventHandlers=function(){r.on("click",".btn-group button",function(t){t.preventDefault()})},t.showFilterPanel=function(){r.modal("show")},t.getFilters=function(){var t={};t.releaseDateFilters=[],t.metascoreFilters=[],t.platformFilters=[],t.gameStatusFilters=[],t.playStatusFilters=[],o.find("button").each(function(){n(this).hasClass("active")?t.releaseDateFilters.push(!0):t.releaseDateFilters.push(!1)}),u.find("button").each(function(){n(this).hasClass("active")?t.metascoreFilters.push(!0):t.metascoreFilters.push(!1)}),l.find("button").each(function(){n(this).hasClass("active")?t.gameStatusFilters.push(!0):t.gameStatusFilters.push(!1)}),c.find("button").each(function(){n(this).hasClass("active")?t.playStatusFilters.push(!0):t.playStatusFilters.push(!1)});var e=d.val(),s=[];return e&&""!==e&&(s=e.split(",")),i.each(s,function(e,n){t.platformFilters[n]=a.getStandardPlatform(e)}),t},t.applyListJSFiltering=function(e){var n=t.getFilters(),i=!1;return e.filter(function(e){var s=t.releaseDateFilter(e.values().releaseDate,n.releaseDateFilters),a=t.metascoreFilter(e.values().metascore,n.metascoreFilters),r=t.platformFilter(e.values().platform,n.platformFilters),o=t.gameStatusFilter(e.values().gameStatus,n.gameStatusFilters),l=t.playStatusFilter(e.values().playStatus,n.playStatusFilters);return s&&a&&r&&l&&o?!0:(i=!0,!1)}),i},t.applyIsotopeFiltering=function(e,i,s){var a=t.getFilters(),r=!1,o=n(".gridItem").filter(function(){var e=n(this),i=e.find(".releaseDate").text(),s=t.releaseDateFilter(i,a.releaseDateFilters),o=e.find(".metacriticScore").text(),l=t.metascoreFilter(o,a.metascoreFilters),c=e.find(".platform .data").text(),u=t.platformFilter(c,a.platformFilters),d=e.find(".gameStatus").text(),h=t.gameStatusFilter(d,a.gameStatusFilters),f=e.find(".playStatus").text(),p=t.playStatusFilter(f,a.playStatusFilters);return s&&h&&p&&l&&u?!0:(r=!0,!1)});return e.isotope({filter:o,sortBy:i,sortAscending:s}),r},t.resetFilters=function(){o.find("button").each(function(){n(this).removeClass("active")}),u.find("button").each(function(){n(this).removeClass("active")}),l.find("button").each(function(){n(this).removeClass("active")}),c.find("button").each(function(){n(this).removeClass("active")}),d.val([""]).trigger("change")},t.upcomingQuickFilter=function(){o.find('button[data-content="0"]').addClass("active")},t.newReleasesQuickFilter=function(){o.find('button[data-content="1"]').addClass("active")},t.neverPlayedQuickFilter=function(){c.find('button[data-content="0"]').addClass("active")},t.gamesPlayingQuickFilter=function(){c.find('button[data-content="1"]').addClass("active")},t.gamesPlayedQuickFilter=function(){c.find('button[data-content="2"]').addClass("active")},t.finishedGamesQuickFilter=function(){c.find('button[data-content="3"]').addClass("active")},t.ownedGamesQuickFilter=function(){l.find('button[data-content="1"]').addClass("active")},t.wantedGamesQuickFilter=function(){l.find('button[data-content="3"]').addClass("active")},t.platformQuickFilter=function(t){d.val(t).trigger("change")},t.releaseDateFilter=function(t,e){var n=e[0],i=e[1],a=null;a="1900-01-01"===t?s().add("days",1):s(t,"YYYY-MM-DD");var r=s(),o=a.diff(r,"seconds");return n&&i?!0:n||i?n&&o>0?!0:i&&0>o?!0:!1:!0},t.gameStatusFilter=function(t,e){var n=e[0],i=e[1],s=e[2],a=e[3];return n&&i&&s&&a?!0:n||i||s||a?n&&"0"===t?!0:i&&"1"===t?!0:s&&"2"===t?!0:a&&"3"===t?!0:!1:!0},t.playStatusFilter=function(t,e){var n=e[0],i=e[1],s=e[2],a=e[3];return n&&i&&s&&a?!0:n||i||s||a?n&&"0"===t?!0:i&&"1"===t?!0:s&&"2"===t?!0:a&&"3"===t?!0:!1:!0},t.metascoreFilter=function(t,e){var n=e[0],i=e[1],s=e[2],a=e[3],r=e[4],o=e[5],l=e[6],c=parseInt(t,10);return n&&i&&s&&a&&r&&o&&l?!0:n||i||s||a||r||o||l?n&&c>=90?!0:i&&c>=80&&90>c?!0:s&&c>=70&&80>c?!0:a&&c>=60&&70>c?!0:r&&c>=50&&60>c?!0:o&&c>=25&&50>c?!0:l&&c>=0&&25>c?!0:!1:!0},t.platformFilter=function(t,e){if(0===e.length)return!0;for(var n=0,i=e.length;i>n;n++)if(e[n].name===t)return!0;return!1}}(gamedex.module("filterPanel"),gamedex,$,_,moment),function(t,e,n,i,s,a,r){"use strict";var o=n.module("giantbomb"),l="videoPlayer",c=89,u=5,d=!1,h=0,f=null,p=0,m=0,g=0,v=0,y=!0,_=null,b={valueNames:["publishDate"]},w=[],C=[],x=null,S=null,T=null,E=null,k=null,D=i("#video-modal"),I=(i("#videoListContainer"),i("#videoList")),P=(i("#videoPlayer"),i("#videoModalTitle")),V=i("#videoListNavigation"),A=V.find(".navigateLeft"),O=V.find(".navigateRight"),R=V.find(".pageNumber"),N=s.template(i("#video-results-template").html());t.init=function(){k=e(l),t.createEventHandlers(),E=s.debounce(F,1e3),D.modal({backdrop:!0,show:!1})},t.createEventHandlers=function(){I.on("click","li",function(t){t.preventDefault();var e=i(this).attr("data-id");H(Number(e)),G()}),A.click(function(){Q()}),O.click(function(){J()}),D.on("hidden",function(){$()}),k.addEvent("ended",z)},t.showVideoPanel=function(){i.when(x).then(function(){if(d){d=!1;var t=j(w[p-1]);t&&H(p-1),M()}G()},function(){}),D.modal("show")},t.initializeVideoPanel=function(t,e){d=!0,f=1,g=-1,h=0,m=0,y=!0,p=t.length,S=null,T=null,P.text(e),w=i.extend(!0,[],t),I.empty(),X(0),W(),s.each(w,function(t,e){t.index=e}),x=L(w[p-1],function(){})};var M=function(){s.each(w,function(t){L(t,function(t,e){-1===g&&e&&(H(t.index),G())})})},L=function(t,e){var n=o.getGiantBombVideo(t.id,function(n){i.extend(!0,t,n);var s=j(t);e(t,s)});return n},j=function(t){if(!s.has(t,"attached")&&s.has(t,"image")){m++,B(t);var e={video:t};I.append(N(e)),t.attached=!0;var n=I.find("#video_"+t.id);s.delay(function(){n.addClass("showFade"),E()},200),n.opentip(n.attr("data-ot"),n.attr("data-ot-title"),{tipJoint:"bottom",group:"video"}),X(h),m>u&&Y()
}return s.has(t,"image")?!0:!1},F=function(){C=[],_=new r("videoListContainer",b),_.sort("publishDate",{asc:!1}),s.each(_.items,function(t){C.push(parseInt(i(t.elm).attr("data-id"),10))}),y&&U()},B=function(t){t.calendarDate=a(t.publish_date,"YYYY-MM-DD").calendar();var e=Math.floor(t.length_seconds/60),n=""+t.length_seconds%60;1===n.length&&(n="0"+n),delete t.length_seconds,t.runningTime=e+":"+n},z=function(){var t=s.indexOf(C,g);g=t+1===C.length?C[0]:C[t+1],H(g),G()},H=function(t){g=t;var e=w[t].url;S=I.find('li[data-id="'+t+'"]'),T=I.find('li[data-id="'+v+'"]'),T.removeClass("playing"),S.addClass("playing"),e.split(".");var n=w[t].high_url;k.src(n),v=t,U()},U=function(){var t=s.indexOf(C,g);if(-1!==t){var e=Math.floor(t/u);X(e)}},G=function(){k.play()},$=function(){k.pause()},W=function(){V.removeClass("show")},Y=function(){V.addClass("show")},Q=function(){y=!1;var t=q();h>0?X(--h):X(t)},J=function(){y=!1;var t=q();t>h?X(++h):X(0)},q=function(){return f=Math.ceil(m/u)-1},X=function(t){var e=-(t*c);h=t,I.stop().animate({top:e},250,function(){}),R.text(Number(t+1)+" / "+Number(q()+1))}}(gamedex.module("videoPanel"),_V_,gamedex,jQuery,_,moment,List),function(t,e,n,i,s){"use strict";var a=(e.module("user"),e.module("utilities")),r=e.module("itemData"),o=e.module("tagView"),l=e.module("itemView"),c=(e.module("amazon"),e.module("metacritic")),u=e.module("itemLinker"),d=e.module("giantbomb"),h=["Steam","PSN","XBL"],f=["Steam ID","PSN ID","Gamertag"],p=["http://steamcommunity.com/id/[steam_id]/games/","http://us.playstation.com/mytrophies/","http://www.xboxgamertag.com/search/[gamer_tag]"],m=[["PC","Mac"],["PSN","PS3","Vita"],["Xbox","X360","XBL"]],g="http://d2sifwlm28j6up.cloudfront.net/no_match.png",v="Loading Data: ",y="Importing: ",_=0,b=0,w=0,C=0,x=0,S=0,T=null,E={},k=0,D=[],I=[],P=[],V=n("#importContainer"),A=(n("#importResults"),n("#importResults tbody")),O=n("#startImport_btn"),R=n("#confirmImport_btn"),N=n("#cancelImport_btn"),M=n("#sourceUser"),L=n(".importSourceID"),j=n(".importSourceName"),F=n(".importSourceURL"),B=n("#importConfig-modal"),z=n("#import-modal"),H=n("#importProgressContainer"),U=n("#importProgress"),G=U.find(".bar"),$=n("#importStatus"),W=$.find(".statusTitle"),Y=$.find(".statusText"),Q=null,J=i.template(n("#import-results-template").html()),q=function(){var t={sliderMinHeight:20,iOSNativeScrolling:!0,preventPageScrolling:!0,flash:!0,flashDelay:1500,alwaysVisible:!0};V.nanoScroller(t),X()},X=function(){O.click(function(t){t.preventDefault(),""!==M.val()&&te(M.val())}),M.keyup(function(t){t.preventDefault(),13===t.which&&""!==M.val()&&te(M.val())}),R.click(function(t){t.preventDefault(),_e()}),N.click(function(t){t.preventDefault(),ee()})},K=function(t){T=t,i.has(E,t)?(B.modal("hide"),z.modal("show")):Z(),i.delay(function(){V.nanoScroller()},1e3)},Z=function(){L.text(f[T]),j.text(h[T]);var t=p[T],e='<a href="'+t+'" target="_blank">'+t+"</a>";F.html(e),B.modal("show"),i.delay(function(){M.focus().select()},800)},te=function(t){E[T]=!0,I=[],_=0,b=0,w=0,C=0,Q=re.lazy(500,1e4),k++,A.empty(),me(v),B.modal("hide"),z.modal("show"),r.importGames(T,t,function(t){ne(t,m[T])}),s.success("Importing "+h[T]+" games for: "+t)},ee=function(){delete E[T],k++,i.each(P,function(t){t&&i.has(t,"abort")&&t.abort()}),Z(),z.modal("hide"),s.error(h[T]+" import cancelled")},ne=function(t,e){D=t,w=D.length,P=[],i.each(D,function(t){t=u.standardizeTitle(t);var n=ie(t,e);P.push(n)})},ie=function(t,e){var n={initialProvider:1,standardName:t},i=u.findItemOnAlternateProvider(n,a.SEARCH_PROVIDERS.Amazon,!1,function(i){se(t,i,n,e)},function(){le(t)});return i},se=function(t,e,s,r){n.extend(!0,s,e);var o=d.getGiantBombItemPlatform(s.id,function(e){for(var n=[],o=0,l=e.results.platforms.length;l>o;o++){var c=a.matchPlatformToIndex(e.results.platforms[o].name).name;n.push(c)}var u=i.intersection(n,r);s.platform=u[0],s.platform?(_+=2,Q(s,ue,k),ae(s),oe(s)):le(t)});P.push(o)},ae=function(t){var e=c.getMetascore(t.standardName,t,!0,de);P.push(e)},re=function(t,e,n){if(k===n){var i=u.findItemOnAlternateProvider(t,a.SEARCH_PROVIDERS.GiantBomb,!1,function(n){t.asin=n.asin,e()},function(t){t||e()});P.push(i)}},oe=function(t){t.importClass="imported",0===C&&ge(),C++,I.push(t),ce(t),fe()},le=function(t){var e={thumbnailImage:g,name:t,calendarDate:"",platform:"Title not found: please add manually",importClass:"importFailed"};ce(e)},ce=function(t){var e={item:t};A.append(J(e)),V.nanoScroller()},ue=function(){he()},de=function(){he()},he=function(){b++,fe(),_==b&&ye()},fe=function(){var t=w+_,e=C+b,n=Math.round(100*(e/t));G.css({width:n+"%"}),Y.text(e+" of "+t)},pe=function(){var t=Math.round(100*(S/x));G.css({width:t+"%"}),Y.text(S+" of "+x)},me=function(t){z.removeClass("ready").addClass("loading"),H.removeClass("show"),G.css({width:"0%"}),W.text(t)},ge=function(){H.addClass("show"),z.removeClass("ready").removeClass("loading")},ve=function(){H.removeClass("show"),i.delay(function(){G.css({width:"0%"})},1e3)},ye=function(){ve(),i.delay(function(){z.addClass("ready")},1e3),s.success(w+" titles found and linked for "+h[T])},_e=function(){W.text(y),ge();var t=h[T].toLowerCase()+" import";x=I.length,S=0,o.addTag(t,function(e){var n=[e.tagID];i.each(I,function(e){r.addItemToTags(n,e,function(){S++,pe(),S===x&&be(n,t)})})})},be=function(t,e){s.success(h[T]+" Import Complete"),s.log("Games added to tag: "+e),z.modal("hide"),l.refreshView(),o.updateViewList(t),l.viewRandomItem(),delete E[T],T=null},we={init:q,startImport:K};n.extend(t,we)}(gamedex.module("importView"),gamedex,jQuery,_,alertify),gamedex.initialize();