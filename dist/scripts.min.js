/*! GAMEDEX - v1.0.0 - 2013-02-18
* http://www.gamedex.net/
* 2013 - Michael Martin */
(function(e){function a(r,i){this.element=r,this.options=e.extend({},n,i),this._defaults=n,this._name=t,this.init()}var t="BootstrapSubMenu",n={propertyName:"value"},r=null,i=null,s=null,o=null,u=!1;a.prototype.init=function(){this.createEventHandlers(e(this.element),this.options.$mainNav)},a.prototype.createEventHandlers=function(t,n){n.click(function(e){u=!1}),n.find("li:not(.dropdown-sub li)").hover(function(e){clearTimeout(s),s=null,o||(o=setTimeout(function(){t.removeClass("active")},500))}),t.hover(function(e){clearTimeout(o),o=null,s||(s=setTimeout(function(){u||t.addClass("active")},300))}),t.click(function(e){e.preventDefault(),e.stopPropagation()}),t.find("li").hover(function(e){clearTimeout(o),o=null}),t.find("li").click(function(e){u=!0,t.removeClass("active"),n.removeClass("open")}),n.find(".dropdown-toggle").click(function(e){t.removeClass("active")}),e(document).click(function(e){t.removeClass("active")})},e.fn[t]=function(n){return this.each(function(){e.data(this,"plugin_"+t)||e.data(this,"plugin_"+t,new a(this,n))})}})(jQuery);var gamedex={module:function(){var e={};return function(t){return e[t]?e[t]:e[t]={}}}()};gamedex.api="/",gamedex.initialize=function(){gamedex.initializeLibraries(),gamedex.initializeModules()},gamedex.initializeLibraries=function(){moment.calendar={lastDay:"LL",sameDay:"LL",nextDay:"LL",lastWeek:"LL",nextWeek:"LL",sameElse:"LL"},moment.longDateFormat={L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D YYYY h:mm A",LLLL:"dddd, MMMM D YYYY h:mm A"}},gamedex.initializeModules=function(){var e=gamedex.module("itemData"),t=gamedex.module("searchView"),n=gamedex.module("detailView"),r=gamedex.module("itemView"),i=gamedex.module("tagView"),s=gamedex.module("gridView"),o=gamedex.module("filterPanel"),u=gamedex.module("videoPanel"),a=gamedex.module("importView"),f=gamedex.module("siteView");e.init(),t.init(),n.init(),r.init(),i.init(),s.init(),o.init(),u.init(),a.init(),f.init()},function(e,t,n,r){"use strict";var i=t.module("user"),s=[{id:"all",gt:"",ign:"",amazon:468642,name:"All Platforms",alias:"all"},{id:"pc",gt:"pc",ign:"pc",amazon:229575,name:"PC",alias:"pc,windows"},{id:"mac",gt:"",ign:"mac",amazon:229647,name:"Mac",alias:"mac,macwindows,osx,os x,apple,macintosh"},{id:"xbox",gt:"",ign:"xbox",amazon:537504,name:"Xbox",alias:"xbox,microsoft xbox"},{id:"x360",gt:"xbox 360",ign:"xbox-360",amazon:14220161,name:"X360",alias:"x360,xbox 360,microsoft xbox360,360"},{id:"xbl",gt:"xbla",ign:"xbox-360",amazon:14220161,name:"XBL",alias:"xbl,xbox live"},{id:"ds",gt:"ds",ign:"ds",amazon:11075831,name:"DS",alias:"ds,nintendo ds"},{id:"3ds",gt:"3ds",ign:"ds",amazon:2622269011,name:"3DS",alias:"3ds,nintendo 3ds"},{id:"wii",gt:"wii",ign:"wii",amazon:14218901,name:"Wii",alias:"wii,nintendo wii"},{id:"wiiu",gt:"wii u",ign:"wii-u",amazon:3075112011,name:"Wii U",alias:"wiiu,wii u,wii-u,nintendo wii u,nintendo wiiu"},{id:"ps",gt:"",ign:"ps",amazon:229773,name:"PS1",alias:"ps,ps1,playstation,playstation1,playstation 1,sony playstation 1,sony playstation"},{id:"ps2",gt:"",ign:"ps2",amazon:301712,name:"PS2",alias:"ps2,playstation 2,playstation2,sony playstation 2"},{id:"ps3",gt:"ps3",ign:"ps3",amazon:14210751,name:"PS3",alias:"ps3,playstation 3,playstation3,sony playstation 3"},{id:"psn",gt:"",ign:"ps3",amazon:14210751,name:"PSN",alias:"psn,playstation network"},{id:"vita",gt:"vita",ign:"vita",amazon:3010556011,name:"Vita",alias:"vita,psvita,ps vita,playstation vita,sony vita,sony playstation vita"},{id:"psp",gt:"",ign:"psp",amazon:11075221,name:"PSP",alias:"psp,sony psp"},{id:"gc",gt:"",ign:"gcn",amazon:541022,name:"Gamecube",alias:"gamecube,gc,nintendo gamecube"},{id:"n64",gt:"",ign:"n64",amazon:229763,name:"N64",alias:"n64,nintendo 64,nintendo64"},{id:"nes",gt:"",ign:"",amazon:566458,name:"NES",alias:"nes,nintendo nes"},{id:"snes",gt:"",ign:"",amazon:294945,name:"SNES",alias:"snes,super nintendo,nintendo snes"},{id:"gba",gt:"",ign:"gba",amazon:1272528011,name:"Game Boy",alias:"gb,gameboy"},{id:"gb",gt:"",ign:"gb",amazon:541020,name:"GBA",alias:"gba,gameboy advance,game boy,advance,gbadvance"},{id:"gbc",gt:"",ign:"",amazon:229783,name:"GBC",alias:"gbc,gbcolor,gameboy color"},{id:"dc",gt:"",ign:"dc",amazon:229793,name:"Dreamcast",alias:"dc,dreamcast,sega dreamcast,sega dream cast,dream cast"},{id:"saturn",gt:"",ign:"",amazon:294944,name:"Saturn",alias:"saturn,sega saturn"},{id:"genesis",gt:"",ign:"",amazon:294943,name:"Genesis",alias:"genesis,sega genesis"},{id:"gamegear",gt:"",ign:"",amazon:294942,name:"Gamegear",alias:"gamegear,game gear,sega gamegear"},{id:"segacd",gt:"",ign:"",amazon:11000181,name:"Sega CD",alias:"cd,sega cd"}],o={Amazon:0,GiantBomb:1},u={Amazon:0,Steam:1},a="0",f={URL:"http://ecx.images-amazon.com/images",RE:/http:\/\/ecx\.images-amazon\.com\/images/gi,TOKEN:"~1~"},l={URL:"http://media.giantbomb.com/uploads",RE:/http:\/\/media\.giantbomb\.com\/uploads/gi,TOKEN:"~1~"},c=function(e){var t=new RegExp(e,"gi");for(var n=0,r=s.length;n<r;n++)if(t.test(s[n].alias))return s[n];return s[0]},h=function(e){var t=null,n=[],r=null,i=e.length,o=0,u=null;for(var a=0,f=s.length;a<f;a++){n=s[a].alias.split(",");for(var l=0,c=n.length;l<c;l++){t=new RegExp(n[l],"gi"),u=t.exec(e);if(u&&u[0].length===i)return s[a];u&&u[0].length>o&&(o=u[0].length,r=s[a])}}return r?r:s[0]},p={PLATFORM_INDEX:s,SEARCH_PROVIDERS:o,PRICE_PROVIDERS:u,VIEW_ALL_TAG_ID:a,AMAZON_IMAGE:f,GIANTBOMB_IMAGE:l,getStandardPlatform:c,matchPlatformToIndex:h};n.extend(e,p)}(gamedex.module("utilities"),gamedex,jQuery,_),function(e,t,n,r,i){"use strict";var s=t.module("utilities"),o=t.module("storage"),u=t.module("itemView"),a=t.module("itemCache"),f=t.api+"user/login/",l=t.api+"user/logout/",c=t.api+"user/",h=t.api+"user/create/",p=t.api+"user/delete/",d=t.api+"user/update/",v=t.api+"user/resetcode/send/",m=t.api+"user/resetcode/submit/",g=t.api+"user/password/update/",y={user_id:"",secret_key:"",viewUser:null},b={user_id:"ag1zfnQtbWludXN6ZXJvcgwLEgVVc2Vycxj6VQw",secret_key:"1"};document.location.hostname==="localhost"&&(b={user_id:"ag9kZXZ-dC1taW51c3plcm9yCwsSBVVzZXJzGBIM",secret_key:"1"}),e.getUserData=function(e){return y},e.getUserCredentials=function(e){return e=typeof e!="undefined"?e:!1,y.timestamp=(new Date).getTime(),e&&o.set("timestamp",y.timestamp),y.viewUser?{user_name:y.viewUser}:e?{uid:y.user_id,uk:y.secret_key,ts:y.timestamp}:{uid:y.user_id,uk:y.secret_key}},e.getUserID=function(){return y.user_id},e.login=function(t,n,r,s){i.success("Logging in... "+t),e.verifyUser(t,n,function(e,t){E(e,t),r(e,t)},s)},e.verifyUser=function(e,t,r,i){var s={user_email:e,user_password:t};n.ajax({url:f,type:"POST",data:s,dataType:"json",cache:!0,success:function(t){r(t,e)},error:i})},e.deleteAccount=function(e,t,r,i){var s={uid:e,user_password:t};n.ajax({url:p,type:"POST",data:s,dataType:"json",cache:!0,success:function(e){r(e)},error:i})},e.demoLogin=function(){y.user_id=b.user_id,y.secret_key=b.secret_key},e.validateUser=function(e,t){var r={user_name:e};n.ajax({url:c,type:"POST",data:r,dataType:"json",cache:!0,success:function(e){S(e),t(e)},error:function(e){}})},e.logout=function(){i.success("Logged out");var e={uid:y.user_id,uk:y.secret_key};n.ajax({url:l,type:"POST",data:e,dataType:"json",cache:!0,success:function(e){},error:function(e){}}),y.user_id=null,y.secret_key=null,y.userName=null,y.email=null,y.viewUser=null},e.createUser=function(e,t,r,s){i.success("Creating account : "+e);var o={user_email:e,user_password:t};n.ajax({url:h,type:"POST",data:o,dataType:"json",cache:!0,success:function(t){E(t,e),r(t,e)},error:s})},e.updateUser=function(e,t,r,i,s){if(e!==""){var o={uid:y.user_id,user_password:e};r!==""&&r!==y.userName&&(o.user_name=r),r!==""&&t!==y.email&&(o.user_email=t),i!==""&&(o.user_new_password=i),o.user_password=e,n.ajax({url:d,type:"POST",data:o,dataType:"json",cache:!0,success:function(e){e.status==="success"&&w(o),s(e)},error:function(e){}})}},e.sendResetPasswordCode=function(e,t){var r={user_email:e};n.ajax({url:v,type:"POST",data:r,dataType:"json",cache:!0,success:function(e){t(e)},error:function(e){}})},e.submitResetPasswordCode=function(e,t,r){var i={user_email:e,user_reset_code:t};n.ajax({url:m,type:"POST",data:i,dataType:"json",cache:!0,success:function(e){r(e)},error:function(e){}})},e.updatePassword=function(e,t,r,i){var s={user_email:e,user_reset_code:t,user_new_password:r};n.ajax({url:g,type:"POST",data:s,dataType:"json",cache:!0,success:function(e){i(e)},error:function(e){}})},e.isViewUser=function(){return y.viewUser?!0:!1};var w=function(e){typeof e.user_name!="undefined"&&(y.userName=e.user_name),typeof e.user_email!="undefined"&&(y.email=e.user_email)},E=function(e,t){if(e.userID){y.user_id=e.userID,y.secret_key=e.secretKey,y.userName=e.userName,y.email=t,y.viewUser=null,i.success("Welcome "+e.userName);var n=window.location.pathname;history&&n!=="/"&&history.pushState(null,null,"/");var r=o.get("timestamp");r?e.timestamp!=r&&(a.clearStoredData(),o.set("timestamp",e.timestamp)):o.set("timestamp",e.timestamp)}},S=function(e){e.status==="success"&&(y.viewUser=e.userName,y.user_id=e.userName,y.secret_key=0)}}(gamedex.module("user"),gamedex,jQuery,_,alertify),function(e,t,n,r){"use strict";var i=t.module("user");e.get=function(e){var t=i.getUserID(),n=localStorage.getItem(t+"_"+e),r=null;return n!=="undefined"&&n&&(r=JSON.parse(n)),r},e.set=function(e,t){if(!i.isViewUser()){var n=i.getUserID();localStorage.setItem(n+"_"+e,JSON.stringify(t)),t||(t={})}return t},e.remove=function(e){var t=i.getUserID();localStorage.removeItem(t+"_"+e)},e.setGlobal=function(e,t){return localStorage.setItem(e,JSON.stringify(t)),t||(t={}),t},e.getGlobal=function(e){var t=localStorage.getItem(e),n=null;return t&&(n=JSON.parse(t)),n},e.removeGlobal=function(e){localStorage.removeItem(e)},e.clearStorage=function(){localStorage.clear()}}(gamedex.module("storage"),gamedex,jQuery,_),function(e,t,n,r){"use strict";var i=t.module("user"),s=t.module("storage"),o=t.module("utilities"),u=o.VIEW_ALL_TAG_ID,a={},f={},l=function(e){var t=null;return typeof a[e]!="undefined"?t=a[e]:t=E(e),t},c=function(e,t){r.each(e,function(e,n){typeof t[e.itemID]!="undefined"&&r.each(t[e.itemID].tags,function(t,n){h(n,e),h(u,e)})})},h=function(e,t){typeof a[e]!="undefined"?a[e][t.itemID]=t:(a[e]={},a[e][t.itemID]=t),m(e,t)},p=function(e,t){a[e][t.itemID]=t,m(e,t,!0)},d=function(){return s.get("itemDataDirectory")},v=function(e){s.set("itemDataDirectory",e)},m=function(e,t,n){if(typeof f[e+"_"+t.itemID]=="undefined"||n){var r=s.get("itemsCacheByTag");r?typeof r[e]!="undefined"?r[e][t.itemID]=t:(r[e]={},r[e][t.itemID]=t):(r={},r[e]={},r[e][t.itemID]=t),s.set("itemsCacheByTag",r)}},g=function(e,t){a[t]&&delete a[t][e],w(e,t)},y=function(e){a[e]&&delete a[e],b(e)},b=function(e){var t=s.get("itemsCacheByTag");t&&(delete t[e],s.set("itemsCacheByTag",t))},w=function(e,t){var n=s.get("itemsCacheByTag");n&&(delete n[t][e],s.set("itemsCacheByTag",n))},E=function(e){var t=s.get("itemsCacheByTag"),n=null;return t&&typeof t[e]!="undefined"&&(n=t[e],r.each(n,function(t,n){f[e+"_"+n]=!0})),n},S=function(e){a={},f={}},x=function(e){s.remove("itemsCacheByTag"),s.remove("itemDataDirectory"),s.remove("tag")},T={getCachedItemsByTag:l,cacheItemsByTag:c,cacheItemByTag:h,updateCacheItemByTag:p,getStoredItemDirectory:d,storeItemDirectory:v,deleteCachedItem:g,deleteCachedTag:y,clearItemCache:S,clearStoredData:x};n.extend(e,T)}(gamedex.module("itemCache"),gamedex,$,_),function(e,t,n,r,i){"use strict";var s=t.module("utilities"),o=["accessory","case","codes","combo","console","controller","covers","face plate","faceplate","head set","headset","import","japan","kit","map","membership","new","pack","poster","pre-paid","set","shell","skin","software","stylus","wireless"],u=t.api+"amazon/search/",a=t.api+"amazon/detail/",f=500,l=3e3,c={},h={},p={},d={},v=[],m=null,g=0;e.searchAmazon=function(t,r,i,s,o){o=typeof o!="undefined"?o:!1;var a=encodeURIComponent(t),c={keywords:t,browse_node:r,search_index:"VideoGames",response_group:"ItemAttributes,Images",page:1};m&&o&&m.abort();var h=++g;return m=n.ajax({url:u,type:"GET",data:c,dataType:"xml",cache:!0,success:function(e){if(h===g||!o)m=null,i(e)},error:function(){var n=Math.floor(Math.random()*(l-f+1))+f;(function(){e.searchAmazon(t,r,i,s,o)}).delay(n),s(!0)}}),m},e.parseAmazonResultItem=function(e){var t=!1,n="("+o.join("|")+")",r=new RegExp(n,"i"),u={name:e.find("Title").text(),platform:e.find("Platform").text()};return r.test(u.name)||u.platform===""?u.isFiltered=!0:(u.id=e.find("ASIN").text(),u.asin=e.find("ASIN").text(),u.gbombID=0,u.smallImage=e.find("ThumbnailImage > URL:first").text()||"",u.thumbnailImage=e.find("MediumImage > URL:first").text()||"",u.largeImage=e.find("LargeImage > URL:first").text()||"",u.description=e.find("EditorialReview > Content:first").text()||"",u.releaseDate=e.find("ReleaseDate").text()||"1900-01-01",u.platform=s.matchPlatformToIndex(u.platform).name,u.releaseDate!=="1900-01-01"?u.calendarDate=i(u.releaseDate,"YYYY-MM-DD").calendar():u.calendarDate="Unknown"),u},e.getAmazonItemDetail=function(e,t,i){var s=w(e);if(s)t(s);else{r.has(d,e)||(d[e]=[]),d[e].push(t);if(d[e].length===1){var o={asin:e,response_group:"Medium"};n.ajax({url:a,type:"GET",data:o,dataType:"xml",cache:!0,success:function(t){r.each(d[e],function(n){h[e]=t,n(t)}),d[e]=[]},error:i})}}},e.getAmazonItemOffers=function(e,t,i,s){var o=b(e);if(o)t.offers=o,i(o);else{r.has(p,e)||(p[e]=[]),p[e].push(i);if(p[e].length===1){var u={asin:e,response_group:"OfferFull"};n.ajax({url:a,type:"GET",data:u,dataType:"xml",cache:!0,success:function(n){r.each(p[e],function(r){var i=E(n,t);c[e]=i,r(i)}),p[e]=[]},error:s})}}};var y=function(e){var t=null,n=null;for(var r=0,i=e.offers.length;r<i;r++)e.offers[r].availability==="now"&&(t=e.offers[r].price,n=e.offers[r].rawPrice);t=t||e.lowestNewPrice,t==="Too low to display"&&(t="n/a",n=0),e.lowestNewPrice==="Too low to display"&&(e.lowestNewPrice="n/a"),e.buyNowPrice=t,e.buyNowRawPrice=n},b=function(e){var t=null;return typeof c[e]!="undefined"&&(t=c[e]),t},w=function(e){var t=null;return typeof h[e]!="undefined"&&(t=h[e]),t},E=function(e,t){var r={};return n("Item",e).each(function(){r=S(n(this))}),t.offers=r,r},S=function(e){var t={},r={},i=/\$/,s=parseInt(e.find("TotalNew").text(),10),o=parseInt(e.find("TotalUsed").text(),10);if(s!==0||o!==0){t.totalNew=s,t.totalUsed=o,t.lowestNewPrice=e.find("LowestNewPrice FormattedPrice").text().replace(i,""),t.lowestUsedPrice=e.find("LowestUsedPrice FormattedPrice").text().replace(i,""),t.totalOffers=e.find("TotalOffers").text(),t.offersURL=e.find("MoreOffersUrl").text(),t.offersURLNew=e.find("MoreOffersUrl").text()+"&condition=new",t.offersURLUsed=e.find("MoreOffersUrl").text()+"&condition=used";var u=/offer-listing/gi;t.productURL=t.offersURL.replace(u,"product"),t.offers=[],n("Offer",e).each(function(){r={},r.price=n(this).find("Price FormattedPrice").text().replace(i,""),r.rawPrice=n(this).find("Price Amount").text(),r.availability=n(this).find("AvailabilityType").text(),r.freeShipping=n(this).find("IsEligibleForSuperSaverShipping").text(),t.offers.push(r)}),y(t)}return t}}(gamedex.module("amazon"),gamedex,jQuery,_,moment),function(e,t,n,r,i){"use strict";var s=t.module("amazon"),o=t.api+"giantbomb/search/",u=t.api+"giantbomb/detail/",a={},f={},l={},c={};e.searchGiantBomb=function(e,t,r){var i=encodeURIComponent(e),s=["id","name","original_release_date","image"],u={field_list:s.join(","),keywords:e,page:0},a=n.ajax({url:o,type:"GET",data:u,dataType:"json",cache:!0,success:t,error:r});return a},e.parseGiantBombResultItem=function(e){var t={id:e.id,asin:0,gbombID:e.id,name:e.name,platform:"n/a"};return e.original_release_date&&e.original_release_date!==""?t.releaseDate=e.original_release_date.split(" ")[0]:t.releaseDate="1900-01-01",t.releaseDate!=="1900-01-01"?t.calendarDate=i(t.releaseDate,"YYYY-MM-DD").calendar():t.calendarDate="Unknown",e.image&&e.image.small_url&&e.image.small_url!==""?t.smallImage=e.image.small_url:t.smallImage="no image.png",e.image&&e.image.thumb_url&&e.image.thumb_url!==""?t.thumbnailImage=e.image.thumb_url:t.thumbnailImage="no image.png",e.image&&e.image.super_url&&e.image.super_url!==""?t.largeImage=e.image.super_url:t.largeImage="no image.png",e.description&&e.description!==""?t.description=e.description:t.description="No Description",t},e.getGiantBombItemPlatform=function(e,t,n){var r=["platforms"],i=h(e,r,function(n){t(n,e)},n);return i},e.getGiantBombItemData=function(e,t,n){var i=p(e);if(i)t(i);else{r.has(l,e)||(l[e]=[]),l[e].push(t);if(l[e].length===1){var s=["description","site_detail_url","videos"];h(e,s,function(t){r.each(l[e],function(n){a[e]=t.results,n(t.results)}),l[e]=[]},n)}}},e.getGiantBombItemDetail=function(e,t,n){var i=d(e);if(i)t(i);else{r.has(c,e)||(c[e]=[]),c[e].push(t);if(c[e].length===1){var s=["id","name","original_release_date","image"];h(e,s,function(t){r.each(c[e],function(n){f[e]=t.results,n(t.results)}),c[e]=[]},n)}}};var h=function(e,t,r,i){var s={field_list:t.join(","),id:e},o=n.ajax({url:u,type:"GET",data:s,dataType:"json",cache:!0,success:r,error:i});return o},p=function(e){var t=null;return typeof a[e]!="undefined"&&(t=a[e]),t},d=function(e){var t=null;return typeof f[e]!="undefined"&&(t=f[e]),t}}(gamedex.module("giantbomb"),gamedex,jQuery,_,moment),function(e,t,n,r){"use strict";var i=t.module("amazon"),s=t.module("giantbomb"),o=t.module("utilities");e.standardizeTitle=function(e){var t=e,n=null,r=null,i=null,s=null,o="",u=0,a=0,f=null;return t=t.replace(/\s*[\[\(].*[\)\]]/gi,""),t=t.replace(/\s*trophies/gi,""),t=t.replace(/\S+ edition$/gi,""),t=t.replace(/\swith\s.*/gi,""),t=t.replace(/^\s*the\s/gi,""),i&&i[0].length>3&&(t=t.replace(n,"")),t.toLowerCase()},e.getSimilarityScore=function(t,n){var r=0,i=e.standardizeTitle(n.name);if(t.standardName===n.name.toLowerCase())r+=50;else{var s=new RegExp(t.standardName,"gi"),u=new RegExp(i,"gi"),a=s.exec(i),f=u.exec(t.standardName);if(a&&a[0].length>0||f&&f[0].length>0)r+=5}if(typeof n.releaseDate!="undefined")if(t.releaseDate===n.releaseDate)r+=10;else{var l=Math.floor((Date.parse(t.releaseDate)-Date.parse(n.releaseDate))/864e5);!isNaN(l)&&n.releaseDate!=="1900-01-01"&&(r-=Math.abs(l/365))}if(typeof n.platform!="undefined"){var c=o.matchPlatformToIndex(n.platform).name;t.platform===c&&(r+=20)}return r},e.convertRomanNumerals=function(e){var t=new RegExp("\\s[XVI]+","gi"),n=t.exec(e);if(n&&n[0].length>0){var r=n[0],i=new RegExp("III","gi"),s=i.exec(r),o="";s&&s[0].length>0&&(o=3,r=r.replace(i,""));var u=r.split(""),a=null;for(var f=u.length-1;f>=1;f--){switch(u[f]){case"I":a=1;break;case"V":a=5;break;case"X":a=10}a<o?o-=a:o+=a}e=e.replace(t," "+o)}return e},e.findItemOnAlternateProvider=function(e,t,n,r,u){var a=null;u=typeof u!="undefined"?u:null;switch(t){case o.SEARCH_PROVIDERS.Amazon:var c=e.standardName;a=s.searchGiantBomb(c,function(t){l(t,e,r,u)});break;case o.SEARCH_PROVIDERS.GiantBomb:var h=0;e.platform!=="n/a"&&(h=o.getStandardPlatform(e.platform).amazon),a=i.searchAmazon(e.name,h,function(t){f(t,e,r,u,!1)},u,n)}return a},e.getLinkedItemData=function(e,t,n){switch(t){case o.SEARCH_PROVIDERS.Amazon:s.getGiantBombItemDetail(e.gbombID,function(e){a(e,n)});break;case o.SEARCH_PROVIDERS.GiantBomb:i.getAmazonItemDetail(e.asin,function(e){u(e,n)})}},e.findWikipediaMatch=function(t,n,r){var i=t,s={},o=null,u=-99999,a=0;for(var f=0,l=i.length;f<l;f++)s={name:i[f]},f===0&&(o=s),a=e.getSimilarityScore(n,s),a>u&&(o=s,u=a);i.length!==0&&r(o)};var u=function(e,t){var r={};n("Item",e).each(function(){r=i.parseAmazonResultItem(n(this))}),t(r)},a=function(e,t){var n=s.parseGiantBombResultItem(e);t(n)},f=function(t,r,s,o,u){var a=n("Item",t).length,l={},c=0,h=null,p=-99999,d=0;n("Item",t).each(function(){l=i.parseAmazonResultItem(n(this)),typeof l.isFiltered=="undefined"&&(c===0&&(h=l),c++,d=e.getSimilarityScore(r,l),d>p&&(h=l,p=d))}),h?s(h):u?o():i.searchAmazon(r.name,0,function(e){f(e,r,s,o,!0)},o)},l=function(t,n,r,i){var o=t.results,u={},a=null,f=-99999,l=0;for(var c=0,h=o.length;c<h;c++)u=s.parseGiantBombResultItem(o[c]),c===0&&(a=u),l=e.getSimilarityScore(n,u),l>f&&(a=u,f=l);o.length!==0?r(a):i()}}(gamedex.module("itemLinker"),gamedex,jQuery,_),function(e,t,n,r,i,s){"use strict";var o=t.module("user"),u=t.module("itemLinker"),a=t.module("itemCache"),f=t.module("tagView"),l=t.module("utilities"),c=t.api+"item/directory/",h=t.api+"item/",p=t.api+"item/add/",d=t.api+"item/delete/batch/",v=t.api+"item/delete/",m=t.api+"item/user/update/",g=t.api+"item/shared/price/update/",y=t.api+"item/metacritic/update/",b=t.api+"import/",w=l.VIEW_ALL_TAG_ID,E={},S={},x={},T={},N=function(){n(document).keypress(function(e){e.which==96&&(console.warn("------------ itemDataDirectory: -------",S),console.warn("------------ amazonDirectory: -------",x),console.warn("------------ giantBombDirectory: -------",T),console.warn("------------ items: -------------------",E))})},C=function(e){a.cacheItemsByTag(e,S)},k=function(e,t){var r=null,i=o.getUserCredentials(),s=a.getStoredItemDirectory();if(s)A(s),e&&e(s);else{var u={};n.extend(!0,u,i),r=n.ajax({url:c,type:"POST",data:u,dataType:"json",cache:!0,success:function(t){L(t),a.storeItemDirectory(S),e&&e(t)},error:function(e){}})}return r},L=function(e){var t={};r.each(e.directory,function(e,n){t={itemID:n,asin:e.aid,gbombID:e.gid,gameStatus:e.gs,playStatus:e.ps,tags:e.t,tagCount:e.tc,userRating:e.ur},Q(t)})},A=function(e){var t={};r.each(e,function(e){Q(e)})},O=function(e,t,r){var i=null,s=a.getCachedItemsByTag(e);if(s)E=s,t(s);else{var u={list_id:e},f=o.getUserCredentials();n.extend(!0,u,f),i=n.ajax({url:h,type:"POST",data:u,dataType:"json",cache:!0,success:function(e){E=M(e),t(E)},error:r})}return i},M=function(e){var t={},n={},i=0,s=null;return r.each(e.items,function(e){n={};var r=e.ip,i=e.ib||"",s=B(e.si,i,r),o=B(e.ti,i,r),u=B(e.li,i,r);n.id=e.iid,n.initialProvider=e.ip,n.itemID=e.iid,n.asin=e.aid,n.gbombID=e.gid,n.name=e.n,n.releaseDate=e.rd,n.platform=e.p,n.smallImage=s,n.thumbnailImage=o,n.largeImage=u,n.metascore=e.ms,n.metascorePage=e.mp,n.offers={},e.ap!==null&&(n.offers.buyNowPrice=e.ap,n.offers.buyNowRawPrice=e.ap.replace(".",""),n.offers.offersURL=e.apu,n.offers.productURL=e.apu),e.anp!==null&&(n.offers.lowestNewPrice=e.anp,n.offers.offersURLNew=e.anpu),e.aup!==null&&(n.offers.lowestUsedPrice=e.aup,n.offers.offersURLUsed=e.aupu),e.sp!==null&&(n.steamPrice=e.sp,n.steamPage=e.spu),n.description="",X(n),t[n.itemID]=n}),t},_=function(e){return E[e]},D=function(e,t,i,u){var a=null,l=o.getUserCredentials(!0),c=n.extend(!0,{},t),h=H(c.smallImage,c.initialProvider),d=H(c.thumbnailImage,c.initialProvider),v=H(c.largeImage,c.initialProvider),m=h.split(""),g=d.split(""),y=v.split(""),b=P(m,g,y),w=m.slice(0,b).join("");h=m.slice(b).join(""),d=g.slice(b).join(""),v=y.slice(b).join(""),console.info(c);var E={lids:e,n:c.name,rd:c.releaseDate,aid:c.asin,gid:c.gbombID,ip:c.initialProvider,p:c.platform,ib:w,si:h,ti:d,li:v,mp:c.metascorePage,ms:c.metascore,gs:c.gameStatus,ps:c.playStatus,ur:c.userRating};return r.isUndefined(c.offers)||(r.isUndefined(c.offers.buyNowPrice)||(E.ap=c.offers.buyNowPrice,E.apu=c.offers.productURL),r.isUndefined(c.offers.lowestNewPrice)||(E.anp=c.offers.lowestNewPrice,E.anpu=c.offers.offersURLNew),r.isUndefined(c.offers.lowestUsedPrice)||(E.aup=c.offers.lowestUsedPrice,E.aupu=c.offers.offersURLUsed)),r.isUndefined(c.steamPrice)||(E.sp=c.steamPrice,E.spu=c.steamPage),n.extend(!0,E,l),a=n.ajax({url:p,type:"POST",data:E,dataType:"json",cache:!0,success:function(n){t.id=n.itemID,t.itemID=n.itemID;var o=z(t,n);f.updateInitialItemTags(n.tagIDsAdded,n.idsAdded);var u=[],a=" added to tag: ";r.each(e,function(e){u.push(f.getTagName(e))}),e.length>1&&(a=" added to tags: "),s.success(c.name+a+u.join(", ")),i(n,o)},error:u}),a},P=function(e,t,n){var r=0,i="";for(var s=0,o=e.length;s<o;s++){if(e[s]!==t[s]||e[s]!==n[s])break;r=s}return r+1},H=function(e,t){var n=e;return t===l.SEARCH_PROVIDERS.Amazon?n=e.replace(l.AMAZON_IMAGE.RE,l.AMAZON_IMAGE.TOKEN):t===l.SEARCH_PROVIDERS.GiantBomb&&(n=e.replace(l.GIANTBOMB_IMAGE.RE,l.GIANTBOMB_IMAGE.TOKEN)),n},B=function(e,t,n){var r=e,i=null;return e=t+e,n==l.SEARCH_PROVIDERS.Amazon?(i=new RegExp(l.AMAZON_IMAGE.TOKEN,"g"),r=e.replace(i,l.AMAZON_IMAGE.URL)):n==l.SEARCH_PROVIDERS.GiantBomb&&(i=new RegExp(l.GIANTBOMB_IMAGE.TOKEN,"g"),r=e.replace(i,l.GIANTBOMB_IMAGE.URL)),r},j=function(e,t,i,u,a){var l=o.getUserCredentials(!0),c={ids:e};n.extend(!0,c,l),n.ajax({url:d,type:"POST",data:c,dataType:"json",cache:!0,success:function(e){var n=[],o=" removed from tag: ";r.each(t,function(e){n.push(f.getTagName(e))}),t.length>1&&(o=" removed from tags: "),s.error(i.name+o+n.join(", "))},error:a}),F(i.itemID,e,t),u(i.itemID,t)},F=function(e,t,n){for(var r=0,i=t.length;r<i;r++)W(n[r],e)},I=function(e,t,r,i){var s=Y(e).tags[t],u=o.getUserCredentials(!0),a={id:s};return n.extend(!0,a,u),n.ajax({url:v,type:"POST",data:a,dataType:"json",cache:!0,success:function(e){},error:i}),W(t,e),r(s,t),e},q=function(e,t,i,s){var u=!1,a=n.extend(!0,{},e),f={id:a.itemID};t==l.PRICE_PROVIDERS.Amazon?(console.info("update amazon price"),console.info("--------------------"),console.info("--------------------"),console.info("--------------------"),console.info("--------------------"),console.info(a),console.info("--------------------"),console.info("--------------------"),console.info("--------------------"),console.info("--------------------"),console.info("--------------------"),r.isUndefined(a.offers)||r.keys(a.offers).length===0?(a.offers={buyNowPrice:"",buyNowRawPrice:"",lowestNewPrice:"",lowestUsedPrice:"",offersURL:"",offersURLNew:"",offersURLUsed:"",productURL:""},f.ap="",f.apu="",f.anp="",f.anpu="",f.aup="",f.aupu=""):(!r.isUndefined(a.offers.buyNowPrice)&&a.offers.buyNowPrice!==""&&(u=!0,f.ap=a.offers.buyNowPrice,f.apu=a.offers.productURL),!r.isUndefined(a.offers.lowestNewPrice)&&a.offers.lowestNewPrice!==""&&(u=!0,f.anp=a.offers.lowestNewPrice,f.anpu=a.offers.offersURLNew),!r.isUndefined(a.offers.lowestUsedPrice)&&a.offers.lowestUsedPrice!==""&&(u=!0,f.aup=a.offers.lowestUsedPrice,f.aupu=a.offers.offersURLUsed))):t==l.PRICE_PROVIDERS.Steam&&(console.info("update steam price"),r.isUndefined(a.steamPrice)?(u=!0,a.steamPrice="",a.steamPage="",f.sp="",f.spu=""):!r.isUndefined(a.steamPrice)&&a.steamPrice!==""&&(u=!0,f.sp=a.steamPrice,f.spu=a.steamPage));if(u){var c=Y(e.itemID).tags,h=o.getUserCredentials(!0);$(a,c),n.extend(!0,f,h),n.ajax({url:g,type:"POST",data:f,dataType:"json",cache:!0,success:function(e){i(a,e)},error:s})}},R=function(e,t,r){var i=o.getUserCredentials(!0),u=n.extend(!0,{},e),a={id:u.itemID,gs:u.gameStatus,ps:u.playStatus,ur:u.userRating};n.extend(!0,a,i),n.ajax({url:m,type:"POST",data:a,dataType:"json",cache:!0,success:function(e){V(u),t(u,e),s.success(u.name+" status updated")},error:r})},U=function(e,t,r){var i=Y(e.itemID).tags,s=o.getUserCredentials(!0),u=n.extend(!0,{},e),a={id:u.itemID,mp:u.metascorePage,ms:u.metascore};n.extend(!0,a,s),$(u,i),n.ajax({url:y,type:"POST",data:a,dataType:"json",cache:!0,success:function(e){t&&t(u,e)},error:r})},z=function(e,t){var i=null,s=null,o=[];e.itemID=t.itemID;for(var u=0,f=t.tagIDsAdded.length;u<f;u++)s=n.extend(!0,{},e),s.id=t.itemID,X(s),a.cacheItemByTag(t.tagIDsAdded[u],s),o.push(s);J(s,t),i=a.getCachedItemsByTag(w);var l=!1;return r.each(i,function(e,t){e.itemID===s.itemID&&(l=!0)}),l||a.cacheItemByTag(w,s),o},W=function(e,t){a.deleteCachedItem(t,e),K(t,e),S[t].tagCount===0&&a.deleteCachedItem(t,w)},X=function(e){e.releaseDate!=="1900-01-01"?e.calendarDate=i(e.releaseDate,"YYYY-MM-DD").calendar():e.calendarDate="Unknown",e.standardName=u.standardizeTitle(e.name)},V=function(e){var t=S[e.itemID];t.gameStatus=e.gameStatus,t.playStatus=e.playStatus,t.userRating=e.userRating,a.storeItemDirectory(S)},$=function(e,t){r.each(t,function(t,n){a.updateCacheItemByTag(n,e)}),a.updateCacheItemByTag(0,e)},J=function(e,t){if(!S[t.itemID]){var n={itemID:e.itemID,asin:e.asin,gbombID:e.gbombID,gameStatus:e.gameStatus,playStatus:e.playStatus,tags:{},tagCount:0,userRating:e.userRating};Q(n)}for(var r=0,i=t.tagIDsAdded.length;r<i;r++)S[t.itemID].tags[t.tagIDsAdded[r]]=t.idsAdded[r],S[t.itemID].tagCount+=1;a.storeItemDirectory(S)},K=function(e,t){var n=S[e];delete n.tags[t],n.tagCount+=-1,a.storeItemDirectory(S)},Q=function(e){S[e.itemID]=e,parseInt(e.asin,10)!==0&&(x[e.asin]=e),parseInt(e.gbombID,10)!==0&&(T[e.gbombID]=e)},G=function(){return S},Y=function(e){return S[e]||null},Z=function(e,t){var n=null;return e!==0?n=T[e]:t!==0&&(n=x[t]),n},et=function(){E={},S={},x={},T={},a.clearItemCache()},tt=function(){var e=[];r.each(E,function(t,n){e.push(n)});var t=Math.floor(Math.random()*e.length);return e[t]},nt=function(e,t,r){var i=o.getUserCredentials(!0),s={source:e,source_user:t};n.extend(!0,s,i),n.ajax({url:b,type:"POST",data:s,dataType:"json",cache:!0,success:r,error:function(e){}})},rt={init:N,itemsAndDirectoryLoaded:C,getItemDirectory:G,getDirectoryItemByItemID:Y,getItemByThirdPartyID:Z,resetItemData:et,getRandomItemID:tt,getItems:O,getItem:_,downloadItemDirectory:k,addItemToTags:D,updateUserItem:R,updateSharedItemPrice:q,updateMetacritic:U,deleteTagsForItem:j,deleteSingleTagForItem:I,deleteTagFromDirectory:K,deleteClientItem:W,importGames:nt};n.extend(e,rt)}(gamedex.module("itemData"),gamedex,$,_,moment,alertify),function(e,t,n,r){"use strict";var i=t.api+"tag/",s=t.api+"tag/add/",o=t.api+"tag/update/",u=t.api+"tag/delete/",a=t.module("user"),f=t.module("storage"),l=t.module("itemData"),c={};e.getTags=function(e,t){var r=null,s=a.getUserCredentials(),o={};return n.extend(!0,o,s),c=f.get("tag"),c?e&&e(c):r=n.ajax({url:i,type:"POST",data:o,dataType:"json",cache:!0,success:function(t){c=f.set("tag",t.list),e(t.list)},error:t}),r},e.addTag=function(e,t,r){var i=a.getUserCredentials(!0),o={tag_name:e};n.extend(!0,o,i),n.ajax({url:s,type:"POST",data:o,dataType:"json",cache:!0,success:function(e){c.push({tagName:e.tagName.toLowerCase(),tagID:e.tagID}),f.set("tag",c),t(e)},error:r})},e.updateTag=function(e,t,r,i){var s=a.getUserCredentials(!0),u={tag_name:e,tag_id:t};n.extend(!0,u,s),n.ajax({url:o,type:"POST",data:u,dataType:"json",cache:!0,success:function(e){r(e)},error:i});for(var l=0,h=c.length;l<h;l++)c[l].tagID===t&&(c[l].tagName=e,f.set("tag",c))},e.deleteTag=function(e,t,r){var i=a.getUserCredentials(!0),s={id:e};n.extend(!0,s,i),n.ajax({url:u,type:"POST",data:s,dataType:"json",cache:!0,success:t,error:r});for(var o=0,l=c.length;o<l;o++)if(c[o].tagID===e){c.splice(o,1),f.set("tag",c);break}}}(gamedex.module("tagData"),gamedex,jQuery,_),function(e,t,n,r){"use strict";var i=t.module("amazon"),s=t.module("itemLinker"),o=t.module("itemData"),u=t.api+"metacritic/search/",a=t.api+"metacritic/cache/",f="metacritic.com",l={},c={};e.getMetascore=function(e,t,i,s){var a=null,f=p(t.asin,t.gbombID,t.platform);if(f)a=f,t.metascore=f.metascore,t.metascorePage=f.metascorePage,s(t);else{var l=e+"_"+t.platform;r.has(c,l)||(c[l]=[]),c[l].push(s);if(c[l].length===1){var g=h(e),y={keywords:encodeURI(g),platform:encodeURI(t.platform)};a=n.ajax({url:u,type:"GET",data:y,cache:!0,success:function(e){var n=t.metascore,s=v(g,e,t);m(s,t),!i&&t.metascore!=n&&o.updateMetacritic(t),r.each(c[l],function(e){d(t.asin,t.gbombID,t.platform,t),e(t)}),c[l]=[]}})}}return a},e.displayMetascoreData=function(e,t,r){var i=n(r),s=t,o="favorable";t<0?(s="n/a",o="unavailable"):t<50?o="unfavorable":t<75&&(o="neutral"),i.html(s).removeClass("unavailable").removeClass("unfavorable").removeClass("neutral").removeClass("favorable").addClass(o).attr("href","http://www."+f+e).attr("data-score",t).attr("data-original-title",f+" "+e).show(),i.tooltip({placement:"left"})};var h=function(e){n=/\s*[:&]\s*/g;var t=e.replace(n," "),n=/\s/g;return t=t.replace(n,"+"),t},p=function(e,t,n){var r=null;return typeof l[e+"_"+n]!="undefined"?r=l[e+"_"+n]:typeof l[t+"_"+n]!="undefined"&&(r=l[t+"_"+n]),r},d=function(e,t,n,r){e!="0"&&(l[e+"_"+n]={metascorePage:r.metascorePage,metascore:r.metascore}),t!="0"&&(l[t+"_"+n]={metascorePage:r.metascorePage,metascore:r.metascore})},v=function(e,t,n){var r=null;return typeof t.metascore=="undefined"?(r=y(t,n),r&&g(e,n.platform,r.metascore,r.metascorePage)):r=t,r},m=function(e,t){e&&e.metascore!==""?(t.metascore=e.metascore,t.displayMetascore=e.metascore,t.metascorePage=e.metascorePage):e?(t.metascore=-1,t.displayMetascore="n/a",t.metascorePage=e.metascorePage):(t.metascore=-1,t.displayMetascore="n/a",t.metascorePage="")},g=function(e,t,r,i){var s={keywords:encodeURI(e),platform:encodeURI(t),metascore:encodeURI(r),metascorePage:encodeURI(i)};n.ajax({url:a,type:"GET",data:s,cache:!0,success:function(e){}})},y=function(e,t){var r=n("#main",e).find(".result"),i={},o=null,u=-99999,a=0;return n(r).each(function(){var e=new Date(n(this).find(".release_date .data").text()),r=e.getMonth()+1;r=r<10?"0"+r:r;var f=e.getDate();f=f<10?"0"+f:f,i={name:n(this).find(".product_title a").text(),releaseDate:e.getFullYear()+"-"+r+"-"+f,platform:n(this).find(".platform").text(),metascore:n(this).find(".metascore").text(),metascorePage:n(this).find(".product_title a").attr("href")},a=s.getSimilarityScore(t,i),a>u&&(o=i,u=a)}),o}}(gamedex.module("metacritic"),gamedex,jQuery,_),function(e){var t=gamedex.module("user"),n=gamedex.module("utilities"),r=gamedex.module("itemLinker"),i={};e.getWikipediaPage=function(e,t,n){var u=i[t.id];u&&typeof u.wikipediaPage!="undefined"?n(u.wikipediaPage):s(e,function(e){pageArray=e[1],r.findWikipediaMatch(pageArray,t,function(e){o(e.name,function(e){_.each(e.query.pages,function(e,r){u?u.wikipediaPage=e.fullurl:i[t.id]={wikipediaPage:e.fullurl},n(e.fullurl)})})})})};var s=function(e,t,n){var r="http://en.wikipedia.org/w/api.php?action=opensearch&format=json&callback=?",i={search:e,prop:"revisions",rvprop:"content"};$.ajax({url:r,type:"GET",data:i,dataType:"jsonp",cache:!1,crossDomain:!0,success:t,error:n})},o=function(e,t,n){var r="http://en.wikipedia.org/w/api.php?action=query&format=json&callback=?",i={titles:e,prop:"info",inprop:"url"};$.ajax({url:r,type:"GET",data:i,dataType:"jsonp",cache:!1,crossDomain:!0,success:t,error:n})}}(gamedex.module("wikipedia")),function(e,t,n,r){"use strict";var i=t.module("amazon"),s=t.module("itemLinker"),o=t.module("itemData"),u=t.api+"gametrailers/search/",a=t.api+"gametrailers/cache/",f="gametrailers.com",l={},c={};e.getGametrailersPage=function(e,t,i){var s=null,o=p(e);if(o)t.gametrailersPage=o.gametrailersPage,i(t.gametrailersPage);else{var a=e+"_";r.has(c,a)||(c[a]=[]),c[a].push(i);if(c[a].length===1){var f=h(e),l={keywords:encodeURI(f)};s=n.ajax({url:u,type:"GET",data:l,cache:!0,success:function(n){var i=v(f,n,t);r.each(c[a],function(n){t.gametrailersPage=i,d(e,i),n(i)}),c[a]=[]}})}}return s};var h=function(e){n=/\s*[:&]\s*/g;var t=e.replace(n," "),n=/\s/g;return t=t.replace(n,"+"),t},p=function(e){var t=null;return typeof l[e]!="undefined"&&(t=l[e]),t},d=function(e,t){l[e]={gametrailersPage:t}},v=function(e,t,n){var r=null;return typeof t.gametrailersPage=="undefined"?(r=g(t,n),r&&m(e,r)):r=t.gametrailersPage,r},m=function(e,t){var r={keywords:encodeURI(e),gametrailersPage:encodeURI(t)};n.ajax({url:a,type:"GET",data:r,cache:!0,success:function(e){}})},g=function(e,t){var r=n("#games",e).find(".video_game_information_child"),i={},o=null,u=-99999,a=0;return n(r).each(function(){i={name:n(this).find(".content h3 a").text(),releaseDate:n(this).find(".content dl dd:eq(1) a").text(),gametrailersPage:n(this).find(".content h3 a").attr("href")},a=s.getSimilarityScore(t,i),a>u&&(o=i,u=a)}),o.gametrailersPage+"/videos-trailers"}}(gamedex.module("gameTrailers"),gamedex,jQuery,_),function(e,t,n,r){"use strict";var i=t.module("itemLinker"),s=t.api+"steam/search/",o=t.api+"steam/cache/",u="http://store.steampowered.com/",a={},f={};e.getSteamGame=function(e,t,i,o){var u=null,a=c(e);if(a)t.steamPage=a.steamPage,t.steamPrice=a.steamPrice,i(a);else{var d=e+"_";r.has(f,d)||(f[d]=[]),f[d].push(i);if(f[d].length===1){var v=l(e),m={keywords:encodeURI(v)};u=n.ajax({url:s,type:"GET",data:m,cache:!0,success:function(n){var i=p(v,n,t);i?r.each(f[d],function(n){t.steamPage=i.steamPage,t.steamPrice=i.steamPrice,h(e,i.steamPage,i.steamPrice),n(i)}):r.isUndefined(o)||o(),f[d]=[]}})}}return u};var l=function(e){n=/\s*[:&]\s*/g;var t=e.replace(n," "),n=/\s/g;return t=t.replace(n,""),t},c=function(e){var t=null;return typeof a[e]!="undefined"&&(t=a[e]),t},h=function(e,t,n){a[e]={steamPage:t,steamPrice:n}},p=function(e,t,n){var r={};return typeof t.url=="undefined"?(r=v(t,n),r&&d(e,r.steamPage,r.steamPrice)):r={steamPage:t.url,steamPrice:t.price},r},d=function(e,t,r){var i={keywords:encodeURI(e),url:encodeURI(t),price:encodeURI(r)};n.ajax({url:o,type:"GET",data:i,cache:!0,success:function(e){}})},v=function(e,t){var n=null,s=-99999,o=0;return r.each(e,function(e){o=i.getSimilarityScore(t,e),o>s&&(n={steamPage:e.page,steamPrice:e.price.replace("$","")},s=o)}),n}}(gamedex.module("steam"),gamedex,jQuery,_),function(e,t,n,r){var i=t.api+"list/ign/upcoming/popular/",s=t.api+"list/ign/upcoming/",o=t.api+"list/ign/reviewed/",u={};IGNUpcomingListCache={},IGNReviewedListCache={},e.getPopularGames=function(e,t,r){var s=a(u,e,t);if(s)r(s);else{var o={platform:e,page:t};n.ajax({url:i,type:"GET",data:o,cache:!0,success:function(n){u[e+"_"+t]=n,r(n)}})}},e.getUpcomingGames=function(e,t,r){var i=a(IGNUpcomingListCache,e,t);if(i)r(i);else{var o={platform:e,page:t};n.ajax({url:s,type:"GET",data:o,cache:!0,success:function(n){IGNUpcomingListCache[e+"_"+t]=n,r(n)}})}},e.getReviewedGames=function(e,t,r){var i=a(IGNReviewedListCache,e,t);if(i)r(i);else{var s={platform:e,page:t};n.ajax({url:o,type:"GET",data:s,cache:!0,success:function(n){IGNReviewedListCache[e+"_"+t]=n,r(n)}})}};var a=function(e,t,n){var r=null;return typeof e[t+"_"+n]!="undefined"&&(r=e[t+"_"+n]),r}}(gamedex.module("ign"),gamedex,jQuery,_),function(e,t,n,r){"use strict";var i=t.module("utilities"),s=t.api+"list/gt/released/",o={},u={},a={};e.getReleasedGames=function(e,t,i,p,d){var v=h(t,i,p),m=null;if(v){var g=c(v,e);d(g,u)}else{var y=t+"_"+i+"_"+p;if(!r.has(a,y)){var b={platform:e};a[y]=b;var w={year:t,month:i,day:p};m=n.ajax({url:s,type:"GET",data:w,cache:!0,success:function(e){f(e),l(e);var n=c(e,a[y].platform);o[t+"_"+i+"_"+p]=e,d(n,u),delete a[y]}})}else a[y].platform=e}return m};var f=function(e){r.each(e,function(e){var t=e.platforms.split(",");e.linkedPlatforms={all:undefined},r.each(t,function(t){var n=r.str.trim(t),s=i.getStandardPlatform(n);e.linkedPlatforms[s.id]=s.name})})},l=function(e){r.each(e,function(e){r.each(e.linkedPlatforms,function(e,t){r.has(u,t)?u[t]=u[t]+1:u[t]=1})})},c=function(e,t){var n=[];return r.each(e,function(e){e.name=e.name.replace(/\sbox\s*.*/gi,""),r.has(e.linkedPlatforms,t)&&n.push(e)}),n},h=function(e,t,n){var r=null;return typeof o[e+"_"+t+"_"+n]!="undefined"&&(r=o[e+"_"+t+"_"+n]),r}}(gamedex.module("releasedList"),gamedex,jQuery,_),function(e,t,n,r,i){"use strict";var s=t.module("user"),o=t.module("itemData"),u=t.module("tagView"),a=t.module("itemView"),f=t.module("searchView"),l=t.module("storage"),c=t.module("gridView"),h={login:0,signup:1},p=600,d="Demo",v=!1,m=h.login,g=!1,y=1,b=n("#content"),w=n("#infoHeader"),E=n("#header"),S=n("#userMenu"),x=n("#loggedInButton"),T=n(".miniLogo"),N=n("#managementButton"),C=n("#updateProfileButton"),k=n("#changePasswordButton"),L=n("#logoutButton"),A=n("#hideInfoHeader_btn"),O=n("#showInfoHeader_btn"),M=n("#loginForm"),_=n("#buttonContainer"),D=n("#loginButton"),P=n("#loginHitArea"),H=n("#signupButton"),B=n("#signupHitArea"),j=n("#loginSubmitButton"),F=n("#signupSubmitButton"),I=n("#backButton"),q=n("#email").find("input"),R=n("#password").find("input"),U=n("#rememberCheckboxToggle"),z=n("#resetPasswordButton"),W=n("#invalidLoginTag"),X=n("#accountExistsTag"),V=n("#accountManagement-modal"),$=V.find("#clearLocalStorage_btn"),J=V.find(".alert-success"),K=V.find(".alert-error"),Q=V.find(".existingPasswordGroup"),G=n("#accountPasswordField"),Y=n("#deleteAccount_btn"),Z=n("#deleteAccountConfirm-modal"),et=n("#deleteAccountConfirm_btn"),tt=n("#updateProfile-modal"),nt=tt.find(".usernameGroup"),rt=tt.find("#userNameUpdateField"),it=tt.find(".emailGroup"),st=tt.find("#emailUpdateField"),ot=tt.find("#profilePasswordField"),ut=tt.find(".existingPasswordGroup"),at=tt.find(".alert-success"),ft=tt.find(".alert-error"),lt=tt.find("#updateAccount_btn"),ct=tt.find(".profileURL"),ht=n("#changePassword-modal"),pt=ht.find(".existingPasswordGroup"),dt=ht.find(".confirmPasswordGroup"),vt=ht.find(".newPasswordGroup"),mt=ht.find("#passwordUpdateField"),gt=ht.find("#passwordConfirmField"),yt=ht.find("#existingPasswordField"),bt=ht.find(".alert-error"),wt=ht.find(".alert-success"),Et=ht.find("#changePassword_btn"),St=n("#resetpassword-modal"),xt=St.find(".resetCodeForm"),Tt=St.find(".updatePasswordForm"),Nt=St.find(".passwordResetCodeContainer"),Ct=St.find(".passwordResetEmailContainer"),kt=St.find(".alert-success"),Lt=St.find(".alert-error"),At=n("#resetPasswordEmailField"),Ot=n("#resetPasswordCodeField"),Mt=n("#resetPasswordPasswordField"),_t=n("#sendResetCode_btn"),Dt=n("#submitResetCode_btn"),Pt=n("#updatePassword_btn"),Ht=n("#guideHitArea"),Bt=n("#guideButton"),jt=n("#siteGuide"),Ft=n("#siteGuideBackdrop"),It=jt.find(".siteGuideExit_btn"),qt=jt.find(".siteGuidePrevious_btn"),Rt=jt.find(".siteGuideNext_btn"),Ut=n("#searchField input"),zt=n("#itemResultsContainer").find(".loadingStatus"),Wt=function(){i.set({labels:{ok:"Close",cancel:"Close"},delay:2e3}),Xt(),$t(),St.modal({backdrop:!0,keyboard:!0,show:!1}),Gt()},Xt=function(){window.addEventListener("popstate",function(e){var t=window.location.pathname;Vt(t)}),A.click(function(e){e.preventDefault(),bn()}),O.click(function(e){e.preventDefault(),wn()}),N.click(function(e){e.preventDefault(),An()}),C.click(function(e){e.preventDefault(),On()}),k.click(function(e){e.preventDefault(),Mn()}),lt.click(function(e){e.preventDefault(),Dn()}),Et.click(function(e){e.preventDefault(),_n()}),q.on("keydown",function(e){Ln(e.which)}),R.on("keydown",function(e){Ln(e.which)}),L.click(function(e){e.preventDefault(),rn()}),T.on("click",function(e){rn()}),$.click(function(e){e.preventDefault(),l.clearStorage()}),Y.click(function(e){e.preventDefault(),Pn()}),et.click(function(e){e.preventDefault(),Hn()}),B.click(function(e){e.preventDefault(),Tn()}),B.mouseover(function(e){H.addClass("hover")}),B.mouseout(function(e){H.removeClass()}),B.mousedown(function(e){H.addClass("active")}),B.mouseup(function(e){H.removeClass("active")}),P.click(function(e){e.preventDefault(),xn()}),P.mouseover(function(e){D.addClass("hover")}),P.mouseout(function(e){D.removeClass()}),P.mousedown(function(e){D.addClass("active")}),P.mouseup(function(e){D.removeClass("active")}),Ht.click(function(e){an()}),Ht.mouseover(function(e){Bt.addClass("hover")}),Ht.mouseout(function(e){Bt.removeClass()}),Ht.mousedown(function(e){Bt.addClass("active")}),Ht.mouseup(function(e){Bt.removeClass("active")}),j.click(function(e){e.preventDefault(),Kt(q.val(),R.val())}),F.click(function(e){e.preventDefault(),sn(q.val(),R.val())}),I.click(function(e){e.preventDefault(),kn()}),U.click(function(e){g?(g=!1,n(this).removeClass("on"),Jt()):(g=!0,n(this).addClass("on"))}),z.click(function(e){e.preventDefault();var t=q.val()||l.getGlobal("email");t&&At.val(t),St.modal("show"),r.delay(function(){At.focus().select()},1e3)}),_t.click(function(e){e.preventDefault(),ln(At.val())}),Dt.click(function(e){e.preventDefault(),hn(At.val(),Ot.val())}),Pt.click(function(e){e.preventDefault(),dn(At.val(),Ot.val(),Mt.val())}),At.keydown(function(e){e.which===13&&(e.preventDefault(),ln(At.val()))}),Ot.keydown(function(e){e.which===13&&(e.preventDefault(),hn(At.val(),Ot.val()))}),Mt.keydown(function(e){e.which===13&&(e.preventDefault(),dn(At.val(),Ot.val(),Mt.val()))}),jt.click(function(e){e.preventDefault(),e.stopPropagation()}),Rt.click(function(e){e.preventDefault(),an(++y)}),qt.click(function(e){e.preventDefault(),an(--y)}),It.click(function(e){e.preventDefault(),y=1,an(y),fn()})},Vt=function(e){d="Demo",v&&Gt()},$t=function(){var e=l.getGlobal("email");e&&(g=!0,q.val(e),U.addClass("on"),R.focus())},Jt=function(){g?l.setGlobal("email",q.val()):l.removeGlobal("email")},Kt=function(e,t){Qt(),s.login(e,t,on)},Qt=function(){R.val(""),W.hide(),X.hide()},Gt=function(){var e=window.location.pathname.split("/"),t=e[1];t!==""?s.validateUser(t,function(e){e.status==="success"?Zt(t):en(t)}):Yt()},Yt=function(){i.success("Loading Demo"),tn(),s.demoLogin(),nn()},Zt=function(e){d=e,i.success("Loading User: "+e),yn(e),nn()},en=function(e){i.alert('User "'+e+'" not found'),Yt()},tn=function(){var e=window.location.pathname;history&&e!=="/"&&history.pushState(null,null,"/"),n("body").removeClass("viewOnly")},nn=function(){zt.addClass("show"),a.clearItemView(),a.resizePanel(),o.resetItemData(),window.setTimeout(function(){var e=null,t=null,r=o.downloadItemDirectory(),i=a.initializeUserItems(function(t){e=t},function(){e={}}),s=u.getTags(function(e){t=e},function(){});n.when(i,r,s).then(function(){u.getTags_result(t),a.initializeUserItems_result(e),zt.removeClass("show"),v=!0},function(){})},p)},rn=function(){d="Demo",wn(),a.clearItemView(),c.exitGridView(),s.logout(),Yt()},sn=function(e,t){Qt(),e!==""&&t!==""&&s.createUser(e,t,un)},on=function(e,t){e.status==="success"?(Jt(),gn(t),nn()):typeof e.status!="undefined"&&e.status==="invalid_login"&&(i.error("Login Failed: "+t),W.fadeIn())},un=function(e,t){typeof e.status!="undefined"&&e.status==="user_exists"?X.fadeIn():(Jt(),on(e,t))},an=function(e){e&&(b.removeClass(),b.addClass("step"+e)),jt.is(":visible")||jt.show()},fn=function(){jt.is(":visible")&&jt.hide()},ln=function(e){s.sendResetPasswordCode(e,cn)},cn=function(e){typeof e.status!="undefined"&&e.status==="success"?(_t.hide(),Dt.show(),Ct.hide(),Nt.show(),kt.find(".alertTitle").text("E-mail sent:"),kt.show().find(".alertText").html("Check your e-mail and enter the <strong>3-digit code</strong> into the field above"),Lt.hide()):typeof e.status!="undefined"&&e.status==="invalid_email"&&(Lt.find(".alertTitle").text("Invalid E-mail address:"),Lt.show().find(".alertText").html("Cannot send password reset code"))},hn=function(e,t){s.submitResetPasswordCode(e,t,pn)},pn=function(e){typeof e.status!="undefined"&&e.status==="success"?(xt.hide(),Dt.hide(),Tt.show(),Pt.show(),kt.hide(),Lt.hide()):(kt.hide(),Lt.find(".alertTitle").text("Invalid code:"),Lt.show().find(".alertText").html("Reset code is incorrect, please try again"))},dn=function(e,t,n){s.updatePassword(e,t,n,function(t){vn(t,e,n)})},vn=function(e,t,n){typeof e.status!="undefined"&&e.status==="success"&&(mn(),q.val(t),R.val(n),Kt(q.val(),R.val()))},mn=function(){St.modal("hide"),_t.show(),Dt.hide(),Pt.hide(),xt.hide(),Tt.hide(),Ct.show(),Nt.hide(),kt.hide(),Lt.hide(),At.val(""),Ot.val(""),Mt.val("")},gn=function(e){tn(),En(),x.find(".userEmail").text(e),S.show()},yn=function(e){En(),n("body").addClass("viewOnly"),x.find(".userEmail").text(e)},bn=function(){En(),n("body").addClass("demo"),x.find(".userEmail").text(d)},wn=function(){Sn()},En=function(){n("body").removeClass("infoHeader"),n("body").addClass("useHeader"),a.loggedInView(!0),f.loggedInView(!0),S.show()},Sn=function(){n("body").removeClass("useHeader"),n("body").addClass("infoHeader"),n("body").removeClass("viewOnly"),n("body").removeClass("demo"),a.loggedInView(!1),f.loggedInView(!1),S.hide()},xn=function(){m=h.login,Cn(),j.show(),F.hide(),I.removeClass("signup"),I.addClass("login")},Tn=function(){m=h.signup,Cn(),F.show(),j.hide(),I.removeClass("login"),I.addClass("signup")},Nn=function(){},Cn=function(){Qt(),M.show(),I.show(),g&&q.val()!==""?R.focus():q.focus(),_.hide()},kn=function(){M.hide(),j.hide(),F.hide(),I.hide(),_.show()},Ln=function(e){e===13&&m===h.login?Kt(q.val(),R.val()):e===13&&m===h.signup&&sn(q.val(),R.val())},An=function(){Bn(),V.modal("show")},On=function(){Bn();var e=s.getUserData();rt.val(e.userName),st.val(e.email),ct.text("http://www.gamedex.net/"+e.userName),tt.modal("show")},Mn=function(){Bn(),ht.modal("show")},_n=function(){Bn();var e=yt.val(),t=s.getUserData().email,n=mt.val(),r=gt.val();e!==""&&t!==""&n!==""&r!==""&n==r&&s.updateUser(e,t,"",n,function(e){e.status==="success"?(wt.fadeIn().find(".alertText").text("Password Changed"),mt.val(""),gt.val(""),yt.val("")):e.status==="incorrect_password"&&(pt.addClass("error"),bt.fadeIn().find(".alertText").text("Incorrect password"),yt.val(""))}),n===""?(vt.addClass("error"),bt.fadeIn().find(".alertText").text("Please enter new password")):r===""?(dt.addClass("error"),bt.fadeIn().find(".alertText").text("Please confirm password")):n!==r?(mt.val(""),gt.val(""),vt.addClass("error"),dt.addClass("error"),bt.fadeIn().find(".alertText").text("Passwords do not match")):e===""&&(pt.addClass("error"),bt.fadeIn().find(".alertText").text("Please enter existing password"))},Dn=function(){Bn();var e=ot.val(),t=st.val(),n=rt.val();e!==""&&t!==""&&s.updateUser(e,t,n,"",function(e){e.status==="success"?(ct.text("http://www.gamedex.net/"+n),x.find(".userEmail").text(t),ot.val(""),at.fadeIn().find(".alertText").text("Account updated")):e.status==="incorrect_password"?(ot.val(""),ut.addClass("error"),ft.fadeIn().find(".alertText").text("Incorrect password")):e.status==="username_exists"&&(nt.addClass("error"),ft.fadeIn().find(".alertText").text("User name exists"))}),e===""&&(ut.addClass("error"),ft.fadeIn().find(".alertText").text("Please enter existing password")),t===""&&(it.addClass("error"),ft.fadeIn().find(".alertText").text("E-mail cannot be blank")),mt.val("")},Pn=function(){Bn();var e=G.val(),t=s.getUserData().email;e!==""&&t!==""?s.verifyUser(t,e,function(e){typeof e.status!="undefined"&&e.status=="success"?(V.modal("hide"),Z.modal("show")):(G.val(""),Q.addClass("error"),K.show().find(".alertText").html("Incorrect Password"))},function(e){G.val("")}):(Q.addClass("error"),K.show().find(".alertText").html("Please enter existing password"))},Hn=function(){var e=G.val(),t=s.getUserData().user_id;G.val(""),s.deleteAccount(t,e,function(){Z.modal("hide"),l.clearStorage(),rn()},function(){})},Bn=function(){K.hide(),Q.removeClass("error"),nt.removeClass("error"),it.removeClass("error"),ut.removeClass("error"),at.hide(),ft.hide(),vt.removeClass("error"),dt.removeClass("error"),pt.removeClass("error"),wt.hide(),bt.hide()},jn={init:Wt,hideSiteGuide:fn};n.extend(e,jn)}(gamedex.module("siteView"),gamedex,jQuery,_,alertify),function(e,t,n,r,i,s){"use strict";var o=t.module("detailView"),u=t.module("amazon"),a=t.module("giantbomb"),f=t.module("utilities"),l=t.module("ign"),c=t.module("releasedList"),h=t.module("itemLinker"),p={POPULAR:0,UPCOMING:1,RELEASED:2,REVIEWED:3},d={"#searchTab":0,"#listTab":1},v=400,m={List:0,Icons:1,Cover:2},g=258,y=503,b=5,w=13,E=1500,S=1,x=null,T="skyrim",N="",C={},k=[],L=d["#searchTab"],A=!1,O=-1,M=-1,_=-1,D=!1,P=!1,H=!1,B=null,j=0,F=null,I=m.Icons,q=0,R=null,U=m.Icons,z=y,W=!1,X=null,V={valueNames:["itemName","releaseDate"],item:"list-item"},$=n("#searchContainer"),J=n("#searchViewMenu"),K=n("#listType"),Q=K.find(".listTypeName"),G=n("#searchPlatforms"),Y=n("#legacySubNav"),Z=n("#platformSelect_btn"),et=n("#listPlatforms"),tt=n("#listPlatforms").find("ul"),nt=G.find(".platformName"),rt=et.find(".platformName"),it=n("#finderTabLinks"),st=n("#finderTabContent"),ot=n("#searchTab"),ut=n("#listTab"),at=n("#searchTabLink"),ft=n("#listTabLink"),lt=n("#searchField"),ct=n("#search_btn"),ht=n("#clearSearch_btn"),pt=ht.find("i"),dt=n("#searchResultsContainer"),vt=dt.find(".content"),mt=n("#searchResults"),gt=lt.find("input"),yt=n("#listResultsContainer"),bt=yt.find(".content"),wt=n("#listResults"),Et=wt.find(".list"),St=$.find(".searchDisplayOptions"),xt=$.find(".listDisplayOptions"),Tt=dt.find(".loadingStatus"),Nt=yt.find(".loadingStatus"),Ct=r.template(n("#search-results-template").html()),kt=r.template(n("#list-results-template").html()),Lt=r.template(n("#list-platform-template").html()),At=r.template(n("#search-results-platform-dropdown-template").html());e.init=function(t){e.createEventHandlers(),Dt(),R=f.PLATFORM_INDEX[0],F=f.getStandardPlatform(""),Zt(!1),xt.find("button").each(function(e,t){n(t).tooltip({delay:{show:500,hide:50},placement:"bottom"})}),St.find("button").each(function(e,t){n(t).tooltip({delay:{show:500,hide:50},placement:"bottom"})});var r={sliderMinHeight:20,iOSNativeScrolling:!0,preventPageScrolling:!0};dt.nanoScroller(r),yt.nanoScroller(r),setInterval(function(){en(),dt.nanoScroller(),yt.nanoScroller()},1500),bt.on("scroll",function(t){var n=bt.scrollTop(),r=wt.height(),i=bt.height(),s=r-(n+i);s<E&&(A||(A=!0,e.loadNextListPages()))}),Y.BootstrapSubMenu({$mainNav:G})},e.createEventHandlers=function(){it.find('a[data-toggle="tab"]').on("shown",function(e){L=d[n(e.target).attr("href")],It(L)}),gt.keyup(Kt),J.on("mouseenter",".dropdown-toggle",function(e){var t=this;J.find(".dropdown").each(function(){n(this).hasClass("open")&&n(this).find(".dropdown-toggle").get(0)!==n(t).get(0)&&n(t).trigger("click")})}),K.find("li a").click(function(e){e.preventDefault(),K.attr("data-content",n(this).attr("data-content")),qt()}),et.on("click","li a",function(e){e.preventDefault(),n(this).attr("data-content")&&Rt(n(this).attr("data-content"),n(this).text())}),G.find("li:not(.dropdown-sub) a").click(function(e){e.preventDefault(),Ut(n(this).attr("data-content"),n(this).text())}),mt.on("click","tr",Qt),wt.on("click","tr",Gt),mt.on("click",".dropdown-menu li",function(e){e.preventDefault(),Yt(this)}),St.on("click","button",function(e){e.preventDefault(),$t(n(this).attr("data-content"),!1,n(this))}),xt.on("click","button",function(e){e.preventDefault(),(B==p.UPCOMING||B==p.RELEASED||B==p.REVIEWED||B==p.POPULAR)&&$t(n(this).attr("data-content"),!1,n(this))}),ct.click(function(t){t.preventDefault(),e.search(T)}),ht.click(function(e){gt.val(""),gt.focus(),Zt(!1)}),mt.resize(e.resizePanel),wt.resize(e.resizePanel),n(window).resize(e.resizePanel)},e.renderSearchResults=function(e){k=[],Tt.removeClass("show"),r.each(e,function(e,t){k.push(e)}),k.sort(Ft);var t={sortedSearchResults:k};t.displayType=U,mt.html(Ct(t))},e.renderListResults=function(e,t){Nt.removeClass("show");var n={listResults:e};Et.append(kt(n)),Mt(t)},e.search=function(e){e===""?Zt(!1):Zt(!0),L!==d["#searchTab"]&&(at.trigger("click"),It(d["#searchTab"])),e!==N&&(Ot(),dt.find(".noResults").hide(),Tt.addClass("show"),N=e,u.searchAmazon(e,R.amazon,function(t){Pt(t,e)}),a.searchGiantBomb(e,function(t){Ht(t,e)}))},e.loadNextListPages=function(){Nt.addClass("show");switch(B){case p.POPULAR:e.getIGNPopularList(F,_+1);break;case p.UPCOMING:e.getIGNUpcomingList(F,O+1);break;case p.RELEASED:break;case p.REVIEWED:e.getIGNReviewedList(F,M+1)}},e.getIGNPopularList=function(e,t){function r(e){e.length===0&&(H=!0),A=!1,_t(e,"asc",p.POPULAR),_++}if(H){Nt.removeClass("show");return}for(var n=0;n<S;n++)l.getPopularGames(e.ign,t+n,r)},e.getIGNUpcomingList=function(e,t){function r(e){e.length===0&&(D=!0),A=!1,_t(e,"asc",p.UPCOMING),O++}if(D){Nt.addClass("show");return}for(var n=0;n<S;n++)l.getUpcomingGames(e.ign,t+n,r)},e.getIGNReviewedList=function(e,t){function r(e){e.length===0&&(P=!0),A=!1,_t(e,"desc",p.REVIEWED),M++}if(P){Nt.remove("show");return}for(var n=0;n<S;n++)l.getReviewedGames(e.ign,t+n,r)},e.getGTReleasedList=function(e){function u(e,t){_t(e,"desc",p.RELEASED,t)}var t=14,n=i().day(0),r=n;for(var s=0,o=t;s<o;s++)c.getReleasedGames(e.id,r.year(),r.month()+1,r.date(),u),r=r.subtract("weeks",1)},e.resizePanel=function(){var e=null,t=null;switch(L){case d["#searchTab"]:e=mt.height(),t=dt,Tt.is(":visible")&&(e+=Tt.height());break;case d["#listTab"]:e=wt.height(),Nt.is(":visible")&&(e+=Nt.height()),t=yt}var r=n(window).height();if(e<r-z)t.css({height:e+b});else{var i=r-z;t.css({height:i+w})}},e.loggedInView=function(t){t?z=g:z=y,e.resizePanel()};var Ot=function(){mt.empty(),Tt.addClass("show"),C={},k=[]},Mt=function(e){X=new s("listResults",V),e==="asc"?X.sort("releaseDate",{sortFunction:tn}):X.sort("releaseDate",{sortFunction:nn})},_t=function(t,n,r,i){i=typeof i!="undefined"?i:null,i&&Dt(i),r===B&&e.renderListResults(t,n)},Dt=function(e){var t={};typeof e!="undefined"&&e?r.each(e,function(e,n){t[n]="("+e+") "}):t={all:"",pc:"",x360:"",xbl:"",ps3:"",psn:"",vita:"",ds:"","3ds":"",wii:"",wiiu:""},tt.html(Lt({found:t}))},Pt=function(t,r){var i=!1,s={},o={};n("Item",t).each(function(){o=u.parseAmazonResultItem(n(this)),typeof o.isFiltered=="undefined"&&(s[o.id]=o)}),n.extend(!0,C,s),T===r&&e.renderSearchResults(C)},Ht=function(t,r){var i=t.results,s={},o={};for(var u=0,f=i.length;u<f;u++)o=a.parseGiantBombResultItem(i[u]),a.getGiantBombItemPlatform(o.gbombID,Bt),s[o.id]=o;n.extend(!0,C,s),T===r&&e.renderSearchResults(C)},Bt=function(t,n){var r=t.results.platforms,i=[],s="";for(var o=0,u=r.length;o<u;o++)s=f.matchPlatformToIndex(r[o].name).name||r[o].name,i.push(s);jt(n,i);var a=e.getSearchResult(n);a&&(a.platformList=i,a.platform=i[0])},jt=function(e,t){var r={platformList:t,gbombID:e};n("#"+e).find(".platformDropdown").html(At(r))},Ft=function(e,t){var n=Date.parse(e.releaseDate),r=Date.parse(t.releaseDate);return r-n};e.getSearchResult=function(e){return C[e]};var It=function(e){switch(e){case 0:dt.nanoScroller({scrollTop:q-1}),Xt(!0),Vt(!1);break;case 1:yt.nanoScroller({scrollTop:parseInt(j-1,10)}),Vt(!0),Xt(!1),qt()}},qt=function(){var e=parseInt(K.attr("data-content"),10);if(e!==B){switch(e){case 0:$t(I),xt.find("button:eq("+I+")").button("toggle"),xt.fadeTo(100,1),Q.text("Popular"),B=p.POPULAR;break;case 1:$t(I),xt.find("button:eq("+I+")").button("toggle"),xt.fadeTo(100,1),Q.text("Upcoming"),B=p.UPCOMING;break;case 2:$t(I),xt.find("button:eq("+I+")").button("toggle"),xt.fadeTo(100,1),Q.text("Released"),B=p.RELEASED;break;case 3:$t(I),xt.find("button:eq("+I+")").button("toggle"),xt.fadeTo(100,1),Q.text("Reviewed"),B=p.REVIEWED}Wt(B)}},Rt=function(e,t){rt.text(t),F=f.getStandardPlatform(e),Wt(B)},Ut=function(t,n){N="",nt.text(n),R=f.getStandardPlatform(t),e.search(T)},zt=function(e){switch(e){case 0:at.tab("show");break;case 1:ft.tab("show")}},Wt=function(t){function n(){rt.text(rt.text().split(" (")[0])}A=!1,P=!1,D=!1,H=!1,O=-1,M=-1,_=-1,Dt(),Nt.addClass("show"),Et.empty();switch(t){case p.POPULAR:n(),e.getIGNPopularList(F,0);break;case p.UPCOMING:n(),e.getIGNUpcomingList(F,0);break;case p.RELEASED:e.getGTReleasedList(F);break;case p.REVIEWED:e.getIGNReviewedList(F,0)}},Xt=function(e){e?(St.show(),G.show()):(St.hide(),G.hide())},Vt=function(e){e?(xt.show(),et.show(),K.show()):(xt.hide(),et.hide(),K.hide())},$t=function(e,t,n){t=typeof t!="undefined"?t:!1,n&&n.addClass("active").siblings().removeClass("active"),L===d["#searchTab"]?(U=e,mt.find("tbody").removeClass().addClass("display-"+e)):wt.find("tbody").hasClass("display-"+e)===!1&&(t||(I=e),yt.find(".content").removeClass("display-0").removeClass("display-1").removeClass("display-2").addClass("display-"+e))},Jt=function(){clearTimeout(x),e.search(T)},Kt=function(t){T=gt.val(),T!==N&&Ot(),x&&clearTimeout(x),t.which==13?e.search(T):x=setTimeout(Jt,v)},Qt=function(){var t=e.getSearchResult(n(this).attr("id"));o.viewFirstSearchItemDetail(t)},Gt=function(){en(),T=h.standardizeTitle(n(this).find(".itemName").text()),zt(d["#searchTab"]),gt.val(T),Ut(F.id,F.name),e.search(T)},Yt=function(t){var r=e.getSearchResult(n(t).attr("data-content"));r.platform=n(t).find("a").text(),n(t).parent().siblings(".dropdown-toggle").html(r.platform).append('<b class="caret"></b>')},Zt=function(e){e?(pt.show(),ht.addClass("hover")):(pt.hide(),ht.removeClass("hover"))},en=function(){L===d["#searchTab"]?q=vt.scrollTop()||1:L===d["#listTab"]&&(j=bt.scrollTop()||1)},tn=function(e,t){var r=n(e.elm).find(".releaseDate"),i=n(t.elm).find(".releaseDate"),s=Date.parse(r.text()),o=Date.parse(i.text());return s-o},nn=function(e,t){var r=n(e.elm).find(".releaseDate"),i=n(t.elm).find(".releaseDate"),s=Date.parse(r.text()),o=Date.parse(i.text());return o-s}}(gamedex.module("searchView"),gamedex,jQuery,_,moment,List),function(e,t,n,r,i){var s=t.module("user"),o=t.module("tagView"),u=t.module("utilities"),a=t.module("searchView"),f=t.module("itemView"),l=t.module("itemData"),c=t.module("amazon"),h=t.module("itemLinker"),p=t.module("metacritic"),d=t.module("giantbomb"),v=t.module("wikipedia"),m=t.module("gameTrailers"),g=t.module("steam"),y=t.module("videoPanel"),b=["#amazonTab","#giantBombTab"],w={0:"None",1:"Own",2:"Sold",3:"Wanted"},E={0:"Not Started",1:"Playing",2:"Played",3:"Finished"},S={NEW:0,EXISTING:1},x=!1,T=null,N=null,C=b[0],k=null,L=!1,A=S.NEW,O=null,M={},_={},D={},P=null,H=null,B=n("#detailTabContent"),j=n("#amazonTab"),F=n("#giantBombTab"),I=n("#amazonTabLink"),q=n("#giantBombTabLink"),R=j.find(".itemDetailThumbnail"),U=F.find(".itemDetailThumbnail"),z=R.find(".itemDetailInfo"),W=U.find(".itemDetailInfo"),X=B.find(".showVideo_btn"),V=B.find(".showDiscussion_btn"),$=n("#detailContainer"),J=n("#addListContainer"),K=n("#addList"),Q=n("#saveItem_btn"),G=n("#addItem_btn"),Y=n("#itemAttributes"),Z=n("#platform"),et=n("#releaseDate"),tt=n("#wikipediaPage"),nt=n("#gametrailersPage"),rt=n("#giantBombPage"),it=n("#metacriticPage"),st=Y.find("#priceHeader"),ot=Y.find("#amazonPriceNew"),ut=Y.find("#amazonPriceUsed"),at=Y.find("#steamPrice"),ft=n("#gameStatus"),lt=n("#playStatus"),ct=n("#userRating"),ht=n("#ratingCaption"),pt=r.template(n("#description-modal-template").html());e.init=function(){e.createEventHandlers(),Q.hide(),Y.hide(),Dt(),ct.stars({split:2,captionEl:ht,callback:function(e,t,n){M.userRating=n,Ut(M)}})},e.createEventHandlers=function(){Z.click(function(e){e.preventDefault()}),et.click(function(e){e.preventDefault()}),I.click(function(e){e.preventDefault(),e.stopPropagation(),_t(u.SEARCH_PROVIDERS.Amazon)}),q.click(function(e){e.preventDefault(),e.stopPropagation(),_t(u.SEARCH_PROVIDERS.GiantBomb)}),X.click(function(e){e.preventDefault(),L&&y.showVideoPanel()}),V.click(function(e){e.preventDefault(),bt()}),R.click(function(e){}),U.click(function(e){}),Q.click(function(e){e.preventDefault(),qt(M)}),G.click(function(e){e.preventDefault(),qt(M)}),ft.find("li a").click(function(e){e.preventDefault(),M.gameStatus=n(this).attr("data-content"),ft.find(".currentSelection").text(w[M.gameStatus]),Ut(M)}),lt.find("li a").click(function(e){e.preventDefault(),M.playStatus=n(this).attr("data-content"),lt.find(".currentSelection").text(E[M.playStatus]),Ut(M)}),n('#detailTab a[data-toggle="tab"]').on("shown",function(e){C=n(e.target).attr("href")}),K.change($t)},e.viewFirstSearchItemDetail=function(e){if(e.id!==M.id||e.platform!==M.platform)Mt(),Dt(),M=n.extend(!0,{},e),T=Ht(M.asin,M.gbombID),M.initialProvider=T,M.standardName=h.standardizeTitle(M.name),D=l.getItemByThirdPartyID(M.gbombID,M.asin),k=M.id,Pt(T),_t(T),h.findItemOnAlternateProvider(M,T,!0,function(e){return function(t){vt(t,e)}}(k),function(){}),jt(M,D),Ft(M,D),dt(M,!0),mt(M,T,0)},e.viewItemDetail=function(t){Mt(),Dt(),Bt(S.EXISTING),M=n.extend(!0,{},t),M.standardName=h.standardizeTitle(M.name),T=parseInt(M.initialProvider,10),D=l.getDirectoryItemByItemID(M.itemID),k=M.id,Pt(T),_t(T),h.getLinkedItemData(M,T,e.viewSecondItemDetail),o.selectTagsFromDirectory(D.tags),Ft(M,D),dt(M,!1),gt(M,T,0,t)},e.viewSecondItemDetail=function(e){_=n.extend(!0,{},e);var t=null;if(M.asin==_.asin||M.gbombID==_.gbombID)t=Ht(_.asin,_.gbombID),gt(_,t,1)},e.resetDetail=function(e){o.resetAddList(),Bt(S.NEW)},e.getViewingItemID=function(){return M.id};var dt=function(e,t){v.getWikipediaPage(e.standardName,e,Tt),xt(e.standardName,e,t),m.getGametrailersPage(e.standardName,e,Nt),g.getSteamGame(e.standardName,e,Ct)},vt=function(e,t){_=n.extend(!0,{},e);if(k===t){var r=Ht(_.asin,_.gbombID);switch(r){case u.SEARCH_PROVIDERS.Amazon:M.asin=_.asin;break;case u.SEARCH_PROVIDERS.GiantBomb:M.gbombID=_.gbombID}mt(_,r,1)}},mt=function(e,t,n){Et(t,e),wt(e,n),kt(t,M)},gt=function(e,t,n,r){Et(t,e),wt(M,n),kt(t,M)},yt=function(e,t){t.find(".itemDetailTitle h3").text(e.name),t.find("img").attr("src",e.largeImage)},bt=function(){f.viewDiscussion();var e=M.standardName;DISQUS.reset({reload:!0,config:function(){this.page.identifier=e,this.page.url="http://www.gamedex.net/#!"+e}})},wt=function(e,t){Y.is(":visible")||Y.fadeIn(),(e.platform!=="n/a"||t===0)&&Z.find(".data").text(e.platform);if(e.releaseDate!=="1900-01-01"){if(t===0||M.releaseDate==="1900-01-01")M.releaseDate=e.releaseDate,M.calendarDate=i(e.releaseDate,"YYYY-MM-DD").calendar(),et.find(".data").text(M.calendarDate)}else M.releaseDate==="1900-01-01"&&et.find(".data").text("unknown")},Et=function(e,t){x||(n("#dataTab").show(),n(".detailTitleBar").show(),x=!0);switch(e){case u.SEARCH_PROVIDERS.Amazon:yt(t,j);break;case u.SEARCH_PROVIDERS.GiantBomb:yt(t,F)}},St=function(e){e.find(".itemDetailTitle h3").text("No Match found"),e.find("img").attr("src","http://d2sifwlm28j6up.cloudfront.net/no_selection_placeholder.png")},xt=function(e,t,r){function u(e){if(k===e.id||k===e.asin||k===e.gbombID)for(var t=0,n=b.length;t<n;t++)i=b[t]+" .metascore",p.displayMetascoreData(e.metascorePage,e.metascore,i),it.show(),it.find("a").attr("href","http://www.metacritic.com"+e.metascorePage)}var i="";for(var s=0,o=b.length;s<o;s++)i=b[s]+" .metascore",n(i).hide();P=p.getMetascore(e,t,r,u)},Tt=function(e){tt.show(),tt.find("a").attr("href",e)},Nt=function(e){nt.show(),nt.find("a").attr("href",e)},Ct=function(e){e.steamPrice!==""?(st.show(),at.find(".data").text(e.steamPrice),at.find("a").attr("href",e.steamPage),at.show()):at.hide()},kt=function(e,t){switch(e){case u.SEARCH_PROVIDERS.Amazon:c.getAmazonItemOffers(t.asin,t,Lt);break;case u.SEARCH_PROVIDERS.GiantBomb:d.getGiantBombItemData(t.gbombID,At)}},Lt=function(e){(r.has(e,"buyNowPrice")&&e.buyNowPrice!==""||r.has(e,"lowestUsedPrice")&&e.lowestUsedPrice!=="")&&st.show(),r.has(e,"buyNowPrice")&&e.buyNowPrice!==""?(ot.find("a").attr("href",e.productURL),ot.find(".data").text(e.buyNowPrice),ot.show()):ot.hide(),r.has(e,"lowestUsedPrice")&&e.lowestUsedPrice!==""?(ut.find(".data").text(e.lowestUsedPrice),ut.find("a").attr("href",e.offersURLUsed),ut.show()):ut.hide()},At=function(e){rt.show(),rt.find("a").attr("href",e.site_detail_url),Ot(e.videos,M.name)},Ot=function(e,t){e.length!==0&&(y.renderVideoModal(e,t),L=!0,X.removeClass("noVideos"),X.find("span").text("Show Videos"))},Mt=function(e){L=!1,X.addClass("noVideos"),X.find("span").text("No Videos")},_t=function(e){switch(e){case u.SEARCH_PROVIDERS.Amazon:N=e,z.append($),I.tab("show");break;case u.SEARCH_PROVIDERS.GiantBomb:N=e,W.append($),q.tab("show")}},Dt=function(){tt.hide(),rt.hide(),it.hide(),st.hide(),ot.hide(),ut.hide(),at.hide()},Pt=function(e){switch(e){case u.SEARCH_PROVIDERS.Amazon:St(F);break;case u.SEARCH_PROVIDERS.GiantBomb:St(j)}},Ht=function(e,t){var n=null;return e!==0?n=u.SEARCH_PROVIDERS.Amazon:t!==0&&(n=u.SEARCH_PROVIDERS.GiantBomb),n},Bt=function(e){e===S.EXISTING?(A=S.EXISTING,G.hide(),Q.hide()):e===S.NEW&&(A=S.NEW,Q.hide(),G.show())},jt=function(e,t){t&&t.tagCount>0?(Bt(S.EXISTING),e.itemID=t.itemID,o.selectTagsFromDirectory(t.tags)):(Bt(S.NEW),o.selectUserTags())},Ft=function(e,t){t?(e.gameStatus=t.gameStatus,e.playStatus=t.playStatus,e.userRating=t.userRating):(e.gameStatus="0",e.playStatus="0",e.userRating="0"),It(e)},It=function(e){ft.find(".currentSelection").text(w[e.gameStatus]),lt.find(".currentSelection").text(E[e.playStatus]),ct.stars("select",e.userRating),ht.text(e.userRating/2),ft.find(".currentSelection").attr("data-initial",e.gameStatus),lt.find(".currentSelection").attr("data-initial",e.playStatus),ct.attr("data-initial",e.userRating)},qt=function(e){var t=o.getTagsToAdd(),n=o.getTagsToDelete(),r=n.idsToDelete,i=n.tagsToDelete;t.length>0&&(N!==T&&(N==u.SEARCH_PROVIDERS.Amazon&&e.asin!==0||N==u.SEARCH_PROVIDERS.GiantBomb&&e.gbombID!==0)&&(e.initialProvider=N,e.largeImage=_.largeImage,e.smallImage=_.smallImage,e.thumbnailImage=_.thumbnailImage),console.info(e),H=l.addItemToTags(t,e,Wt)),r.length>0&&l.deleteTagsForItem(r,i,e,Xt),Rt(e),Jt()},Rt=function(e){(r.isUndefined(e.metascore)||e.metascore===null)&&n.when(P,H).then(function(){l.updateMetacritic(M),f.refreshView()},function(){}),(T!==u.SEARCH_PROVIDERS.Amazon||e.gbombID!==0)&&T===u.SEARCH_PROVIDERS.Amazon&&e.asin===0},Ut=function(e){Vt()&&A===S.EXISTING&&l.updateUserItem(e,zt)},zt=function(e,t){t.status==="success"&&(It(e),f.updateListAttributesChanged(e))},Wt=function(e,t){A!==S.EXISTING&&Bt(S.EXISTING),f.updateListAdditions(e,t)},Xt=function(e,t){f.updateListDeletions(e,t)},Vt=function(){var e=ft.find(".currentSelection").attr("data-initial"),t=lt.find(".currentSelection").attr("data-initial"),n=ct.attr("data-initial");return e!==M.gameStatus||t!==M.playStatus||n!==M.userRating?!0:!1},$t=function(e){x&&!e.reset&&(A===S.NEW&&o.updateUserTags(),Jt())},Jt=function(){A===S.EXISTING&&o.isAddListChanged()?Q.fadeIn():Q.fadeOut()}}(gamedex.module("detailView"),gamedex,jQuery,_,moment),function(e,t,n,r,i){"use strict";var s=t.module("user"),o=t.module("siteView"),u=t.module("tagView"),a=t.module("utilities"),f=t.module("detailView"),l=t.module("importView"),c=t.module("gridView"),h=t.module("itemData"),p=t.module("itemCache"),d=t.module("tagData"),v=t.module("amazon"),m=t.module("metacritic"),g=t.module("itemLinker"),y=t.module("filterPanel"),b=t.module("giantbomb"),w=t.module("steam"),E={List:0,Icons:1},S={collection:"collection",discussion:"discussion"},x={alphabetical:0,metascore:1,releaseDate:2,platform:3,price:4},T=230,N=460,C=10,k=50,L=5,A=10,O="0",M="View All",_=null,D={valueNames:["itemName","metascore","releaseDate","platform","gameStatus","playStatus","userRating"],item:"list-item"},P=O,H=E.Icons,B=0,j=!1,F=!1,I=null,q=!1,R=N,U=!1,z=S.collection,W=n("#wrapper"),X=n("#itemResults tbody"),V=n("#resizeContainer"),$=n("#viewItemsContainer"),J=n("#itemResultsContainer"),K=$.find(".displayOptions"),Q=n("#gridView_btn"),G=n("#showCollection_btn"),Y=n("#viewList"),Z=Y.find(".viewName"),et=n("#itemViewMenu"),tt=n("#editMenu"),nt=$.find(".sortOptions"),rt=nt.find(".sortType"),it=$.find(".filterOptions"),st=n("#platformFilterSubNav"),ot=it.find(".clearFilters_btn"),ut=it.find(".filterDropDown_btn"),at=it.find(".filterType"),ft=n("#applyFilters_btn"),lt=n("#deleteListConfirm-modal"),ct=n("#deleteListConfirm_btn"),ht=n("#deleteList_btn"),pt=ht.find(".listName"),dt=n("#importMenu"),vt=n("#error-modal"),mt=n("#updateList-modal"),gt=n("#tagNameField"),yt=n("#updateListConfirm_btn"),bt=n("#editList_btn"),wt=J.find(".loadingStatus"),Et=null,St=r.template(n("#price-menu-template").html()),xt=r.template(n("#steam-price-menu-template").html()),Tt=r.template(n("#item-results-template").html()),Nt=function(){Ct(),ut.tooltip({delay:{show:500,hide:50}}),K.find("button").each(function(e,t){n(t).tooltip({delay:{show:500,hide:50},placement:"bottom"})});var e={sliderMinHeight:20,iOSNativeScrolling:!0,preventPageScrolling:!0,flash:!0,flashDelay:1500};J.nanoScroller(e),setInterval(function(){J.nanoScroller()},1500),hn(!1),st.BootstrapSubMenu({$mainNav:it})},Ct=function(){et.on("mouseenter",".dropdown-toggle",function(e){var t=this;et.find(".dropdown").each(function(){n(this).hasClass("open")&&n(this).find(".dropdown-toggle").get(0)!==n(t).get(0)&&n(t).trigger("click")})}),Y.find("ul").on("click","a",function(e){e.preventDefault(),Wt(n(this).attr("data-content"))}),ft.click(function(e){e.preventDefault(),W.hasClass("gridView")||(hn(!0),cn(0))}),ot.click(function(e){e.preventDefault(),hn(!1),at.text("None"),y.resetFilters(),cn()}),$.on("click","#itemResults tr",function(e){en(n(this).attr("id"))}),X.on("click",".deleteItem_btn",function(e){e.preventDefault();var t=n(this).attr("data-content");tn(t)}),X.on("click",".quickAttributes a",function(e){e.preventDefault(),e.stopPropagation();var t=parseInt(n(this).attr("data-content"),10),r=n(this).parent().parent().attr("data-content");an(n(this),r,t)}),ht.click(function(e){e.preventDefault(),o.hideSiteGuide(),u.getTagCount()>1?lt.modal("show"):(vt.find(".alertTitle").text("Tag Delete Error"),vt.find(".alertText").text("Cannot delete last tag"),vt.modal("show"))}),ct.click(function(e){e.preventDefault(),lt.modal("hide"),rn(P)}),mt.find("form").submit(function(e){e.preventDefault(),on(P,gt.val()),mt.modal("hide")}),yt.click(function(e){e.preventDefault(),on(P,gt.val()),mt.modal("hide")}),bt.click(function(e){e.preventDefault(),o.hideSiteGuide();var t=u.getTagName(P);gt.val(t),mt.modal("show"),r.delay(function(){gt.focus().select()},1e3)}),dt.find("li").click(function(e){e.preventDefault(),o.hideSiteGuide(),l.startImport(parseInt(n(this).attr("data-importSource"),10))}),K.find("button").click(function(e){e.preventDefault(),gn(n(this))}),nt.find("li a").click(function(e){e.preventDefault(),pn(parseInt(n(this).attr("data-content"),10))}),it.find("li:not(.dropdown-sub) a").click(function(e){e.preventDefault(),I=n(this).attr("data-content"),I=="0"?(o.hideSiteGuide(),y.showFilterPanel()):(hn(!0),at.text(n(this).text()),ln(I))}),Q.click(function(e){e.preventDefault(),o.hideSiteGuide(),zt()}),G.click(function(e){e.preventDefault(),Rt()}),V.resize(_t),n(window).resize(_t)},kt=function(e){Mt();var t=0,i=500,s=25,o=0,u=[];X.addClass("list display-"+H),r.each(e,function(e,a){$t(e),t++,u.push(e),t%s===0&&(function(e,t,n){r.delay(function(){console.info("@@@@@@@@@@@@@@@@@@"),console.info(e,t),Lt(t,n),t=[]},i*o)}(t,n.extend(!0,{},u),P),o++,u=[])}),r.delay(function(){console.info("************************"),console.info(t,u),Lt(u,P),u=[],At(e,t)},i*o)},Lt=function(e,t){if(t===P){var n={items:e,length:length};n.currentViewTagID=P,X.append(Tt(n))}else console.info("################ TAG MISMATCH!!! ###############")},At=function(e,t){t>0&&(X.find(".quickAttributes a").each(function(e,t){n(t).tooltip({delay:{show:750,hide:1},placement:"bottom"})}),r.each(e,function(e,t){Gt(e)}),r.each(e,function(e,t){Vt(e)}),_=new i("itemResultsContainer",D),pn(B),cn(),j=!1)},Ot=function(e){return h.getItem(e)},Mt=function(){X.empty()},_t=function(){var e=n(window).height(),t=V.height(),r=0,i=0;wt.is(":visible")&&(t+=wt.height()),z===S.discussion&&(r=k,i=C);if(t-r<e-R)J.css({height:t+L+i});else{var s=e-R;J.css({height:s+A+r})}},Dt=function(e){e?R=T:R=N,_t()},Pt=function(e,t){return P=O,h.getItems(O,e,t)},Ht=function(e){h.itemsAndDirectoryLoaded(e),Wt(O),n.isEmptyObject(e)?f.resetDetail():Zt()},Bt=function(e,t){var r=null;for(var i=0,s=t.length;i<s;i++)P===O?(r=h.getDirectoryItemByItemID(e).tagCount,r===0&&n("#"+e).remove()):P===t[i]&&n("#"+e).remove()},jt=function(e,t){var n=!1;u.updateViewList(e.tagIDsAdded,P);if(P!==O)for(var r=0,i=e.tagIDsAdded.length;r<i;r++)e.tagIDsAdded[r]==P&&(n=!0);else h.getDirectoryItemByItemID(e.itemID).tagCount>=1&&(n=!0);n&&Wt(P)},Ft=function(e){F=!0},It=function(e,t,n,r){I=t,Wt(e),at.text(n),hn(r)},qt=function(){z=S.discussion,$.removeClass().addClass(z)},Rt=function(){z=S.collection,$.removeClass().addClass(z)},Ut=function(){Xt(P)},zt=function(){c.showGridView(P,I,at.text(),U)},Wt=function(e){var t="";e!==O?(t=u.getTagName(e),pt.text(t),tt.show()):(t=M,tt.hide()),Z.text(t),Xt(e)},Xt=function(e,t){P=e,h.getItems(e,function(e){kt(e),t&&t()},function(){kt({})})},Vt=function(e){typeof Vt.getAmazonItemOffersLimited=="undefined"&&(Vt.getAmazonItemOffersLimited=function(e){v.getAmazonItemOffers(e.asin,e,function(t){Jt(e.id,e,t),h.updateSharedItemPrice(e,a.PRICE_PROVIDERS.Amazon,function(e){console.info("############# update amazon price")})})}.lazy(250,2e3)),r.isUndefined(e.offers)||r.keys(e.offers).length===0?(console.info("download amazon",e.name),Vt.getAmazonItemOffersLimited(e)):(console.info("use existing offers",e.offers),Jt(e.id,e,e.offers)),r.isUndefined(e.steamPrice)?(console.info("download steam",e.name),w.getSteamGame(e.standardName,e,function(t){Kt(e.id,e,t),h.updateSharedItemPrice(e,a.PRICE_PROVIDERS.Steam,function(e){console.info("############ update steam price")})},function(){h.updateSharedItemPrice(e,a.PRICE_PROVIDERS.Steam,function(e){console.info("############ update steam price - no result")})})):(console.info("use existing steam",e.steamPrice,e.steamPage),Kt(e.id,e,e));if(e.metascore===null||e.metascorePage===null||e.metascorePage==="")console.info("^^^^^^^^^^^^^ GET META SCORE"),m.getMetascore(e.standardName,e,!1,Yt)},$t=function(e){var t=h.getDirectoryItemByItemID(e.itemID);t&&(e.gameStatus=t.gameStatus,e.playStatus=t.playStatus,e.userRating=t.userRating)},Jt=function(e,t,i){if(typeof i.productURL!="undefined"){r.isUndefined(i.lowestNewPrice)&&(i.lowestNewPrice=""),r.isUndefined(i.lowestUsedPrice)&&(i.lowestUsedPrice="");var s="#"+e+" .priceDetails",o=Qt(t);o=="amazon"&&n(s).html(St(i))}},Kt=function(e,t,r){if(r.steamPrice!==""){var i="#"+e+" .priceDetails",s=Qt(t);s=="steam"&&(r.steamPageDisplay=r.steamPage.split(".com")[1].split("?")[0],n(i).html(xt(r)))}},Qt=function(e){var t=9999,n=9999,i=9999,s=9999,o="amazon";return r.isUndefined(e.offers)||(r.isUndefined(e.offers.buyNowPrice)||(t=parseFloat(e.offers.buyNowPrice),i=t),r.isUndefined(e.offers.lowestNewPrice)||(n=parseFloat(e.offers.lowestNewPrice))),r.isUndefined(e.steamPrice)||(s=parseFloat(e.steamPrice)),n<t&&(i=n),s<i&&(o="steam"),o},Gt=function(e){e.metascore===-1?e.displayMetascore="n/a":e.displayMetascore=e.metascore,Yt(e)},Yt=function(e){var t="#"+e.id+" .metascore";m.displayMetascoreData(e.metascorePage,e.metascore,t)},Zt=function(){var e=h.getRandomItemID();en(e)},en=function(e){var t=Ot(e);f.viewItemDetail(t)},tn=function(e){var t=h.deleteSingleTagForItem(e,P,nn);f.getViewingItemID()===e&&u.removeTagFromAddList(P),n("#"+e).remove()},nn=function(e){},rn=function(e){u.deleteTag(e,function(){sn()})},sn=function(){Wt(O)},on=function(e,t){d.updateTag(t,e,function(e){}),u.getTags(function(e){u.getTags_result(e)}),un(t,e)},un=function(e,t){Z.text(e),gt.val(e)},an=function(e,t,n){var r=Ot(t);F=!0;switch(n){case 0:r.playStatus==="1"?(fn(e,"0"),e.parent().removeClass().addClass("playStatus-0"),r.playStatus="0"):(fn(e,"1"),e.parent().removeClass().addClass("playStatus-1"),r.playStatus="1");break;case 1:r.playStatus==="2"?(fn(e,"0"),e.parent().removeClass().addClass("playStatus-0"),r.playStatus="0"):(fn(e,"2"),e.parent().removeClass().addClass("playStatus-2"),r.playStatus="2");break;case 2:r.playStatus==="3"?(fn(e,"0"),e.parent().removeClass().addClass("playStatus-0"),r.playStatus="0"):(fn(e,"3"),e.parent().removeClass().addClass("playStatus-3"),r.playStatus="3");break;case 3:r.userRating==="10"?(e.parent().removeClass("rating-10"),r.userRating="0"):(e.parent().removeClass().addClass("rating-10"),r.userRating="10");break;case 4:r.gameStatus==="1"?(e.parent().removeClass().addClass("gameStatus-0"),r.gameStatus="0"):(e.parent().removeClass().addClass("gameStatus-1"),r.gameStatus="1")}h.updateUserItem(r,function(e,t){f.viewItemDetail(e)})},fn=function(e,t){e.parent().parent().find('span[class*="playStatus"]').each(function(){n(this).removeClass().addClass("playStatus-"+t)})},ln=function(e){var t=parseInt(e,10);y.resetFilters();if(isNaN(e))y.platformQuickFilter(e);else switch(t){case 1:pn(x.releaseDate),y.upcomingQuickFilter(_);break;case 2:pn(x.releaseDate),y.newReleasesQuickFilter(_);break;case 3:pn(x.metascore),y.neverPlayedQuickFilter(_);break;case 4:pn(x.metascore),y.gamesPlayingQuickFilter(_);break;case 5:pn(x.metascore),y.gamesPlayedQuickFilter(_);break;case 6:pn(x.metascore),y.finishedGamesQuickFilter(_);break;case 7:pn(x.metascore),y.ownedGamesQuickFilter(_);break;case 8:pn(x.metascore),y.wantedGamesQuickFilter(_)}cn(t)},cn=function(e){e===0&&at.text("Custom");if(F)F=!1,Wt(P,function(){var e=y.applyListJSFiltering(_)});else var t=y.applyListJSFiltering(_)},hn=function(e){U=e,e?(ot.show(),ot.next().show()):(ot.hide(),ot.next().hide())},pn=function(e){B=e;switch(B){case x.alphabetical:rt.text("Alphabetical"),_.sort("itemName",{asc:!0});break;case x.metascore:rt.text("Review Score"),_.sort("scoreDetails",{sortFunction:dn});break;case x.releaseDate:rt.text("Release Date"),_.sort("releaseDate",{sortFunction:mn});break;case x.platform:rt.text("Platform"),_.sort("platform",{asc:!0});break;case x.price:rt.text("Price"),_.sort("priceDetails",{sortFunction:vn})}},dn=function(e,t){var r=n(e.elm).find(".metascore"),i=n(t.elm).find(".metascore"),s=parseInt(r.attr("data-score"),10),o=parseInt(i.attr("data-score"),10);return s<o?1:-1},vn=function(e,t){var r=n(e.elm).find(".priceDetails .lowestNew"),i=n(t.elm).find(".priceDetails .lowestNew"),s=0,o=0;return r.length>0&&(s=parseFloat(r.attr("data-price"))),i.length>0&&(o=parseFloat(i.attr("data-price"))),s<o?-1:1},mn=function(e,t){var r=n(e.elm).find(".releaseDate"),i=n(t.elm).find(".releaseDate"),s=Date.parse(r.text()),o=Date.parse(i.text());return o-s},gn=function(e){e.addClass("active").siblings().removeClass("active");var t=e.attr("data-content");H!==t&&(H=t,X.removeClass().addClass("list display-"+H),J.nanoScroller())},yn={init:Nt,createEventHandlers:Ct,getItem:Ot,clearItemView:Mt,resizePanel:_t,loggedInView:Dt,initializeUserItems:Pt,initializeUserItems_result:Ht,updateListDeletions:Bt,updateListAdditions:jt,updateListAttributesChanged:Ft,showListView:It,viewDiscussion:qt,viewCollection:Rt,refreshView:Ut,showGridView:zt,viewRandomItem:Zt};n.extend(e,yn)}(gamedex.module("itemView"),gamedex,jQuery,_,List),function(e,t,n,r,i){"use strict";var s=t.module("detailView"),o=t.module("itemData"),u=t.module("itemView"),a=t.module("tagView"),f=t.module("amazon"),l=t.module("utilities"),c=t.module("filterPanel"),h=1,p={itemName:0,metacriticScore:1,releaseDate:2,platform:3,rawPrice:4},d=null,v=0,m=null,g=!0,y=null,b=!1,w=n("#panel4"),E=n("#wrapper"),S=n("#gridViewContainer"),x=n("#gridList"),T=x.find(".viewName"),N=n("#gridViewMenu"),C=w.find(".loadingStatus"),k=N.find(".grid_displayOptions"),L=k.find(".displayType"),A=N.find(".sortOptions"),O=A.find(".sortType"),M=N.find(".filterOptions"),_=M.find(".clearFilters_btn"),D=M.find(".filterType"),P=M.find(".filterDropDown_btn"),H=M.find(".listFilters_btn"),B=n("#applyFilters_btn"),j=n("#filters-modal"),F=r.template(n("#grid-results-template").html()),I={},q=!1,R=null;e.init=function(){U(),P.tooltip({delay:{show:500,hide:50},placement:"bottom"}),k.find("div").each(function(e,t){n(t).tooltip({delay:{show:500,hide:50},placement:"bottom"})}),ot(!1)};var U=function(e){N.on("mouseenter",".dropdown-toggle",function(e){var t=this;N.find(".dropdown").each(function(){n(this).hasClass("open")&&n(this).find(".dropdown-toggle").get(0)!==n(t).get(0)&&n(t).trigger("click")})}),n("#exitGridView_btn").click(function(e){e.preventDefault(),W()}),H.click(function(e){e.preventDefault(),j.modal("show")}),_.click(function(e){e.preventDefault(),ot(!1),D.text("None"),c.resetFilters(),Y()}),B.click(function(e){e.preventDefault(),Y(),ot(!0)}),x.find("ul").on("click","a",function(e){e.preventDefault(),X(n(this).attr("data-content"))}),S.on("click",".gridItem img",function(e){e.preventDefault(),Q(n(this).parent().parent().attr("data-content"))}),S.on("mouseover",".gridItem",function(e){e.preventDefault();var t=n(this),r=t.attr("data-content"),i=I[r];i||(i=t.width(),I[r]=i);var s=Math.round((i*1.2-i)/2);t.css({"z-index":"999",width:i*1.2+"px","-webkit-transition-timing-function":"cubic-bezier(0.01,0.53,0.00,1.00)","-webkit-transition-property":"top,left,width","-webkit-transition-duration":"1s"})}),S.on("mouseout",".gridItem",function(e){e.preventDefault();var t=n(this);t.css({"z-index":"",width:"","-webkit-transition-timing-function":"cubic-bezier(0.01,0.53,0.00,1.00)","-webkit-transition-property":"top,left,width","-webkit-transition-duration":"1s"})}),k.find("li a").click(function(e){e.preventDefault(),L.text(n(this).text()),ut(n(this).attr("data-content"))}),A.find("li a").click(function(e){e.preventDefault(),Z(n(this).attr("data-content"))}),M.find("li a").click(function(e){e.preventDefault(),y=parseInt(n(this).attr("data-content"),10),y===0?c.showFilterPanel():(ot(!0),D.text(n(this).text()),G(parseInt(n(this).attr("data-content"),10)))})};e.showGridView=function(e,t,n,r){i.success("Loading Grid View images"),C.addClass("show"),E.removeClass("standardView"),E.addClass("gridView"),y=t,z(e),V(e),D.text(n),ot(r)},e.exitGridView=function(){E.removeClass("gridView"),E.addClass("standardView")};var z=function(e){var t=x.find('a[data-content="'+e+'"]');x.find(".viewName").text(t.text())},W=function(){e.exitGridView(),u.showListView(d,y,D.text(),b)},X=function(e){d=e,z(e),V(e)},V=function(e){d=e,S.hide(),q&&S.isotope("destroy"),o.getItems(e,$)},$=function(e){J(e)},J=function(e){var t={items:e};S.html(F(t)),K(),S.imagesLoaded(function(){C.removeClass("show"),S.show(),K(),Y()})},K=function(){q=!0,S.isotope({itemSelector:".gridItem",getSortData:{itemName:et,releaseDate:tt,platform:nt,userRating:rt,metacriticScore:it,rawPrice:st},sortBy:"itemName",sortAscending:!0,transformsEnabled:!1})},Q=function(e){var t=o.getItem(e);s.viewItemDetail(t)},G=function(e){at();var t=parseInt(e,10);c.resetFilters();switch(t){case 1:c.upcomingQuickFilter(),O.text("Release Date"),m="releaseDate",g=!0;break;case 2:c.newReleasesQuickFilter(),O.text("Release Date"),m="releaseDate",g=!1;break;case 3:c.neverPlayedQuickFilter(),O.text("Review Score"),m="metacriticScore",g=!1;break;case 4:c.gamesPlayingQuickFilter(),O.text("Review Score"),m="metacriticScore",g=!1;break;case 5:c.gamesPlayedQuickFilter(),O.text("Review Score"),m="metacriticScore",g=!1;break;case 6:c.finishedGamesQuickFilter(),O.text("Review Score"),m="metacriticScore",g=!1;break;case 7:c.ownedGamesQuickFilter(),O.text("Review Score"),m="metacriticScore",g=!1;break;case 8:c.wantedGamesQuickFilter(),O.text("Review Score"),m="metacriticScore",g=!1}Y()},Y=function(){y===0&&D.text("Custom"),ot(c.applyIsotopeFiltering(S,m,g))},Z=function(e){at(),v=parseInt(e,10);switch(v){case p.itemName:O.text("Alphabetical"),m="itemName",S.isotope({sortBy:m,sortAscending:!0});break;case p.metacriticScore:O.text("Review Score"),m="metacriticScore",S.isotope({sortBy:m,sortAscending:!1});break;case p.releaseDate:O.text("Release Date"),m="releaseDate",S.isotope({sortBy:m,sortAscending:!1});break;case p.platform:O.text("Platform"),m="platform",S.isotope({sortBy:m,sortAscending:!0});break;case p.rawPrice:O.text("Price"),m="rawPrice",S.isotope({sortBy:m,sortAscending:!0})}},et=function(e){return e.find(".itemName").text()},tt=function(e){return e.find(".releaseDate").text()},nt=function(e){return e.find(".platform").text()},rt=function(e){return parseInt(e.find(".userRating").text(),10)},it=function(e){return parseInt(e.find(".metacriticScore").text(),10)},st=function(e){return parseInt(e.find(".rawPrice").text(),10)},ot=function(e){b=e,e?(_.show(),_.next().show()):(_.hide(),_.next().hide())},ut=function(e){at(),I={},R!==e&&(S.removeClass("display-"+R).addClass("display-"+e),R=e,S.isotope("reLayout",function(){}))},at=function(e){n(".gridItem").each(function(e,t){n(t).css({"z-index":"","-webkit-transition-property":""})})}}(gamedex.module("gridView"),gamedex,jQuery,_,alertify),function(e,t,n,r){"use strict";var i=t.module("user"),s=t.module("tagData"),o=t.module("itemData"),u=t.module("itemCache"),a=n("#addListContainer"),f=n("#addList"),l=n("#viewList"),c=n("#gridList"),h={},p={},d={},v={},m={},g={},y=[],b=r.template(n("#view-list-template").html()),w=function(){E()},E=function(){f.change(function(e){var t=f.val().split(","),n=t[t.length-1];n!==""&&O(n)})},S=function(e,t){return q(),s.getTags(e,t)},x=function(e){W(),X(e),T(),I()},T=function(){var e=[],t=[];r.each(p,function(t,n){e.push(t)}),r.each(d,function(e,n){t.push(e)}),e.sort(V);var n={orderedList:e,emptyList:t};l.find("ul").html(b(n)),c.find("ul").html(b(n))},N=function(e){return v[e]},C=function(){var e=0;return r.each(h,function(t){e++}),e},k=function(){var e=[],t=U();return r.each(t,function(t){r.has(g,t)||(g[t]="placeholder",e.push(t))}),e},L=function(){var e=[],t=[],n=U();return r.each(g,function(i,s){r.indexOf(n,s)===-1&&(delete g[s],t.push(s),e.push(i))}),{idsToDelete:e,tagsToDelete:t}},A=function(e,t){for(var n=0,r=t.length;n<r;n++)g[e[n]]=t[n]},O=function(e,t){if(!r.has(h,e))s.addTag(e,function(e){R(e),t&&t(e)});else if(t){var n={tagID:h[e].id,tagName:h[e].name};t(n)}},M=function(e,t){var n=u.getCachedItemsByTag(e);r.each(n,function(t,n){o.deleteClientItem(e,t.itemID),o.deleteTagFromDirectory(t.itemID,e)}),_(e),u.deleteCachedTag(e),s.deleteTag(e),S(function(e){x(e)}),t()},_=function(e){delete g[e],z(g)},D=function(e){g={};var t=null;r.each(e,function(e,t){g[t]=e}),z(e)},P=function(){y=f.val().split(",")},H=function(){g={},f.val(y).trigger({type:"change",reset:!1})},B=function(e,t){var n=!1;for(var r=0,i=e.length;r<i;r++)typeof m[e[r]]=="undefined"&&(m[e[r]]=!0,delete d[v[e[r]]],p[v[e[r]]]={id:e[r],name:v[e[r]]},n=!0);return n&&T(),n},j=function(){g={},y=[],f.val([""]).trigger({type:"change",reset:!0})},F=function(){var e=!1,t=U();return r.each(t,function(t){r.has(g,t)||(e=!0)}),r.each(g,function(n,i){r.indexOf(t,i)===-1&&(e=!0)}),e},I=function(){var e=[],t=[];r.each(h,function(n,r){e.push(n),t.push(n.name)}),e.sort(V),f.select2({tags:t,placeholder:"Type a tag name",allowClear:!0})},q=function(){h={},p={},d={},v={},m={},g={},y=[]},R=function(e){var t={name:e.tagName.toLowerCase(),id:e.tagID};h[t.name]=t,d[t.name]=t,v[t.id]=t.name,T(),I(),a.find(".select2-search-field input").focus()},U=function(){var e=f.val(),t=[];return e!==""&&r.each(e.split(","),function(e){r.has(h,e)?t.push(h[e].id):t.push(e)}),t},z=function(e){var t=[];r.each(e,function(e,n){var r=N(n);t.push(r)}),f.val(t).trigger({type:"change",reset:!1})},W=function(){var e=o.getItemDirectory();m={},r.each(e,function(e,t){r.each(e.tags,function(e,t){typeof m[t]=="undefined"&&(m[t]=!0)})})},X=function(e){var t={};for(var n=0,r=e.length;n<r;n++)t={},t.name=e[n].tagName.toLowerCase(),t.id=e[n].tagID,typeof m[t.id]!="undefined"?p[t.name]=t:d[t.name]=t,h[t.name]=t,v[t.id]=t.name},V=function(e,t){var n=e.name,r=t.name;return n.toLowerCase().localeCompare(r.toLowerCase())},$={init:w,getTags:S,getTags_result:x,renderViewLists:T,getTagName:N,getTagCount:C,getTagsToAdd:k,getTagsToDelete:L,updateInitialItemTags:A,addTag:O,deleteTag:M,removeTagFromAddList:_,selectTagsFromDirectory:D,updateUserTags:P,selectUserTags:H,updateViewList:B,resetAddList:j,isAddListChanged:F};n.extend(e,$)}(gamedex.module("tagView"),gamedex,jQuery,_),function(e,t,n,r,i){"use strict";var s=t.module("utilities"),o=n("#filters-modal"),u=n("#releaseDate_filter"),a=n("#gameStatus_filter"),f=n("#playStatus_filter"),l=n("#metascore_filter"),c=n("#platformFilterList");e.init=function(){e.createEventHandlers(),c.select2({placeholder:"Select platform",allowClear:!0})},e.createEventHandlers=function(){o.on("click",".btn-group button",function(e){e.preventDefault()})},e.showFilterPanel=function(){o.modal("show")},e.getFilters=function(){var e={};e.releaseDateFilters=[],e.metascoreFilters=[],e.platformFilters=[],e.gameStatusFilters=[],e.playStatusFilters=[],u.find("button").each(function(){n(this).hasClass("active")?e.releaseDateFilters.push(!0):e.releaseDateFilters.push(!1)}),l.find("button").each(function(){n(this).hasClass("active")?e.metascoreFilters.push(!0):e.metascoreFilters.push(!1)}),a.find("button").each(function(){n(this).hasClass("active")?e.gameStatusFilters.push(!0):e.gameStatusFilters.push(!1)}),f.find("button").each(function(){n(this).hasClass("active")?e.playStatusFilters.push(!0):e.playStatusFilters.push(!1)});var t=c.val(),i=[];return t&&t!==""&&(i=t.split(",")),r.each(i,function(t,n){e.platformFilters[n]=s.getStandardPlatform(t)}),e},e.applyListJSFiltering=function(t){var n=e.getFilters(),r=!1;return t.filter(function(t){var i=e.releaseDateFilter(t.values().releaseDate,n.releaseDateFilters),s=e.metascoreFilter(t.values().metascore,n.metascoreFilters),o=e.platformFilter(t.values().platform,n.platformFilters),u=e.gameStatusFilter(t.values().gameStatus,n.gameStatusFilters),a=e.playStatusFilter(t.values().playStatus,n.playStatusFilters);return i&&s&&o&&a&&u?!0:(r=!0,!1)}),r},e.applyIsotopeFiltering=function(t,r,i){var s=e.getFilters(),o=!1,u=n(".gridItem").filter(function(t){var r=n(this),i=r.find(".releaseDate").text(),u=e.releaseDateFilter(i,s.releaseDateFilters),a=r.find(".metacriticScore").text(),f=e.metascoreFilter(a,s.metascoreFilters),l=r.find(".platform .data").text(),c=e.platformFilter(l,s.platformFilters),h=r.find(".gameStatus").text(),p=e.gameStatusFilter(h,s.gameStatusFilters),d=r.find(".playStatus").text(),v=e.playStatusFilter(d,s.playStatusFilters);return u&&p&&v&&f&&c?!0:(o=!0,!1)});return t.isotope({filter:u,sortBy:r,sortAscending:i}),o},e.resetFilters=function(){u.find("button").each(function(){n(this).removeClass("active")}),l.find("button").each(function(){n(this).removeClass("active")}),a.find("button").each(function(){n(this).removeClass("active")}),f.find("button").each(function(){n(this).removeClass("active")}),c.val([""]).trigger("change")},e.upcomingQuickFilter=function(e){u.find('button[data-content="0"]').addClass("active")},e.newReleasesQuickFilter=function(e){u.find('button[data-content="1"]').addClass("active")},e.neverPlayedQuickFilter=function(e){f.find('button[data-content="0"]').addClass("active")},e.gamesPlayingQuickFilter=function(e){f.find('button[data-content="1"]').addClass("active")},e.gamesPlayedQuickFilter=function(e){f.find('button[data-content="2"]').addClass("active")},e.finishedGamesQuickFilter=function(e){f.find('button[data-content="3"]').addClass("active")},e.ownedGamesQuickFilter=function(e){a.find('button[data-content="1"]').addClass("active")},e.wantedGamesQuickFilter=function(e){a.find('button[data-content="3"]').addClass("active")},e.platformQuickFilter=function(e){c.val(e).trigger("change")},e.releaseDateFilter=function(e,t){var n=t[0],r=t[1],s=null;e==="1900-01-01"?s=i().add("days",1):s=i(e,"YYYY-MM-DD");var o=i(),u=s.diff(o,"seconds");return n&&r?!0:!n&&!r?!0:n&&u>0?!0:r&&u<0?!0:!1},e.gameStatusFilter=function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3];return n&&r&&i&&s?!0:!n&&!r&&!i&&!s?!0:n&&e==="0"?!0:r&&e==="1"?!0:i&&e==="2"?!0:s&&e==="3"?!0:!1},e.playStatusFilter=function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3];return n&&r&&i&&s?!0:!n&&!r&&!i&&!s?!0:n&&e==="0"?!0:r&&e==="1"?!0:i&&e==="2"?!0:s&&e==="3"?!0:!1},e.metascoreFilter=function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],u=t[5],a=t[6],f=parseInt(e,10);return n&&r&&i&&s&&o&&u&&a?!0:!n&&!r&&!i&&!s&&!o&&!u&&!a?!0:n&&f>=90?!0:r&&f>=80&&f<90?!0:i&&f>=70&&f<80?!0:s&&f>=60&&f<70?!0:o&&f>=50&&f<60?!0:u&&f>=25&&f<50?!0:a&&f>=0&&f<25?!0:!1},e.platformFilter=function(e,t){if(t.length===0)return!0;for(var n=0,r=t.length;n<r;n++)if(t[n].name===e)return!0;return!1}}(gamedex.module("filterPanel"),gamedex,$,_,moment),function(e,t,n,r,i,s){"use strict";var o="http://media.giantbomb.com/video/",u="videoPlayer",a=89,f=5,l=!1,c=0,h=null,p=0,d=0,v=0,m=[],g=null,y=r("#video-modal"),b=r("#videoListContainer"),w=r("#videoList"),E=r("#videoPlayer"),S=r("#videoModalTitle"),x=r("#videoListNavigation"),T=x.find(".navigateLeft"),N=x.find(".navigateRight"),C=x.find(".pageNumber"),k=i.template(r("#video-results-template").html());e.init=function(){g=t(u),e.createEventHandlers(),y.modal({backdrop:!0,show:!1})},e.createEventHandlers=function(){w.on("click","li",function(e){e.preventDefault();var t=r(this).attr("data-id");O(Number(t)),M()}),T.click(function(e){H()}),N.click(function(e){B()}),y.on("hidden",function(){_()}),g.addEvent("ended",A)},e.showVideoPanel=function(){l&&(l=!1,O(0)),y.modal("show"),M()},e.renderVideoModal=function(e,t){l=!0,m=r.extend(!0,[],e);if(m.length!==0){p=m.length,h=null,d=0,L(m);var n={videoResults:m};w.html(k(n)),S.text(t),c=0,F(0),w.find("a").popover({trigger:"hover",placement:"top",animation:!0}),P()}m.length<=f&&D()};var L=function(e){for(var t=0,n=e.length;t<n;t++){e[t].publishDate=s(e[t].publish_date,"YYYY-MM-DD").calendar(),delete e[t].publish_date;var r=Math.floor(e[t].length_seconds/60),i=(e[t].length_seconds%60).toString();i.length===1&&(i="0"+i),delete e[t].length_seconds,e[t].runningTime=r+":"+i}},A=function(){d===p-1?d=0:d++,O(d);if(d%f===0){var e=Math.floor(d/f);F(e)}M()},O=function(e){d=e;var t=m[e].url,n=w.find('li[data-id="'+e+'"]'),r=w.find('li[data-id="'+v+'"]');r.removeClass("playing"),n.addClass("playing");var i=t.split("."),s=o+i[0]+"_3500."+i[1];g.src(s),v=e},M=function(){g.play()},_=function(){g.pause()},D=function(){x.hide()},P=function(){x.show()},H=function(){var e=j();c>0?F(--c):F(e)},B=function(){var e=j();c<e?F(++c):F(0)},j=function(){return h||(h=Math.ceil(p/f)-1),h},F=function(e){var t=-(e*a);c=e,w.stop().animate({top:t},250,function(){}),C.text(Number(e+1)+" / "+Number(j()+1))}}(gamedex.module("videoPanel"),_V_,gamedex,jQuery,_,moment),function(e,t,n,r,i){"use strict";var s=t.module("user"),o=t.module("utilities"),u=t.module("itemData"),a=t.module("tagView"),f=t.module("itemView"),l=t.module("amazon"),c=t.module("metacritic"),h=t.module("itemLinker"),p=t.module("giantbomb"),d=["Steam","PSN","XBL"],v=["Steam ID","PSN ID","Gamertag"],m=["http://steamcommunity.com/id/[steam_id]/games/","http://us.playstation.com/mytrophies/","http://www.xboxgamertag.com/search/[gamer_tag]"],g=[["PC","Mac"],["PSN","PS3","Vita"],["Xbox","X360","XBL"]],y="http://d2sifwlm28j6up.cloudfront.net/no_match.png",b="Loading Data: ",w="Importing: ",E=0,S=0,x=0,T=0,N=0,C=0,k=null,L={},A=0,O=[],M=[],_=[],D=n("#importContainer"),P=n("#importResults"),H=n("#importResults tbody"),B=n("#startImport_btn"),j=n("#confirmImport_btn"),F=n("#cancelImport_btn"),I=n("#sourceUser"),q=n(".importSourceID"),R=n(".importSourceName"),U=n(".importSourceURL"),z=n("#importConfig-modal"),W=n("#import-modal"),X=n("#importProgressContainer"),V=n("#importProgress"),$=V.find(".bar"),J=n("#importStatus"),K=J.find(".statusTitle"),Q=J.find(".statusText"),G=null,Y=r.template(n("#import-results-template").html()),Z=function(){et()},et=function(){B.click(function(e){e.preventDefault(),I.val()!==""&&it(I.val())}),I.keyup(function(e){e.preventDefault(),e.which===13&&I.val()!==""&&it(I.val())}),j.click(function(e){e.preventDefault(),xt()}),F.click(function(e){e.preventDefault(),st()})},tt=function(){P.html("")},nt=function(e){k=e,r.has(L,e)?(z.modal("hide"),W.modal("show")):rt()},rt=function(){q.text(v[k]),R.text(d[k]);var e=m[k],t='<a href="'+e+'" target="_blank">'+e+"</a>";U.html(t),z.modal("show"),r.delay(function(){I.focus().select()},800)},it=function(e){L[k]=!0,M=[],E=0,S=0,x=0,T=0,G=lt.lazy(500,1e4),A++,H.empty(),bt(b),z.modal("hide"),W.modal("show"),u.importGames(k,e,function(e){ot(e,g[k])}),i.success("Importing "+d[k]+" games for: "+e)},st=function(){delete L[k],A++,r.each(_,function(e,t){e&&r.has(e,"abort")&&e.abort()}),rt(),W.modal("hide"),i.error(d[k]+" import cancelled")},ot=function(e,t){O=e,x=O.length,_=[],r.each(O,function(e){e=h.standardizeTitle(e);var n=ut(e,t);_.push(n)})},ut=function(e,t){var n={initialProvider:1,standardName:e},r=h.findItemOnAlternateProvider(n,o.SEARCH_PROVIDERS.Amazon,!1,function(r){at(e,r,n,t)},function(){ht(e)});return r},at=function(e,t,i,s){n.extend(!0,i,t);var u=p.getGiantBombItemPlatform(i.id,function(t){var n=[];for(var u=0,a=t.results.platforms.length;u<a;u++){var f=o.matchPlatformToIndex(t.results.platforms[u].name).name;n.push(f)}var l=r.intersection(n,s);i.platform=l[0],i.platform?(E+=2,G(i,dt,A),ft(i),ct(i)):ht(e)});_.push(u)},ft=function(e){var t=c.getMetascore(e.standardName,e,!0,vt);_.push(t)},lt=function(e,t,n){if(A!==n)return;var r=h.findItemOnAlternateProvider(e,o.SEARCH_PROVIDERS.GiantBomb,!1,function(n){console.info("success: ",e.name),e.asin=n.asin,t()},function(n){n?console.info("service unavailable: ",e.name):(console.info("no match found: ",e.name),t())});_.push(r)},ct=function(e){e.importClass="imported",T===0&&wt(),T++,M.push(e),pt(e),gt()},ht=function(e){var t={thumbnailImage:y,name:e,calendarDate:"",platform:"Title not found: please add manually",importClass:"importFailed"};pt(t)},pt=function(e){var t={item:e};H.append(Y(t))},dt=function(){mt()},vt=function(e){mt()},mt=function(){S++,gt(),E==S&&St()},gt=function(){var e=x+E,t=T+S,n=Math.round(t/e*100);$.css({width:n+"%"}),Q.text(t+" of "+e)},yt=function(){var e=Math.round(C/N*100);$.css({width:e+"%"}),Q.text(C+" of "+N)},bt=function(e){W.removeClass("ready").addClass("loading"),X.removeClass("show"),$.css({width:"0%"}),K.text(e)},wt=function(){X.addClass("show"),W.removeClass("ready").removeClass("loading")},Et=function(){X.removeClass("show"),r.delay(function(){$.css({width:"0%"})},1e3)},St=function(){Et(),r.delay(function(){W.addClass("ready")},1e3),i.success(x+" titles found and linked for "+d[k])},xt=function(){K.text(w),wt();var e=d[k].toLowerCase()+" import";N=M.length,C=0,a.addTag(e,function(t){var n=[t.tagID];r.each(M,function(t){u.addItemToTags(n,t,function(t){C++,yt(),C===N&&Tt(n,e)})})})},Tt=function(e,t){i.success(d[k]+" Import Complete"),i.log("Games added to tag: "+t),W.modal("hide"),f.refreshView(),a.updateViewList(e),f.viewRandomItem(),delete L[k],k=null},Nt={init:Z,startImport:nt};n.extend(e,Nt)}(gamedex.module("importView"),gamedex,jQuery,_,alertify),gamedex.initialize();