/*! GAMEDEX - v0.1.0 - 2012-09-11
* http://www.gamedex.net/
* 2012 - Michael Martin */
(function(a){function h(d,e){this.element=d,this.options=a.extend({},c,e),this._defaults=c,this._name=b,this.init()}var b="BootstrapSubMenu",c={propertyName:"value"},d=null,e=null,f=null,g=null;h.prototype.init=function(){this.createEventHandlers(a(this.element),this.options.$mainNav)},h.prototype.createEventHandlers=function(a,b){b.find("li:not(.dropdown-sub li)").hover(function(b){console.info("hide and stop show"),clearTimeout(f),f=null,g||(g=setTimeout(function(){a.removeClass("active")},500))}),a.hover(function(b){console.info("show and stop hide"),clearTimeout(g),g=null,f||(f=setTimeout(function(){a.addClass("active")},300))}),a.click(function(b){b.preventDefault(),b.stopPropagation(),a.addClass("active")}),a.find("li").hover(function(a){console.info("stop hide"),clearTimeout(g),g=null}),a.find("li").click(function(a){b.removeClass("open")}),b.find(".dropdown-toggle").click(function(b){a.removeClass("active")})},a.fn[b]=function(c){return this.each(function(){a.data(this,"plugin_"+b)||a.data(this,"plugin_"+b,new h(this,c))})}})(jQuery);var tmz={module:function(){var a={};return function(b){return a[b]?a[b]:a[b]={}}}()};tmz.api="/",tmz.initialize=function(){tmz.initializeLibraries(),tmz.initializeModules()},tmz.initializeLibraries=function(){moment.calendar={lastDay:"LL",sameDay:"LL",nextDay:"LL",lastWeek:"LL",nextWeek:"LL",sameElse:"LL"},moment.longDateFormat={L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D YYYY h:mm A",LLLL:"dddd, MMMM D YYYY h:mm A"}},tmz.initializeModules=function(){var a=tmz.module("itemData"),b=tmz.module("searchView"),c=tmz.module("detailView"),d=tmz.module("itemView"),e=tmz.module("tagView"),f=tmz.module("gridView"),g=tmz.module("filterPanel"),h=tmz.module("videoPanel"),i=tmz.module("importView"),j=tmz.module("siteView");a.init(),b.init(),c.init(),d.init(),e.init(),f.init(),g.init(),h.init(),i.init(),j.init()},function(a,b,c,d){"use strict";var e=b.module("user"),f=[{id:"all",gt:"",ign:"",gamestats:"",amazon:0,alias:"all"},{id:"pc",gt:"pc",ign:"pc",gamestats:"pc",amazon:229575,alias:"pc,windows",name:"PC"},{id:"mac",gt:"",ign:"",gamestats:"pc",amazon:229647,alias:"mac,macwindows,osx,os x,apple,macintosh",name:"Mac"},{id:"xbox",gt:"",ign:"",gamestats:"xbox",amazon:537504,alias:"xbox,microsoft xbox",name:"Xbox"},{id:"x360",gt:"xbox 360",ign:"x360",gamestats:"xbox-360",amazon:14220161,alias:"x360,xbox 360,microsoft xbox360,360",name:"X360"},{id:"xbl",gt:"xbla",ign:"x360&downloadType=1",gamestats:"xbox-360",amazon:14220161,alias:"xbl,xbox live",name:"XBL"},{id:"ds",gt:"ds",ign:"ds",gamestats:"nintendo-ds",amazon:11075831,alias:"ds,nintendo ds",name:"DS"},{id:"3ds",gt:"3ds",ign:"ds",gamestats:"nintendo-ds",amazon:2622269011,alias:"3ds,nintendo 3ds",name:"3DS"},{id:"wii",gt:"wii",ign:"wii",gamestats:"wii",amazon:14218901,alias:"wii,nintendo wii",name:"Wii"},{id:"ps",gt:"",ign:"",gamestats:"playstation",amazon:229773,alias:"ps,ps1,playstation,playstation1,playstation 1,sony playstation 1,sony playstation",name:"PS1"},{id:"ps2",gt:"",ign:"",gamestats:"playstation-2",amazon:301712,alias:"ps2,playstation 2,playstation2,sony playstation 2",name:"PS2"},{id:"ps3",gt:"ps3",ign:"ps3",gamestats:"playstation-3",amazon:14210751,alias:"ps3,playstation 3,playstation3,sony playstation 3",name:"PS3"},{id:"psn",gt:"",ign:"ps3&downloadType=201",gamestats:"playstation-3",amazon:14210751,alias:"psn,playstation network",name:"PSN"},{id:"vita",gt:"vita",ign:"ps-vita",gamestats:"playstation-3",amazon:3010556011,alias:"vita,psvita,ps vita,playstation vita,sony vita,sony playstation vita",name:"Vita"},{id:"psp",gt:"",ign:"",gamestats:"playstation-portable",amazon:11075221,alias:"psp,sony psp",name:"PSP"},{id:"gc",gt:"",ign:"",gamestats:"gamecube",amazon:541022,alias:"gamecube,gc,nintendo gamecube",name:"Gamecube"},{id:"n64",gt:"",ign:"",gamestats:"nintendo-64",amazon:229763,alias:"n64,nintendo 64,nintendo64",name:"N64"},{id:"nes",gt:"",ign:"",gamestats:"nes",amazon:566458,alias:"nes,nintendo nes",name:"NES"},{id:"snes",gt:"",ign:"",gamestats:"super-nes",amazon:294945,alias:"snes,super nintendo,nintendo snes",name:"SNES"},{id:"gba",gt:"",ign:"",gamestats:"gameboy-advance",amazon:1272528011,alias:"gb,gameboy",name:"Game Boy"},{id:"gb",gt:"",ign:"",gamestats:"game-boy",amazon:541020,alias:"gba,gameboy advance,game boy,advance,gbadvance",name:"GBA"},{id:"gbc",gt:"",ign:"",gamestats:"game-boy-color",amazon:229783,alias:"gbc,gbcolor,gameboy color",name:"GBC"},{id:"dc",gt:"",ign:"",gamestats:"dreamcast",amazon:229793,alias:"dc,dreamcast,sega dreamcast,sega dream cast,dream cast",name:"Dreamcast"},{id:"saturn",gt:"",ign:"",gamestats:"saturn",amazon:294944,alias:"saturn,sega saturn",name:"Saturn"},{id:"genesis",gt:"",ign:"",gamestats:"genesis",amazon:294943,alias:"genesis,sega genesis",name:"Genesis"},{id:"gamegear",gt:"",ign:"",gamestats:"game-gear",amazon:294942,alias:"gamegear,game gear,sega gamegear",name:"Gamegear"},{id:"segacd",gt:"",ign:"",gamestats:"sega-cd",amazon:11000181,alias:"cd,sega cd",name:"Sega CD"}],g={Amazon:0,GiantBomb:1},h="0",i={URL:"http://ecx.images-amazon.com/images",RE:/http:\/\/ecx\.images-amazon\.com\/images/gi,TOKEN:"~1~"},j={URL:"http://media.giantbomb.com/uploads",RE:/http:\/\/media\.giantbomb\.com\/uploads/gi,TOKEN:"~1~"},k=function(a){var b=new RegExp(a,"gi");for(var c=0,d=f.length;c<d;c++)if(b.test(f[c].alias))return f[c];return f[0]},l=function(a){var b=null,c=[],d=null,e=a.length,g=0,h=null;for(var i=0,j=f.length;i<j;i++){c=f[i].alias.split(",");for(var k=0,l=c.length;k<l;k++){b=new RegExp(c[k],"gi"),h=b.exec(a);if(h&&h[0].length===e)return f[i];h&&h[0].length>g&&(g=h[0].length,d=f[i])}}return d?d:f[0]},m={PLATFORM_INDEX:f,SEARCH_PROVIDERS:g,VIEW_ALL_TAG_ID:h,AMAZON_IMAGE:i,GIANTBOMB_IMAGE:j,getStandardPlatform:k,matchPlatformToIndex:l};c.extend(a,m)}(tmz.module("utilities"),tmz,jQuery,_),function(a,b,c,d){"use strict";var e=b.module("utilities"),f=b.module("storage"),g=b.module("itemView"),h=b.module("itemCache"),i=b.api+"user/login/",j=b.api+"user/logout/",k=b.api+"user/",l=b.api+"user/create/",m=b.api+"user/update/",n=b.api+"user/resetcode/send/",o=b.api+"user/resetcode/submit/",p=b.api+"user/password/update/",q={user_id:"",secret_key:"",viewUser:null},r={user_id:"1",secret_key:"1"};a.getUserData=function(a){return q},a.getUserCredentials=function(a){return a=typeof a!="undefined"?a:!1,q.timestamp=(new Date).getTime(),a&&f.set("timestamp",q.timestamp),q.viewUser?{user_name:q.viewUser}:a?{uid:q.user_id,uk:q.secret_key,ts:q.timestamp}:{uid:q.user_id,uk:q.secret_key}},a.getUserID=function(){return q.user_id},a.login=function(a,b,d,e){var f={user_email:a,user_password:b};c.ajax({url:i,type:"POST",data:f,dataType:"json",cache:!0,success:function(b){t(b,a),d(b,a)},error:e})},a.demoLogin=function(){q.user_id=r.user_id,q.secret_key=r.secret_key},a.validateUser=function(a,b){var d={user_name:a};c.ajax({url:k,type:"POST",data:d,dataType:"json",cache:!0,success:function(a){u(a),b(a)},error:function(a){}})},a.logout=function(a,b,d){var e={uid:q.user_id,uk:q.secret_key};c.ajax({url:j,type:"POST",data:e,dataType:"json",cache:!0,success:function(a){},error:function(a){}}),q.user_id=null,q.secret_key=null,q.userName=null,q.email=null,q.viewUser=null},a.createUser=function(a,b,d,e){var f={user_email:a,user_password:b};c.ajax({url:l,type:"POST",data:f,dataType:"json",cache:!0,success:function(b){t(b,a),d(b,a)},error:e})},a.updateUser=function(a,b,d,e,f){if(a!==""){var g={uid:q.user_id,user_password:a};d!==q.userName&&(g.user_name=d),b!==q.email&&(g.user_email=b),e!==""&&(g.user_new_password=e),g.user_password=a,c.ajax({url:m,type:"POST",data:g,dataType:"json",cache:!0,success:function(a){a.status==="success"&&s(g),f(a)},error:function(a){}})}},a.sendResetPasswordCode=function(a,b){var d={user_email:a};c.ajax({url:n,type:"POST",data:d,dataType:"json",cache:!0,success:function(a){b(a)},error:function(a){}})},a.submitResetPasswordCode=function(a,b,d){var e={user_email:a,user_reset_code:b};c.ajax({url:o,type:"POST",data:e,dataType:"json",cache:!0,success:function(a){d(a)},error:function(a){}})},a.updatePassword=function(a,b,d,e){var f={user_email:a,user_reset_code:b,user_new_password:d};c.ajax({url:p,type:"POST",data:f,dataType:"json",cache:!0,success:function(a){e(a)},error:function(a){}})},a.isViewUser=function(){return q.viewUser?!0:!1};var s=function(a){typeof a.user_name!="undefined"&&(q.userName=a.user_name),typeof a.user_email!="undefined"&&(q.email=a.user_email)},t=function(a,b){if(a.userID){q.user_id=a.userID,q.secret_key=a.secretKey,q.userName=a.userName,q.email=b,q.viewUser=null;var c=f.get("timestamp");c?a.timestamp!=c&&(h.clearStoredData(),f.set("timestamp",a.timestamp)):f.set("timestamp",a.timestamp)}},u=function(a){a.status==="success"&&(q.viewUser=a.userName,q.user_id=a.userName,q.secret_key=0)}}(tmz.module("user"),tmz,jQuery,_),function(a,b,c,d){"use strict";var e=b.module("user");a.get=function(a){var b=e.getUserID(),c=localStorage.getItem(b+"_"+a),d=null;return c!=="undefined"&&c&&(d=JSON.parse(c)),d},a.set=function(a,b){if(!e.isViewUser()){var c=e.getUserID();localStorage.setItem(c+"_"+a,JSON.stringify(b)),b||(b={})}return b},a.remove=function(a){var b=e.getUserID();localStorage.removeItem(b+"_"+a)},a.setGlobal=function(a,b){return localStorage.setItem(a,JSON.stringify(b)),b||(b={}),b},a.getGlobal=function(a){var b=localStorage.getItem(a),c=null;return b&&(c=JSON.parse(b)),c},a.removeGlobal=function(a){localStorage.removeItem(a)},a.clearStorage=function(){localStorage.clear()}}(tmz.module("storage"),tmz,jQuery,_),function(a,b,c,d,e){"use strict";var f=b.module("user"),g=b.module("itemLinker"),h=b.module("itemCache"),i=b.module("tagView"),j=b.module("utilities"),k=b.api+"item/directory/",l=b.api+"item/",m=b.api+"item/add/",n=b.api+"item/delete/batch/",o=b.api+"item/delete/",p=b.api+"item/user/update/",q=b.api+"item/shared/update/",r=b.api+"item/metacritic/update/",s=b.api+"import/",t=j.VIEW_ALL_TAG_ID,u={},v={},w={},x={},y=function(){c(document).keypress(function(a){a.which==96&&(console.warn("------------ itemDataDirectory: -------",v),console.warn("------------ amazonDirectory: -------",w),console.warn("------------ giantBombDirectory: -------",x),console.warn("------------ items: -------------------",u))})},z=function(a){h.cacheItemsByTag(a,v)},A=function(a,b){var d=null,e=f.getUserCredentials(),g=h.getStoredItemDirectory();if(g)C(g),a&&a(g);else{var i={};c.extend(!0,i,e),d=c.ajax({url:k,type:"POST",data:i,dataType:"json",cache:!0,success:function(b){B(b),h.storeItemDirectory(v),a&&a(b)},error:function(a){}})}return d},B=function(a){var b={};d.each(a.directory,function(a,c){b={itemID:c,asin:a.aid,gbombID:a.gid,gameStatus:a.gs,playStatus:a.ps,tags:a.t,tagCount:a.tc,userRating:a.ur},X(b)})},C=function(a){var b={};d.each(a,function(a){X(a)})},D=function(a,b,d){var e=null,g=h.getCachedItemsByTag(a);if(g)u=g,b(g);else{var i={list_id:a},j=f.getUserCredentials();c.extend(!0,i,j),e=c.ajax({url:l,type:"POST",data:i,dataType:"json",cache:!0,success:function(a){u=E(a),b(u)},error:d})}return e},E=function(a){var b={},c={},d=0,e=null;for(var f=0,g=a.items.length;f<g;f++){c={};var h=a.items[f].ip,i=a.items[f].ib||"",j=J(a.items[f].si,i,h),k=J(a.items[f].ti,i,h),l=J(a.items[f].li,i,h);c.id=a.items[f].iid,c.initialProvider=a.items[f].ip,c.itemID=a.items[f].iid,c.asin=a.items[f].aid,c.gbombID=a.items[f].gid,c.name=a.items[f].n,c.releaseDate=a.items[f].rd,c.platform=a.items[f].p,c.smallImage=j,c.thumbnailImage=k,c.largeImage=l,c.metascore=a.items[f].ms,c.metascorePage=a.items[f].mp,c.offers={},c.description="",S(c),b[c.itemID]=c}return b},F=function(a){return u[a]},G=function(a,b,d,e){var g=null,h=f.getUserCredentials(!0),j=c.extend(!0,{},b),k=I(j.smallImage,j.initialProvider),l=I(j.thumbnailImage,j.initialProvider),n=I(j.largeImage,j.initialProvider),o=k.split(""),p=l.split(""),q=n.split(""),r=H(o,p,q),s=o.slice(0,r).join("");k=o.slice(r).join(""),l=p.slice(r).join(""),n=q.slice(r).join("");var t={lids:a,n:j.name,rd:j.releaseDate,aid:j.asin,gid:j.gbombID,ip:j.initialProvider,p:j.platform,ib:s,si:k,ti:l,li:n,mp:j.metascorePage,ms:j.metascore,gs:j.gameStatus,ps:j.playStatus,ur:j.userRating};return c.extend(!0,t,h),g=c.ajax({url:m,type:"POST",data:t,dataType:"json",cache:!0,success:function(a){b.id=a.itemID,b.itemID=a.itemID;var c=Q(b,a);i.updateInitialItemTags(a.tagIDsAdded,a.idsAdded),d(a,c)},error:e}),g},H=function(a,b,c){var d=0,e="";for(var f=0,g=a.length;f<g;f++)if(a[f]===b[f]&&a[f]===c[f])d=f;else break;return d+1},I=function(a,b){var c=a;return b===j.SEARCH_PROVIDERS.Amazon?c=a.replace(j.AMAZON_IMAGE.RE,j.AMAZON_IMAGE.TOKEN):b===j.SEARCH_PROVIDERS.GiantBomb&&(c=a.replace(j.GIANTBOMB_IMAGE.RE,j.GIANTBOMB_IMAGE.TOKEN)),c},J=function(a,b,c){var d=a,e=null;return a=b+a,c==j.SEARCH_PROVIDERS.Amazon?(e=new RegExp(j.AMAZON_IMAGE.TOKEN,"g"),d=a.replace(e,j.AMAZON_IMAGE.URL)):c==j.SEARCH_PROVIDERS.GiantBomb&&(e=new RegExp(j.GIANTBOMB_IMAGE.TOKEN,"g"),d=a.replace(e,j.GIANTBOMB_IMAGE.URL)),d},K=function(a,b,d,e,g){var h=f.getUserCredentials(!0),i={ids:a};c.extend(!0,i,h),c.ajax({url:n,type:"POST",data:i,dataType:"json",cache:!0,success:function(a){},error:g}),L(d.itemID,a,b),e(d.itemID,b)},L=function(a,b,c){for(var d=0,e=b.length;d<e;d++)R(c[d],a)},M=function(a,b,d,e){var g=Z(a).tags[b],h=f.getUserCredentials(!0),i={id:g};return c.extend(!0,i,h),c.ajax({url:o,type:"POST",data:i,dataType:"json",cache:!0,success:function(a){},error:e}),R(b,a),d(g,b),a},N=function(a,b,d){var e=Z(a.itemID).tags,g=f.getUserCredentials(!0),h=c.extend(!0,{},a),i={id:h.itemID,aid:h.asin,gid:h.gbombID,rd:h.releaseDate,si:h.smallImage,ti:h.thumbnailImage,li:h.largeImage};c.extend(!0,i,g),c.ajax({url:q,type:"POST",data:i,dataType:"json",cache:!0,success:function(a){U(h,e),b(h,a)},error:d})},O=function(a,b,d){var e=f.getUserCredentials(!0),g=c.extend(!0,{},a),h={id:g.itemID,gs:g.gameStatus,ps:g.playStatus,ur:g.userRating};c.extend(!0,h,e),c.ajax({url:p,type:"POST",data:h,dataType:"json",cache:!0,success:function(a){T(g),b(g,a)},error:d})},P=function(a,b,d){console.info(a);var e=Z(a.itemID).tags,g=f.getUserCredentials(!0),h=c.extend(!0,{},a),i={id:h.itemID,mp:h.metascorePage,ms:h.metascore};c.extend(!0,i,g),U(h,e),c.ajax({url:r,type:"POST",data:i,dataType:"json",cache:!0,success:function(a){b&&b(h,a)},error:d})},Q=function(a,b){var e=null,f=null,g=[];a.itemID=b.itemID;for(var i=0,j=b.tagIDsAdded.length;i<j;i++)f=c.extend(!0,{},a),f.id=b.itemID,S(f),h.cacheItemByTag(b.tagIDsAdded[i],f),g.push(f);V(f,b),e=h.getCachedItemsByTag(t);var k=!1;return d.each(e,function(a,b){a.itemID===f.itemID&&(k=!0)}),k||h.cacheItemByTag(t,f),g},R=function(a,b){h.deleteCachedItem(b,a),W(b,a),v[b].tagCount===0&&h.deleteCachedItem(b,t)},S=function(a){a.releaseDate!=="1900-01-01"?a.calendarDate=e(a.releaseDate,"YYYY-MM-DD").calendar():a.calendarDate="Unknown",a.standardName=g.standardizeTitle(a.name)},T=function(a){var b=v[a.itemID];b.gameStatus=a.gameStatus,b.playStatus=a.playStatus,b.userRating=a.userRating,h.storeItemDirectory(v)},U=function(a,b){d.each(b,function(b,c){h.updateCacheItemByTag(c,a)}),h.updateCacheItemByTag(0,a)},V=function(a,b){if(!v[b.itemID]){var c={itemID:a.itemID,asin:a.asin,gbombID:a.gbombID,gameStatus:a.gameStatus,playStatus:a.playStatus,tags:{},tagCount:0,userRating:a.userRating};X(c)}for(var d=0,e=b.tagIDsAdded.length;d<e;d++)v[b.itemID].tags[b.tagIDsAdded[d]]=b.idsAdded[d],v[b.itemID].tagCount+=1;h.storeItemDirectory(v)},W=function(a,b){var c=v[a];delete c.tags[b],c.tagCount+=-1,h.storeItemDirectory(v)},X=function(a){v[a.itemID]=a,parseInt(a.asin,10)!==0&&(w[a.asin]=a),parseInt(a.gbombID,10)!==0&&(x[a.gbombID]=a)},Y=function(){return v},Z=function(a){return v[a]||null},$=function(a,b){var c=null;return a!==0?c=x[a]:b!==0&&(c=w[b]),c},_=function(){u={},v={},w={},x={},h.clearItemCache()},ba=function(){var a=[];d.each(u,function(b,c){a.push(c)});var b=Math.floor(Math.random()*a.length);return a[b]},bb=function(a,b,d){var e=f.getUserCredentials(!0),g={source:a,source_user:b};c.extend(!0,g,e),c.ajax({url:s,type:"POST",data:g,dataType:"json",cache:!0,success:d,error:function(a){}})},bc={init:y,itemsAndDirectoryLoaded:z,getItemDirectory:Y,getDirectoryItemByItemID:Z,getItemByThirdPartyID:$,resetItemData:_,getRandomItemID:ba,getItems:D,getItem:F,downloadItemDirectory:A,addItemToTags:G,updateUserItem:O,updateMetacritic:P,deleteTagsForItem:K,deleteSingleTagForItem:M,deleteTagFromDirectory:W,deleteClientItem:R,importGames:bb};c.extend(a,bc)}(tmz.module("itemData"),tmz,$,_,moment),function(a,b,c,d){"use strict";var e=b.api+"tag/",f=b.api+"tag/add/",g=b.api+"tag/update/",h=b.api+"tag/delete/",i=b.module("user"),j=b.module("storage"),k=b.module("itemData"),l={};a.getTags=function(a,b){var d=null,f=i.getUserCredentials(),g={};return c.extend(!0,g,f),l=j.get("tag"),l?a&&a(l):d=c.ajax({url:e,type:"POST",data:g,dataType:"json",cache:!0,success:function(b){l=j.set("tag",b.list),a(b.list)},error:b}),d},a.addTag=function(a,b,d){var e=i.getUserCredentials(!0),g={tag_name:a};c.extend(!0,g,e),c.ajax({url:f,type:"POST",data:g,dataType:"json",cache:!0,success:function(a){l.push({tagName:a.tagName.toLowerCase(),tagID:a.tagID}),j.set("tag",l),b(a)},error:d})},a.updateTag=function(a,b,d,e){var f=i.getUserCredentials(!0),h={tag_name:a,tag_id:b};c.extend(!0,h,f),c.ajax({url:g,type:"POST",data:h,dataType:"json",cache:!0,success:function(a){d(a)},error:e});for(var k=0,m=l.length;k<m;k++)l[k].tagID===b&&(l[k].tagName=a,j.set("tag",l))},a.deleteTag=function(a,b,d){var e=i.getUserCredentials(!0),f={id:a};c.extend(!0,f,e),c.ajax({url:h,type:"POST",data:f,dataType:"json",cache:!0,success:b,error:d});for(var g=0,k=l.length;g<k;g++)if(l[g].tagID===a){l.splice(g,1),j.set("tag",l);break}}}(tmz.module("tagData"),tmz,jQuery,_),function(a,b,c,d){"use strict";var e=b.module("user"),f=b.module("storage"),g=b.module("utilities"),h=g.VIEW_ALL_TAG_ID,i={},j={},k=function(a){var b=null;return typeof i[a]!="undefined"?b=i[a]:b=v(a),b},l=function(a,b){d.each(a,function(a,c){typeof b[a.itemID]!="undefined"&&d.each(b[a.itemID].tags,function(b,c){m(c,a),m(h,a)})})},m=function(a,b){typeof i[a]!="undefined"?i[a][b.itemID]=b:(i[a]={},i[a][b.itemID]=b),q(a,b)},n=function(a,b){i[a][b.itemID]=b,q(a,b,!0)},o=function(){return f.get("itemDataDirectory")},p=function(a){f.set("itemDataDirectory",a)},q=function(a,b,c){if(typeof j[a+"_"+b.itemID]=="undefined"||c){var d=f.get("itemsCacheByTag");d?typeof d[a]!="undefined"?d[a][b.itemID]=b:(d[a]={},d[a][b.itemID]=b):(d={},d[a]={},d[a][b.itemID]=b),f.set("itemsCacheByTag",d)}},r=function(a,b){i[b]&&delete i[b][a],u(a,b)},s=function(a){i[a]&&delete i[a],t(a)},t=function(a){var b=f.get("itemsCacheByTag");b&&(delete b[a],f.set("itemsCacheByTag",b))},u=function(a,b){var c=f.get("itemsCacheByTag");c&&(delete c[b][a],f.set("itemsCacheByTag",c))},v=function(a){var b=f.get("itemsCacheByTag"),c=null;return b&&typeof b[a]!="undefined"&&(c=b[a],d.each(c,function(b,c){j[a+"_"+c]=!0})),c},w=function(a){i={},j={}},x=function(a){f.remove("itemsCacheByTag"),f.remove("itemDataDirectory"),f.remove("tag")},y={getCachedItemsByTag:k,cacheItemsByTag:l,cacheItemByTag:m,updateCacheItemByTag:n,getStoredItemDirectory:o,storeItemDirectory:p,deleteCachedItem:r,deleteCachedTag:s,clearItemCache:w,clearStoredData:x};c.extend(a,y)}(tmz.module("itemCache"),tmz,$,_),function(a,b,c,d){"use strict";var e=b.module("user"),f=b.module("itemData"),g=b.module("tagView"),h=b.module("itemView"),i=b.module("searchView"),j=b.module("storage"),k={login:0,signup:1},l=k.login,m=!1,n=1,o=c("#content"),p=c("#infoHeader"),q=c("#header"),r=c("#userMenu"),s=c("#logoutButton"),t=c("#loggedInButton"),u=c("#loginForm"),v=c("#buttonContainer"),w=c("#loginButton"),x=c("#loginHitArea"),y=c("#signupButton"),z=c("#signupHitArea"),A=c("#loginSubmitButton"),B=c("#signupSubmitButton"),C=c("#backButton"),D=c("#email").find("input"),E=c("#password").find("input"),F=c("#rememberCheckboxToggle"),G=c("#resetPasswordButton"),H=c("#invalidLoginTag"),I=c("#accountExistsTag"),J=c("#accountManagement-modal"),K=c("#clearLocalStorage_btn"),L=c("#deleteAccount_btn"),M=c("#managementButton"),N=c("#updateAccount_btn"),O=c("#userNameUpdateField"),P=c("#passwordField"),Q=c("#passwordUpdateField"),R=c("#emailUpdateField"),S=J.find(".existingPasswordGroup"),T=J.find(".emailGroup"),U=J.find(".alert-success"),V=J.find(".alert-error"),W=c("#resetpassword-modal"),X=W.find(".resetCodeForm"),Y=W.find(".updatePasswordForm"),Z=W.find(".passwordResetCodeContainer"),$=W.find(".passwordResetEmailContainer"),_=W.find(".alert-success"),ba=W.find(".alert-error"),bb=c("#resetPasswordEmailField"),bc=c("#resetPasswordCodeField"),bd=c("#resetPasswordPasswordField"),be=c("#sendResetCode_btn"),bf=c("#submitResetCode_btn"),bg=c("#updatePassword_btn"),bh=c("#guideHitArea"),bi=c("#guideButton"),bj=c("#siteGuide"),bk=c("#siteGuideBackdrop"),bl=bj.find(".siteGuideExit_btn"),bm=bj.find(".siteGuidePrevious_btn"),bn=bj.find(".siteGuideNext_btn"),bo=c("#searchField input"),bp=c("#itemResultsContainer").find(".loadingStatus"),bq=function(){br(),bs(),W.modal({backdrop:!0,keyboard:!0,show:!1});var a=window.location.pathname.split("/"),b=a[1],c=a[2];b=="user"&&c!==""?e.validateUser(c,function(a){a.status==="success"&&bx()}):bw()},br=function(){M.click(function(a){a.preventDefault(),bU()}),N.click(function(a){a.preventDefault(),bV()}),D.on("keydown",function(a){bT(a.which)}),E.on("keydown",function(a){bT(a.which)}),s.click(function(a){a.preventDefault(),bz()}),K.click(function(a){a.preventDefault(),j.clearStorage()}),L.click(function(a){a.preventDefault(),bW()}),z.click(function(a){a.preventDefault(),bP()}),z.mouseover(function(a){y.addClass("hover")}),z.mouseout(function(a){y.removeClass()}),z.mousedown(function(a){y.addClass("active")}),z.mouseup(function(a){y.removeClass("active")}),x.click(function(a){a.preventDefault(),bO()}),x.mouseover(function(a){w.addClass("hover")}),x.mouseout(function(a){w.removeClass()}),x.mousedown(function(a){w.addClass("active")}),x.mouseup(function(a){w.removeClass("active")}),bh.click(function(a){bD()}),bh.mouseover(function(a){bi.addClass("hover")}),bh.mouseout(function(a){bi.removeClass()}),bh.mousedown(function(a){bi.addClass("active")}),bh.mouseup(function(a){bi.removeClass("active")}),A.click(function(a){a.preventDefault(),bu(D.val(),E.val())}),B.click(function(a){a.preventDefault(),bA(D.val(),E.val())}),C.click(function(a){a.preventDefault(),bS()}),F.click(function(a){m?(m=!1,c(this).removeClass("on"),bt()):(m=!0,c(this).addClass("on"))}),G.click(function(a){a.preventDefault();var b=D.val()||j.getGlobal("email");b&&bb.val(b),W.modal("show"),d.delay(function(){bb.focus().select()},1e3)}),be.click(function(a){a.preventDefault(),bF(bb.val())}),bf.click(function(a){a.preventDefault(),bH(bb.val(),bc.val())}),bg.click(function(a){a.preventDefault(),bJ(bb.val(),bc.val(),bd.val())}),bb.keydown(function(a){a.which===13&&(a.preventDefault(),bF(bb.val()))}),bc.keydown(function(a){a.which===13&&(a.preventDefault(),bH(bb.val(),bc.val()))}),bd.keydown(function(a){a.which===13&&(a.preventDefault(),bJ(bb.val(),bc.val(),bd.val()))}),bj.click(function(a){a.preventDefault(),a.stopPropagation()}),bn.click(function(a){a.preventDefault(),bD(++n)}),bm.click(function(a){a.preventDefault(),bD(--n)}),bl.click(function(a){a.preventDefault(),n=1,bD(n),bE()})},bs=function(){var a=j.getGlobal("email");a&&(m=!0,D.val(a),F.addClass("on"),E.focus())},bt=function(){m?j.setGlobal("email",D.val()):j.removeGlobal("email")},bu=function(a,b){bv(),e.login(a,b,bB)},bv=function(){E.val(""),H.hide(),I.hide()},bw=function(){e.demoLogin(),by()},bx=function(){by()},by=function(){bp.fadeIn(),bo.focus(),h.clearItemView(),f.resetItemData();var a=null,b=null,d=f.downloadItemDirectory(),e=h.initializeUserItems(function(b){a=b},function(){a={}}),i=g.getTags(function(a){b=a},function(){});c.when(e,d,i).then(function(){g.getTags_result(b),h.initializeUserItems_result(a),bp.hide()},function(){})},bz=function(a,b){bN(),h.clearItemView(),e.logout(),bw()},bA=function(a,b){bv(),a!==""&&b!==""&&e.createUser(a,b,bC)},bB=function(a,b){a.status==="success"?(bt(),bM(b),by()):typeof a.status!="undefined"&&a.status==="invalid_login"&&H.fadeIn()},bC=function(a,b){typeof a.status!="undefined"&&a.status==="user_exists"?I.fadeIn():(bt(),bB(a,b))},bD=function(a){a&&(o.removeClass(),o.addClass("step"+a)),bj.is(":visible")||bj.show()},bE=function(){bj.is(":visible")&&bj.hide()},bF=function(a){e.sendResetPasswordCode(a,bG)},bG=function(a){typeof a.status!="undefined"&&a.status==="success"?(be.hide(),bf.show(),$.hide(),Z.show(),_.find(".alertTitle").text("E-mail sent:"),_.show().find(".alertText").html("Check your e-mail and enter the <strong>3-digit code</strong> into the field above"),ba.hide()):typeof a.status!="undefined"&&a.status==="invalid_email"&&(ba.find(".alertTitle").text("Invalid E-mail address:"),ba.show().find(".alertText").html("Cannot send password reset code"))},bH=function(a,b){e.submitResetPasswordCode(a,b,bI)},bI=function(a){typeof a.status!="undefined"&&a.status==="success"?(X.hide(),bf.hide(),Y.show(),bg.show(),_.hide(),ba.hide()):(_.hide(),ba.find(".alertTitle").text("Invalid code:"),ba.show().find(".alertText").html("Reset code is incorrect, please try again"))},bJ=function(a,b,c){e.updatePassword(a,b,c,function(b){bK(b,a,c)})},bK=function(a,b,c){typeof a.status!="undefined"&&a.status==="success"&&(bL(),D.val(b),E.val(c),bu(D.val(),E.val()))},bL=function(){W.modal("hide"),be.show(),bf.hide(),bg.hide(),X.show(),Y.hide(),$.show(),Z.hide(),_.hide(),ba.hide(),bb.val(""),bc.val(""),bd.val("")},bM=function(a){c("body").removeClass("infoHeader"),c("body").addClass("useHeader"),t.find(".userEmail").text(a),h.loggedInView(!0),i.loggedInView(!0),r.show()},bN=function(){c("body").removeClass("useHeader"),c("body").addClass("infoHeader"),h.loggedInView(!1),i.loggedInView(!1),r.hide()},bO=function(){l=k.login,bR(),A.show(),B.hide(),C.removeClass("signup"),C.addClass("login")},bP=function(){l=k.signup,bR(),B.show(),A.hide(),C.removeClass("login"),C.addClass("signup")},bQ=function(){},bR=function(){bv(),u.show(),C.show(),m&&D.val()!==""?E.focus():D.focus(),v.hide()},bS=function(){u.hide(),A.hide(),B.hide(),C.hide(),v.show()},bT=function(a){a===13&&l===k.login?bu(D.val(),E.val()):a===13&&l===k.signup&&bA(D.val(),E.val())},bU=function(a){bX();var b=e.getUserData();O.val(b.userName),R.val(b.email),J.modal("show")},bV=function(){bX();var a=P.val(),b=R.val();if(a!==""&&b!==""){var c=O.val(),d=Q.val();e.updateUser(a,b,c,d,function(a){a.status==="success"?(t.find(".userEmail").text(b),P.val(""),Q.val(""),U.fadeIn().find(".alertText").text("Account updated")):a.status==="incorrect_password"&&(S.addClass("error"),V.fadeIn().find(".alertText").text("Incorrect password"))})}a===""&&(S.addClass("error"),V.fadeIn().find(".alertText").text("Please enter existing password")),b===""&&(T.addClass("error"),V.fadeIn().find(".alertText").text("E-mail cannot be blank")),Q.val("")},bW=function(){},bX=function(){U.hide(),V.hide(),S.removeClass("error"),T.removeClass("error")},bY={init:bq,hideSiteGuide:bE};c.extend(a,bY)}(tmz.module("siteView"),tmz,jQuery,_),function(a,b,c,d,e,f){"use strict";var g=b.module("detailView"),h=b.module("amazon"),i=b.module("giantbomb"),j=b.module("utilities"),k=b.module("gameStats"),l=b.module("ign"),m=b.module("releasedList"),n=b.module("itemLinker"),o={POPULAR:0,UPCOMING:1,RELEASED:2},p={"#searchTab":0,"#listTab":1},q=250,r={List:0,Icons:1,Cover:2},s=258,t=493,u=5,v=13,w=null,x="skyrim",y="",z={},A=j.SEARCH_PROVIDERS.Amazon,B=null,C=p["#searchTab"],D=0,E=0,F=null,G=null,H=r.Icons,I=r.Icons,J=t,K=!1,L=null,M={valueNames:["itemName","releaseDate"],item:"list-item"},N=c("#searchContainer"),O=c("#searchViewMenu"),P=c("#searchProvider"),Q=c("#listType"),R=P.find(".providerName"),S=Q.find(".listTypeName"),T=c("#searchPlatforms"),U=c("#legacySubNav"),V=c("#platformSelect_btn"),W=c("#listPlatforms"),X=T.find(".platformName"),Y=W.find(".platformName"),Z=c("#finderTabLinks"),$=c("#finderTabContent"),_=c("#searchTab"),ba=c("#listTab"),bb=c("#searchTabLink"),bc=c("#listTabLink"),bd=c("#searchField"),be=c("#search_btn"),bf=c("#clearSearch_btn"),bg=bf.find("i"),bh=c("#searchResultsContainer"),bi=bh.find(".content"),bj=c("#searchResults"),bk=bd.find("input"),bl=c("#listResultsContainer"),bm=bl.find(".content"),bn=c("#listResults"),bo=bn.find(".list"),bp=N.find(".searchDisplayOptions"),bq=N.find(".listDisplayOptions"),br=bh.find(".loadingStatus"),bs=bl.find(".loadingStatus"),bt=d.template(c("#search-results-template").html()),bu=d.template(c("#list-results-template").html()),bv=d.template(c("#search-results-platform-dropdown-template").html());a.init=function(b){a.createEventHandlers(),F=j.PLATFORM_INDEX[0],G=j.getStandardPlatform(""),A=j.SEARCH_PROVIDERS.Amazon,bR(!1),bq.find("a").each(function(a,b){c(b).tooltip({delay:{show:500,hide:50},placement:"bottom"})}),bp.find("a").each(function(a,b){c(b).tooltip({delay:{show:500,hide:50},placement:"bottom"})});var d={sliderMinHeight:20,iOSNativeScrolling:!0,preventPageScrolling:!0};bh.nanoScroller(d),bl.nanoScroller(d),setInterval(function(){bS(),bh.nanoScroller(),bl.nanoScroller()},1500),U.BootstrapSubMenu({$mainNav:T})},a.createEventHandlers=function(){Z.find('a[data-toggle="tab"]').on("shown",function(a){C=p[c(a.target).attr("href")],bC(C)}),bk.keyup(bN),P.find("li a").click(function(a){a.preventDefault(),P.attr("data-content",c(this).attr("data-content")),y="",bD()}),O.on("mouseenter",".dropdown-toggle",function(a){var b=this;O.find(".dropdown").each(function(){c(this).hasClass("open")&&c(this).find(".dropdown-toggle").get(0)!==c(b).get(0)&&c(b).trigger("click")})}),Q.find("li a").click(function(a){a.preventDefault(),Q.attr("data-content",c(this).attr("data-content")),bE()}),W.find("li a").click(function(a){a.preventDefault(),bF(c(this).attr("data-content"),c(this).text())}),T.find("li:not(.dropdown-sub) a").click(function(a){a.preventDefault(),bG(c(this).attr("data-content"),c(this).text())}),bj.on("click","tr",bO),bn.on("click","tr",bP),bj.on("click",".dropdown-menu li",function(a){a.preventDefault(),bQ(this)}),bp.on("click","a",function(a){a.preventDefault(),bL(c(this).attr("data-content"))}),bq.on("click","a",function(a){a.preventDefault(),(B==o.UPCOMING||B==o.RELEASED)&&bL(c(this).attr("data-content"))}),be.click(function(b){b.preventDefault(),a.search(x)}),bf.click(function(a){bk.val(""),bk.focus(),bR(!1)}),bj.resize(a.resizePanel),bn.resize(a.resizePanel),c(window).resize(a.resizePanel)},a.renderSearchResults=function(a){br.stop().hide();var b=[];d.each(a,function(a,c){b.push(a)}),b.sort(bB);var c={sortedSearchResults:b};c.displayType=H,bj.html(bt(c))},a.renderListResults=function(a,b){bs.stop().hide();var c={listResults:a};bo.append(bu(c)),L=new f("listResultsContainer",M),b==="asc"?L.sort("releaseDate",{sortFunction:bT}):L.sort("releaseDate",{sortFunction:bU})},a.search=function(a){a===""?bR(!1):bR(!0),C!==p["#searchTab"]&&(bb.trigger("click"),bC(p["#searchTab"]));if(a!==y){bh.find(".noResults").hide(),br.fadeIn(),y=a;switch(A){case j.SEARCH_PROVIDERS.Amazon:h.searchAmazon(a,F.amazon,bx);break;case j.SEARCH_PROVIDERS.GiantBomb:i.searchGiantBomb(a,by)}}},a.getGamestatsPopularityListByPlatform=function(a){bs.fadeIn(),bo.empty(),k.getPopularGamesListByPlatform(a.gamestats,bw)},a.getIGNUpcomingListByPlatform=function(a){function b(a){bw(a,"asc",o.UPCOMING)}bs.fadeIn(),bo.empty(),l.getUpcomingGames(a.ign,0,b),l.getUpcomingGames(a.ign,1,b)},a.getReleasedList=function(a){function h(a){bw(a,"desc",o.RELEASED)}var b=12;bs.fadeIn(),bo.empty();var c=e().day(0),d=c;for(var f=0,g=b;f<g;f++)m.getReleasedGames(a.gt,d.year(),d.month()+1,d.date(),h),d=d.subtract("weeks",1)},a.resizePanel=function(){var a=null,b=null;switch(C){case p["#searchTab"]:a=bj.height(),b=bh,br.is(":visible")&&(a+=br.height());break;case p["#listTab"]:a=bn.height(),bs.is(":visible")&&(a+=bs.height()),b=bl}var d=c(window).height();if(a<d-J)b.css({height:a+u});else{var e=d-J;b.css({height:e+v})}},a.loggedInView=function(a){a?J=s:J=t};var bw=function(b,c,d){d===B&&a.renderListResults(b,c)},bx=function(b){var d=!1,e={},f={};c("Item",b).each(function(){f=h.parseAmazonResultItem(c(this)),typeof f.isFiltered=="undefined"&&(e[f.id]=f)}),z=e,a.renderSearchResults(z)},by=function(b){var c=b.results,d={},e={};for(var f=0,g=c.length;f<g;f++)e=i.parseGiantBombResultItem(c[f]),i.getGiantBombItemPlatform(e.gbombID,bz),d[e.id]=e;z=d,a.renderSearchResults(z)},bz=function(b,c){var d=b.results.platforms,e=[],f="";for(var g=0,h=d.length;g<h;g++)f=j.matchPlatformToIndex(d[g].name).name||d[g].name,e.push(f);bA(c,e);var i=a.getSearchResult(c);i.platformList=e,i.platform=e[0]},bA=function(a,b){var d={platformList:b,gbombID:a};c("#"+a).find(".platformDropdown").html(bv(d))},bB=function(a,b){var c=Date.parse(a.releaseDate),d=Date.parse(b.releaseDate);return d-c};a.getSearchResult=function(a){return z[a]};var bC=function(a){switch(a){case 0:bh.nanoScroller({scrollTop:D-1}),bJ(!0),bK(!1),bD();break;case 1:bl.nanoScroller({scrollTop:parseInt(E-1,10)}),bK(!0),bJ(!1),bE()}},bD=function(){var b=P.attr("data-content");switch(b){case"0":A=j.SEARCH_PROVIDERS.Amazon,R.text("Amazon"),T.show();break;case"1":A=j.SEARCH_PROVIDERS.GiantBomb,R.text("GiantBomb"),T.hide()}a.search(x)},bE=function(){var a=parseInt(Q.attr("data-content"),10);if(a!==B){switch(a){case 0:bL(0,!0),bq.fadeTo(100,.35),S.text("Popular"),B=o.POPULAR;break;case 1:bL(I),bq.find("button:eq("+I+")").button("toggle"),bq.fadeTo(100,1),S.text("Upcoming"),B=o.UPCOMING;break;case 2:bL(I),bq.find("button:eq("+I+")").button("toggle"),bq.fadeTo(100,1),S.text("Released"),B=o.RELEASED}bI(B)}},bF=function(a,b){Y.text(b),G=j.getStandardPlatform(a),bI(B)},bG=function(b,c){y="",X.text(c),F=j.getStandardPlatform(b),a.search(x)},bH=function(a){switch(a){case 0:bb.tab("show");break;case 1:bc.tab("show")}},bI=function(b){switch(b){case o.POPULAR:a.getGamestatsPopularityListByPlatform(G);break;case o.UPCOMING:a.getIGNUpcomingListByPlatform(G);break;case o.RELEASED:a.getReleasedList(G)}},bJ=function(a){a?(bp.show(),T.show(),P.show()):(bp.hide(),T.hide(),P.hide())},bK=function(a){a?(bq.show(),W.show(),Q.show()):(bq.hide(),W.hide(),Q.hide())},bL=function(a,b){C===p["#searchTab"]?(H=a,bj.find("tbody").removeClass().addClass("display-"+a)):bn.find("tbody").hasClass("display-"+a)===!1&&(typeof b=="undefined"&&(I=a),bn.find("tbody").removeClass().addClass("display-"+a))},bM=function(){clearTimeout(w),a.search(x)},bN=function(b){x=bk.val(),w&&clearTimeout(w),b.which==13?a.search(x):w=setTimeout(bM,q)},bO=function(){var b=a.getSearchResult(c(this).attr("id"));g.viewFirstSearchItemDetail(b)},bP=function(){bS(),x=n.standardizeTitle(c(this).find(".itemName").text()),bH(p["#searchTab"]),bk.val(x),bG(G.id),a.search(x)},bQ=function(b){var d=a.getSearchResult(c(b).attr("data-content"));d.platform=c(b).find("a").text(),c(b).parent().siblings(".dropdown-toggle").html(d.platform).append('<b class="caret"></b>')},bR=function(a){a?(bg.show(),bf.addClass("hover")):(bg.hide(),bf.removeClass("hover"))},bS=function(){C===p["#searchTab"]?D=bi.scrollTop()||1:C===p["#listTab"]&&(E=bm.scrollTop()||1)},bT=function(a,b){var d=c(a.elm).find(".releaseDate"),e=c(b.elm).find(".releaseDate"),f=Date.parse(d.text()),g=Date.parse(e.text());return f-g},bU=function(a,b){var d=c(a.elm).find(".releaseDate"),e=c(b.elm).find(".releaseDate"),f=Date.parse(d.text()),g=Date.parse(e.text());return g-f}}(tmz.module("searchView"),tmz,jQuery,_,moment,List),function(a,b,c,d,e){var f=b.module("user"),g=b.module("tagView"),h=b.module("utilities"),i=b.module("searchView"),j=b.module("itemView"),k=b.module("itemData"),l=b.module("amazon"),m=b.module("itemLinker"),n=b.module("metacritic"),o=b.module("giantbomb"),p=b.module("wikipedia"),q=b.module("gameTrailers"),r=b.module("videoPanel"),s=["#amazonTab","#giantBombTab"],t={0:"None",1:"Own",2:"Sold",3:"Wanted"},u={0:"Not Started",1:"Playing",2:"Played",3:"Finished"},v={NEW:0,EXISTING:1},w=!1,x=null,y=s[0],z=null,A=!1,B=v.NEW,C=null,D={},E={},F={},G=null,H=null,I=c("#detailTabContent"),J=c("#amazonTab"),K=c("#giantBombTab"),L=c("#amazonTabLink"),M=c("#giantBombTabLink"),N=J.find(".itemDetailThumbnail"),O=K.find(".itemDetailThumbnail"),P=N.find(".itemDetailInfo"),Q=O.find(".itemDetailInfo"),R=I.find(".showVideo_btn"),S=I.find(".showDiscussion_btn"),T=c("#detailContainer"),U=c("#addListContainer"),V=c("#addList"),W=c("#saveItem_btn"),X=c("#addItem_btn"),Y=c("#itemAttributes"),Z=c("#platform"),$=c("#releaseDate"),_=c("#wikipediaPage"),ba=c("#gametrailersPage"),bb=c("#giantBombPage"),bc=c("#metacriticPage"),bd=Y.find("#amazonPriceHeader"),be=Y.find("#amazonPriceNew"),bf=Y.find("#amazonPriceUsed"),bg=c("#gameStatus"),bh=c("#playStatus"),bi=c("#userRating"),bj=c("#ratingCaption"),bk=d.template(c("#description-modal-template").html());a.init=function(){a.createEventHandlers(),W.hide(),Y.hide(),bD(),bi.stars({split:2,captionEl:bj,callback:function(a,b,c){D.userRating=c,bM(D)}})},a.createEventHandlers=function(){L.click(function(a){a.preventDefault(),a.stopPropagation(),bC(h.SEARCH_PROVIDERS.Amazon)}),M.click(function(a){a.preventDefault(),a.stopPropagation(),bC(h.SEARCH_PROVIDERS.GiantBomb)}),R.click(function(a){a.preventDefault(),A&&r.showVideoPanel()}),S.click(function(a){a.preventDefault(),bq()}),N.click(function(a){}),O.click(function(a){}),N.mouseenter(function(a){C&&clearTimeout(C),C=setTimeout(function(){P.stop().fadeIn()},250)}),N.mouseleave(function(a){C&&clearTimeout(C),P.stop().fadeOut()}),O.mouseenter(function(a){C&&clearTimeout(C),C=setTimeout(function(){Q.stop().fadeIn()},250)}),O.mouseleave(function(a){C&&clearTimeout(C),Q.stop().fadeOut()}),W.click(function(a){a.preventDefault(),bK(D)}),X.click(function(a){a.preventDefault(),bK(D)}),bg.find("li a").click(function(a){a.preventDefault(),D.gameStatus=c(this).attr("data-content"),bg.find(".currentSelection").text(t[D.gameStatus]),bM(D)}),bh.find("li a").click(function(a){a.preventDefault(),D.playStatus=c(this).attr("data-content"),bh.find(".currentSelection").text(u[D.playStatus]),bM(D)}),c('#detailTab a[data-toggle="tab"]').on("shown",function(a){y=c(a.target).attr("href")}),V.change(bR)},a.viewFirstSearchItemDetail=function(a){if(a.id!==D.id||a.platform!==D.platform)bB(),bD(),D=c.extend(!0,{},a),x=bF(D.asin,D.gbombID),D.initialProvider=x,D.standardName=m.standardizeTitle(D.name),F=k.getItemByThirdPartyID(D.gbombID,D.asin),z=D.id,bE(x),bC(x),m.findItemOnAlternateProvider(D,x,!0,function(a){return function(b){bm(b,a)}}(z),!0),bH(D,F),bI(D,F),bl(D,!0),bn(D,x,0)},a.viewItemDetail=function(b){bB(),bD(),bG(v.EXISTING),D=c.extend(!0,{},b),D.standardName=m.standardizeTitle(D.name),x=parseInt(D.initialProvider,10),F=k.getDirectoryItemByItemID(D.itemID),z=D.id,bE(x),bC(x),m.getLinkedItemData(D,x,a.viewSecondItemDetail),g.selectTagsFromDirectory(F.tags),bI(D,F),bl(D,!1),bo(D,x,0,b)},a.viewSecondItemDetail=function(a){E=c.extend(!0,{},a);var b=null;if(D.asin==E.asin||D.gbombID==E.gbombID)b=bF(E.asin,E.gbombID),bo(E,b,1)},a.resetDetail=function(a){g.resetAddList(),bG(v.NEW)},a.getViewingItemID=function(){return D.id};var bl=function(a,b){p.getWikipediaPage(a.standardName,a,bv),bu(a.standardName,a,b),q.getGametrailersPage(a.standardName,a,bw)},bm=function(a,b){var d=c.extend(!0,{},a);if(z===b){var e=bF(d.asin,d.gbombID);switch(e){case h.SEARCH_PROVIDERS.Amazon:D.asin=d.asin;break;case h.SEARCH_PROVIDERS.GiantBomb:D.gbombID=d.gbombID}bn(d,e,1)}},bn=function(a,b,c){bs(b,a),br(a,c),bx(b,D)},bo=function(a,b,c,d){bs(b,a),br(D,c),bx(b,D)},bp=function(a,b){b.find(".itemDetailTitle h3").text(a.name),b.find("img").attr("src",a.largeImage)},bq=function(){j.viewDiscussion();var a=D.standardName;DISQUS.reset({reload:!0,config:function(){this.page.identifier=a,this.page.url="http://www.gamedex.net/#!"+a}})},br=function(a,b){Y.is(":visible")||Y.fadeIn(),(a.platform!=="n/a"||b===0)&&Z.find(".data").text(a.platform);if(a.releaseDate!=="1900-01-01"){if(b===0||D.releaseDate==="1900-01-01")D.releaseDate=a.releaseDate,D.calendarDate=e(a.releaseDate,"YYYY-MM-DD").calendar(),$.find(".data").text(D.calendarDate)}else D.releaseDate==="1900-01-01"&&$.find(".data").text("unknown")},bs=function(a,b){w||(c("#dataTab").show(),c(".detailTitleBar").show(),w=!0);switch(a){case h.SEARCH_PROVIDERS.Amazon:bp(b,J);break;case h.SEARCH_PROVIDERS.GiantBomb:bp(b,K)}},bt=function(a){a.find(".itemDetailTitle h3").text("No Match found"),a.find("img").attr("src","http://d2sifwlm28j6up.cloudfront.net/no_selection_placeholder.png")},bu=function(a,b,d){function h(a){if(z===a.id||z===a.asin||z===a.gbombID)for(var b=0,c=s.length;b<c;b++)e=s[b]+" .metascore",n.displayMetascoreData(a.metascorePage,a.metascore,e),bc.show(),bc.find("a").attr("href","http://www.metacritic.com"+a.metascorePage)}var e="";for(var f=0,g=s.length;f<g;f++)e=s[f]+" .metascore",c(e).hide();G=n.getMetascore(a,b,d,h)},bv=function(a){_.show(),_.find("a").attr("href",a)},bw=function(a){ba.show(),ba.find("a").attr("href",a)},bx=function(a,b){switch(a){case h.SEARCH_PROVIDERS.Amazon:l.getAmazonItemOffers(b.asin,b,by);break;case h.SEARCH_PROVIDERS.GiantBomb:o.getGiantBombItemData(b.gbombID,bz)}},by=function(a){(a.buyNowPrice!==""||a.lowestUsedPrice!=="")&&bd.show(),a.buyNowPrice!==""?(be.find("a").attr("href",a.productURL),be.find(".data").text(a.buyNowPrice),be.show()):be.hide(),a.lowestUsedPrice!==""?(bf.find(".data").text(a.lowestUsedPrice),bf.find("a").attr("href",a.offersURLUsed),bf.show()):bf.hide()},bz=function(a){bb.show(),bb.find("a").attr("href",a.site_detail_url),bA(a.videos,D.name)},bA=function(a,b){a.length!==0&&(r.renderVideoModal(a,b),A=!0,R.removeClass("noVideos"),R.find("span").text("Show Videos"))},bB=function(a){A=!1,R.addClass("noVideos"),R.find("span").text("No Videos")},bC=function(a){switch(a){case h.SEARCH_PROVIDERS.Amazon:P.append(T),L.tab("show");break;case h.SEARCH_PROVIDERS.GiantBomb:Q.append(T),M.tab("show")}},bD=function(){_.hide(),bb.hide(),bc.hide(),bd.hide(),be.hide(),bf.hide()},bE=function(a){switch(a){case h.SEARCH_PROVIDERS.Amazon:bt(K);break;case h.SEARCH_PROVIDERS.GiantBomb:bt(J)}},bF=function(a,b){var c=null;return a!==0?c=h.SEARCH_PROVIDERS.Amazon:b!==0&&(c=h.SEARCH_PROVIDERS.GiantBomb),c},bG=function(a){a===v.EXISTING?(B=v.EXISTING,X.hide(),W.hide()):a===v.NEW&&(B=v.NEW,W.hide(),X.show())},bH=function(a,b){b&&b.tagCount>0?(bG(v.EXISTING),a.itemID=b.itemID,g.selectTagsFromDirectory(b.tags)):(bG(v.NEW),g.selectUserTags())},bI=function(a,b){b?(a.gameStatus=b.gameStatus,a.playStatus=b.playStatus,a.userRating=b.userRating):(a.gameStatus="0",a.playStatus="0",a.userRating="0"),bJ(a)},bJ=function(a){bg.find(".currentSelection").text(t[a.gameStatus]),bh.find(".currentSelection").text(u[a.playStatus]),bi.stars("select",a.userRating),bj.text(a.userRating/2),bg.find(".currentSelection").attr("data-initial",a.gameStatus),bh.find(".currentSelection").attr("data-initial",a.playStatus),bi.attr("data-initial",a.userRating)},bK=function(a){var b=g.getTagsToAdd(),c=g.getTagsToDelete(),d=c.idsToDelete,e=c.tagsToDelete;b.length>0&&(H=k.addItemToTags(b,a,bO)),d.length>0&&k.deleteTagsForItem(d,e,a,bP),bL(a),bS()},bL=function(a){(d.isUndefined(a.metascore)||a.metascore===null)&&c.when(G,H).then(function(){k.updateMetacritic(D),j.refreshView()},function(){});if(x!==h.SEARCH_PROVIDERS.Amazon||a.gbombID!==0)x!==h.SEARCH_PROVIDERS.Amazon||a.asin!==0},bM=function(a){bQ()&&B===v.EXISTING&&k.updateUserItem(a,bN)},bN=function(a,b){b.status==="success"&&(bJ(a),j.updateListAttributesChanged(a))},bO=function(a,b){B!==v.EXISTING&&bG(v.EXISTING),j.updateListAdditions(a,b)},bP=function(a,b){j.updateListDeletions(a,b)},bQ=function(){var a=bg.find(".currentSelection").attr("data-initial"),b=bh.find(".currentSelection").attr("data-initial"),c=bi.attr("data-initial");return a!==D.gameStatus||b!==D.playStatus||c!==D.userRating?!0:!1},bR=function(a){w&&!a.reset&&(B===v.NEW&&g.updateUserTags(),bS())},bS=function(){B===v.EXISTING&&g.isAddListChanged()?W.fadeIn():W.fadeOut()}}(tmz.module("detailView"),tmz,jQuery,_,moment),function(a,b,c,d,e){"use strict";var f=b.module("user"),g=b.module("siteView"),h=b.module("tagView"),i=b.module("utilities"),j=b.module("detailView"),k=b.module("importView"),l=b.module("gridView"),m=b.module("itemData"),n=b.module("itemCache"),o=b.module("tagData"),p=b.module("amazon"),q=b.module("metacritic"),r=b.module("itemLinker"),s=b.module("filterPanel"),t=b.module("giantbomb"),u={List:0,Icons:1},v={collection:"collection",discussion:"discussion"},w={alphabetical:0,metascore:1,releaseDate:2,platform:3,price:4},x=230,y=450,z=10,A=50,B=5,C=10,D="0",E="View All",F=null,G={valueNames:["itemName","metascore","releaseDate","platform","gameStatus","playStatus","userRating"],item:"list-item"},H=D,I=u.Icons,J=0,K=!1,L=!1,M=null,N=!1,O=y,P=!1,Q=v.collection,R=c("#wrapper"),S=c("#itemResults"),T=c("#resizeContainer"),U=c("#viewItemsContainer"),V=c("#itemResultsContainer"),W=U.find(".displayOptions"),X=c("#gridView_btn"),Y=c("#showCollection_btn"),Z=c("#viewList"),$=Z.find(".viewName"),_=c("#itemViewMenu"),ba=c("#editMenu"),bb=U.find(".sortOptions"),bc=bb.find(".sortType"),bd=U.find(".filterOptions"),be=c("#platformFilterSubNav"),bf=bd.find(".clearFilters_btn"),bg=bd.find(".filterDropDown_btn"),bh=bd.find(".filterType"),bi=c("#applyFilters_btn"),bj=c("#deleteListConfirm-modal"),bk=c("#deleteListConfirm_btn"),bl=c("#deleteList_btn"),bm=bl.find(".listName"),bn=c("#importMenu"),bo=c("#error-modal"),bp=c("#updateList-modal"),bq=c("#tagNameField"),br=c("#updateListConfirm_btn"),bs=c("#editList_btn"),bt=V.find(".loadingStatus"),bu=null,bv=d.template(c("#price-menu-template").html()),bw=d.template(c("#item-results-template").html());a.init=function(){a.createEventHandlers(),bg.tooltip({delay:{show:500,hide:50}}),W.find("a").each(function(a,b){c(b).tooltip({delay:{show:500,hide:50},placement:"bottom"})});var b={sliderMinHeight:20,iOSNativeScrolling:!0,preventPageScrolling:!0,flash:!0,flashDelay:1500};V.nanoScroller(b),setInterval(function(){V.nanoScroller()},1500),bR(!1),be.BootstrapSubMenu({$mainNav:bd})},a.createEventHandlers=function(){_.on("mouseenter",".dropdown-toggle",function(a){var b=this;_.find(".dropdown").each(function(){c(this).hasClass("open")&&c(this).find(".dropdown-toggle").get(0)!==c(b).get(0)&&c(b).trigger("click")})}),Z.find("ul").on("click","a",function(a){a.preventDefault(),bz(c(this).attr("data-content"))}),bi.click(function(a){a.preventDefault(),R.hasClass("gridView")||(bR(!0),bQ(0))}),bf.click(function(a){a.preventDefault(),bR(!1),bh.text("None"),s.resetFilters(),bQ()}),U.on("click","#itemResults tr",function(a){bG(c(this).attr("id"))}),S.on("click",".deleteItem_btn",function(a){a.preventDefault();var b=c(this).attr("data-content");bH(b)}),S.on("click",".quickAttributes a",function(a){a.preventDefault(),a.stopPropagation();var b=parseInt(c(this).attr("data-content"),10),d=c(this).parent().parent().attr("data-content");bN(c(this),d,b)}),bl.click(function(a){a.preventDefault(),g.hideSiteGuide(),h.getTagCount()>1?bj.modal("show"):(bo.find(".alertTitle").text("Tag Delete Error"),bo.find(".alertText").text("Cannot delete last tag"),bo.modal("show"))}),bk.click(function(a){a.preventDefault(),bj.modal("hide"),bJ(H)}),bp.find("form").submit(function(a){a.preventDefault(),bL(H,bq.val()),bp.modal("hide")}),br.click(function(a){bL(H,bq.val()),bp.modal("hide")}),bs.click(function(a){a.preventDefault(),g.hideSiteGuide();var b=h.getTagName(H);bq.val(b),bp.modal("show"),d.delay(function(){bq.focus().select()},1e3)}),bn.find("li").click(function(a){a.preventDefault(),g.hideSiteGuide(),k.startImport(parseInt(c(this).attr("data-importSource"),10))}),W.find("a").click(function(a){a.preventDefault(),bW(this)}),bb.find("li a").click(function(a){a.preventDefault(),bS(parseInt(c(this).attr("data-content"),10))}),bd.find("li:not(.dropdown-sub) a").click(function(a){a.preventDefault(),M=c(this).attr("data-content"),M=="0"?(g.hideSiteGuide(),s.showFilterPanel()):(bR(!0),bh.text(c(this).text()),bP(M))}),X.click(function(a){a.preventDefault(),g.hideSiteGuide(),by()}),Y.click(function(b){b.preventDefault(),a.viewCollection()}),T.resize(a.resizePanel),c(window).resize(a.resizePanel)};var bx=function(a){var b=0;d.each(a,function(a,c){bC(a),b++});var f={items:a,length:b};f.displayType=I,f.currentViewTagID=H,S.html(bw(f)),b>0&&(S.find(".quickAttributes a").each(function(a,b){c(b).tooltip({delay:{show:750,hide:1},placement:"bottom"})}),d.each(a,function(a,b){bE(a)}),d.each(a,function(a,b){bB(a)}),F=new e("itemResultsContainer",G),bS(J),bQ(),K=!1)};a.getItem=function(a){return m.getItem(a)},a.clearItemView=function(){S.html("")},a.resizePanel=function(){var a=c(window).height(),b=T.height(),d=0,e=0;bt.is(":visible")&&(b+=bt.height()),Q===v.discussion&&(d=A,e=z);if(b-d<a-O)V.css({height:b+B+e});else{var f=a-O;V.css({height:f+C+d})}},a.loggedInView=function(a){a?O=x:O=y},a.initializeUserItems=function(a,b){return H=D,m.getItems(D,a,b)},a.initializeUserItems_result=function(b){m.itemsAndDirectoryLoaded(b),bz(D),c.isEmptyObject(b)?j.resetDetail():a.viewRandomItem()},a.updateListDeletions=function(a,b){var d=null;for(var e=0,f=b.length;e<f;e++)H===D?(d=m.getDirectoryItemByItemID(a).tagCount,d===0&&c("#"+a).remove()):H===b[e]&&c("#"+a).remove()},a.updateListAdditions=function(a,b){var c=!1;h.updateViewList(a.tagIDsAdded,H);if(H!==D)for(var d=0,e=a.tagIDsAdded.length;d<e;d++)a.tagIDsAdded[d]==H&&(c=!0);else m.getDirectoryItemByItemID(a.itemID).tagCount>=1&&(c=!0);c&&bz(H)},a.updateListAttributesChanged=function(a){L=!0},a.showListView=function(a,b,c,d){M=b,bz(a),bh.text(c),bR(d)},a.viewDiscussion=function(){Q=v.discussion,U.removeClass().addClass(Q)},a.viewCollection=function(){Q=v.collection,U.removeClass().addClass(Q)},a.refreshView=function(){bA(H)};var by=function(){l.showGridView(H,M,bh.text(),P)},bz=function(a){var b="";a!==D?(b=h.getTagName(a),bm.text(b),ba.show()):(b=E,ba.hide()),$.text(b),bA(a)},bA=function(a,b){H=a,m.getItems(a,function(a){bx(a),b&&b()},function(){bx({})})},bB=function(a){typeof bB.getAmazonItemOffersLimited=="undefined"&&(bB.getAmazonItemOffersLimited=function(a){p.getAmazonItemOffers(a.asin,a,function(b){bD(a.id,b)})}.lazy(250,2e3)),bB.getAmazonItemOffersLimited(a),(a.metascore===null||a.metascorePage===null)&&q.getMetascore(a.standardName,a,!1,bF)},bC=function(a){var b=m.getDirectoryItemByItemID(a.itemID);b&&(a.gameStatus=b.gameStatus,a.playStatus=b.playStatus,a.userRating=b.userRating)},bD=function(a,b){if(typeof b.productURL!="undefined"){var d="#"+a+" .priceDetails";c(d).html(bv(b))}},bE=function(a){a.metascore===-1?a.displayMetascore="n/a":a.displayMetascore=a.metascore,bF(a)},bF=function(a){var b="#"+a.id+" .metascore";q.displayMetascoreData(a.metascorePage,a.metascore,b)};a.viewRandomItem=function(){var a=m.getRandomItemID();bG(a)};var bG=function(b){var c=a.getItem(b);j.viewItemDetail(c)},bH=function(a){var b=m.deleteSingleTagForItem(a,H,bI);j.getViewingItemID()===a&&h.removeTagFromAddList(H),c("#"+a).remove()},bI=function(a){},bJ=function(a){h.deleteTag(a,function(){bK()})},bK=function(){bz(D)},bL=function(a,b){o.updateTag(b,a,function(a){}),h.getTags(function(a){h.getTags_result(a)}),bM(b,a)},bM=function(a,b){$.text(a),bq.val(a)},bN=function(b,c,d){var e=a.getItem(c);L=!0;switch(d){case 0:e.playStatus==="1"?(bO(b,"0"),b.parent().removeClass().addClass("playStatus-0"),e.playStatus="0"):(bO(b,"1"),b.parent().removeClass().addClass("playStatus-1"),e.playStatus="1");break;case 1:e.playStatus==="2"?(bO(b,"0"),b.parent().removeClass().addClass("playStatus-0"),e.playStatus="0"):(bO(b,"2"),b.parent().removeClass().addClass("playStatus-2"),e.playStatus="2");break;case 2:e.playStatus==="3"?(bO(b,"0"),b.parent().removeClass().addClass("playStatus-0"),e.playStatus="0"):(bO(b,"3"),b.parent().removeClass().addClass("playStatus-3"),e.playStatus="3");break;case 3:e.userRating==="10"?(b.parent().removeClass("rating-10"),e.userRating="0"):(b.parent().removeClass().addClass("rating-10"),e.userRating="10");break;case 4:e.gameStatus==="1"?(b.parent().removeClass().addClass("gameStatus-0"),e.gameStatus="0"):(b.parent().removeClass().addClass("gameStatus-1"),e.gameStatus="1")}m.updateUserItem(e,function(a,b){j.viewItemDetail(a)})},bO=function(a,b){a.parent().parent().find('span[class*="playStatus"]').each(function(){c(this).removeClass().addClass("playStatus-"+b)})},bP=function(a){var b=parseInt(a,10);s.resetFilters();if(isNaN(a))s.platformQuickFilter(a);else switch(b){case 1:bS(w.releaseDate),s.upcomingQuickFilter(F);break;case 2:bS(w.releaseDate),s.newReleasesQuickFilter(F);break;case 3:bS(w.metascore),s.neverPlayedQuickFilter(F);break;case 4:bS(w.metascore),s.gamesPlayingQuickFilter(F);break;case 5:bS(w.metascore),s.gamesPlayedQuickFilter(F);break;case 6:bS(w.metascore),s.finishedGamesQuickFilter(F);break;case 7:bS(w.metascore),s.ownedGamesQuickFilter(F);break;case 8:bS(w.metascore),s.wantedGamesQuickFilter(F)}bQ(b)},bQ=function(a){a===0&&bh.text("Custom");if(L)L=!1,bz(H,function(){var a=s.applyListJSFiltering(F)});else var b=s.applyListJSFiltering(F)},bR=function(a){P=a,a?(bf.show(),bf.next().show()):(bf.hide(),bf.next().hide())},bS=function(a){J=a;switch(J){case w.alphabetical:bc.text("Alphabetical"),F.sort("itemName",{asc:!0});break;case w.metascore:bc.text("Review Score"),F.sort("scoreDetails",{sortFunction:bT});break;case w.releaseDate:bc.text("Release Date"),F.sort("releaseDate",{sortFunction:bV});break;case w.platform:bc.text("Platform"),F.sort("platform",{asc:!0});break;case w.price:bc.text("Price"),F.sort("priceDetails",{sortFunction:bU})}},bT=function(a,b){var d=c(a.elm).find(".metascore"),e=c(b.elm).find(".metascore"),f=parseInt(d.attr("data-score"),10),g=parseInt(e.attr("data-score"),10);return f<g?1:-1},bU=function(a,b){var d=c(a.elm).find(".priceDetails .lowestNew"),e=c(b.elm).find(".priceDetails .lowestNew"),f=0,g=0;return d.length>0&&(f=parseFloat(d.attr("data-price"))),e.length>0&&(g=parseFloat(e.attr("data-price"))),f<g?-1:1},bV=function(a,b){var d=c(a.elm).find(".releaseDate"),e=c(b.elm).find(".releaseDate"),f=Date.parse(d.text()),g=Date.parse(e.text());return g-f},bW=function(a){var b=c(a).attr("data-content");I!==b&&(I=b,S.find("tbody").removeClass().addClass("display-"+I),V.nanoScroller())}}(tmz.module("itemView"),tmz,jQuery,_,List),function(a,b,c,d){"use strict";var e=b.module("detailView"),f=b.module("itemData"),g=b.module("itemView"),h=b.module("tagView"),i=b.module("amazon"),j=b.module("utilities"),k=b.module("filterPanel"),l=1,m={itemName:0,metacriticScore:1,releaseDate:2,platform:3,rawPrice:4},n=null,o=0,p=null,q=!0,r=null,s=!1,t=c("#wrapper"),u=c("#gridViewContainer"),v=c("#gridList"),w=v.find(".viewName"),x=c("#gridViewMenu"),y=x.find(".grid_displayOptions"),z=y.find(".displayType"),A=x.find(".sortOptions"),B=A.find(".sortType"),C=x.find(".filterOptions"),D=C.find(".clearFilters_btn"),E=C.find(".filterType"),F=C.find(".filterDropDown_btn"),G=C.find(".listFilters_btn"),H=c("#applyFilters_btn"),I=c("#filters-modal"),J=d.template(c("#grid-results-template").html()),K={},L=!1,M=null;a.init=function(){N(),F.tooltip({delay:{show:500,hide:50},placement:"bottom"}),y.find("div").each(function(a,b){c(b).tooltip({delay:{show:500,hide:50},placement:"bottom"})}),bd(!1)};var N=function(a){x.on("mouseenter",".dropdown-toggle",function(a){var b=this;x.find(".dropdown").each(function(){c(this).hasClass("open")&&c(this).find(".dropdown-toggle").get(0)!==c(b).get(0)&&c(b).trigger("click")})}),c("#exitGridView_btn").click(function(a){a.preventDefault(),P()}),G.click(function(a){a.preventDefault(),I.modal("show")}),D.click(function(a){a.preventDefault(),bd(!1),E.text("None"),k.resetFilters(),X()}),H.click(function(a){a.preventDefault(),X(),bd(!0)}),v.find("ul").on("click","a",function(a){a.preventDefault(),Q(c(this).attr("data-content"))}),u.on("click",".gridItem img",function(a){a.preventDefault(),V(c(this).parent().parent().attr("data-content"))}),u.on("mouseover",".gridItem",function(a){a.preventDefault();var b=c(this),d=b.attr("data-content"),e=K[d];e||(e=b.width(),K[d]=e);var f=Math.round((e*1.2-e)/2);b.css({"z-index":"999",width:e*1.2+"px","-webkit-transition-timing-function":"cubic-bezier(0.01,0.53,0.00,1.00)","-webkit-transition-property":"top,left,width","-webkit-transition-duration":"1s"})}),u.on("mouseout",".gridItem",function(a){a.preventDefault();var b=c(this);b.css({"z-index":"",width:"","-webkit-transition-timing-function":"cubic-bezier(0.01,0.53,0.00,1.00)","-webkit-transition-property":"top,left,width","-webkit-transition-duration":"1s"})}),y.find("li a").click(function(a){a.preventDefault(),z.text(c(this).text()),be(c(this).attr("data-content"))}),A.find("li a").click(function(a){a.preventDefault(),Y(c(this).attr("data-content"))}),C.find("li a").click(function(a){a.preventDefault(),r=parseInt(c(this).attr("data-content"),10),r===0?k.showFilterPanel():(bd(!0),E.text(c(this).text()),W(parseInt(c(this).attr("data-content"),10)))})};a.showGridView=function(a,b,c,d){t.removeClass("standardView"),t.addClass("gridView"),r=b,O(a),R(a),E.text(c),bd(d)};var O=function(a){var b=v.find('a[data-content="'+a+'"]');v.find(".viewName").text(b.text())},P=function(){t.removeClass("gridView"),t.addClass("standardView"),g.showListView(n,r,E.text(),s)},Q=function(a){n=a,O(a),R(a)},R=function(a){n=a,u.hide(),L&&u.isotope("destroy"),f.getItems(a,S)},S=function(a){T(a)},T=function(a){var b={items:a};u.html(J(b)),U(),u.imagesLoaded(function(){u.show(),U(),X()})},U=function(){L=!0,u.isotope({itemSelector:".gridItem",getSortData:{itemName:Z,releaseDate:$,platform:_,userRating:ba,metacriticScore:bb,rawPrice:bc},sortBy:"itemName",sortAscending:!0,transformsEnabled:!1})},V=function(a){var b=f.getItem(a);e.viewItemDetail(b)},W=function(a){bf();var b=parseInt(a,10);k.resetFilters();switch(b){case 1:k.upcomingQuickFilter(),B.text("Release Date"),p="releaseDate",q=!0;break;case 2:k.newReleasesQuickFilter(),B.text("Release Date"),p="releaseDate",q=!1;break;case 3:k.neverPlayedQuickFilter(),B.text("Review Score"),p="metacriticScore",q=!1;break;case 4:k.gamesPlayingQuickFilter(),B.text("Review Score"),p="metacriticScore",q=!1;break;case 5:k.gamesPlayedQuickFilter(),B.text("Review Score"),p="metacriticScore",q=!1;break;case 6:k.finishedGamesQuickFilter(),B.text("Review Score"),p="metacriticScore",q=!1;break;case 7:k.ownedGamesQuickFilter(),B.text("Review Score"),p="metacriticScore",q=!1;break;case 8:k.wantedGamesQuickFilter(),B.text("Review Score"),p="metacriticScore",q=!1}X()},X=function(){r===0&&E.text("Custom"),bd(k.applyIsotopeFiltering(u,p,q))},Y=function(a){bf(),o=parseInt(a,10);switch(o){case m.itemName:B.text("Alphabetical"),p="itemName",u.isotope({sortBy:p,sortAscending:!0});break;case m.metacriticScore:B.text("Review Score"),p="metacriticScore",u.isotope({sortBy:p,sortAscending:!1});break;case m.releaseDate:B.text("Release Date"),p="releaseDate",u.isotope({sortBy:p,sortAscending:!1});break;case m.platform:B.text("Platform"),p="platform",u.isotope({sortBy:p,sortAscending:!0});break;case m.rawPrice:B.text("Price"),p="rawPrice",u.isotope({sortBy:p,sortAscending:!0})}},Z=function(a){return a.find(".itemName").text()},$=function(a){return a.find(".releaseDate").text()},_=function(a){return a.find(".platform").text()},ba=function(a){return parseInt(a.find(".userRating").text(),10)},bb=function(a){return parseInt(a.find(".metacriticScore").text(),10)},bc=function(a){return parseInt(a.find(".rawPrice").text(),10)},bd=function(a){s=a,a?(D.show(),D.next().show()):(D.hide(),D.next().hide())},be=function(a){bf(),K={},M!==a&&(u.removeClass("display-"+M).addClass("display-"+a),M=a,u.isotope("reLayout",function(){}))},bf=function(a){c(".gridItem").each(function(a,b){c(b).css({"z-index":"","-webkit-transition-property":""})})}}(tmz.module("gridView"),tmz,jQuery,_),function(a,b,c,d){"use strict";var e=b.module("user"),f=b.module("tagData"),g=b.module("itemData"),h=b.module("itemCache"),i=c("#addListContainer"),j=c("#addList"),k=c("#viewList"),l=c("#gridList"),m={},n={},o={},p={},q={},r={},s=[],t=d.template(c("#view-list-template").html()),u=function(){v()},v=function(){j.change(function(a){var b=j.val().split(","),c=b[b.length-1];c!==""&&E(c)})},w=function(a,b){return O(),f.getTags(a,b)},x=function(a){S(),T(a),y(),N()},y=function(){var a=[],b=[];d.each(n,function(b,c){a.push(b)}),d.each(o,function(a,c){b.push(a)}),a.sort(U);var c={orderedList:a,emptyList:b};k.find("ul").html(t(c)),l.find("ul").html(t(c))},z=function(a){return p[a]},A=function(){var a=0;return d.each(m,function(b){a++}),a},B=function(){var a=[],b=Q();return d.each(b,function(b){d.has(r,b)||(r[b]="placeholder",a.push(b))}),a},C=function(){var a=[],b=[],c=Q();return d.each(r,function(e,f){d.indexOf(c,f)===-1&&(delete r[f],b.push(f),a.push(e))}),{idsToDelete:a,tagsToDelete:b}},D=function(a,b){for(var c=0,d=b.length;c<d;c++)r[a[c]]=b[c]},E=function(a,b){if(!d.has(m,a))f.addTag(a,function(a){P(a),b&&b(a)});else if(b){var c={tagID:m[a].id,tagName:m[a].name};b(c)}},F=function(a,b){var c=h.getCachedItemsByTag(a);d.each(c,function(b,c){g.deleteClientItem(a,b.itemID),g.deleteTagFromDirectory(b.itemID,a)}),G(a),h.deleteCachedTag(a),f.deleteTag(a),w(function(a){x(a)}),b()},G=function(a){delete r[a],R(r)},H=function(a){r={};var b=null;d.each(a,function(a,b){r[b]=a}),R(a)},I=function(){s=j.val().split(",")},J=function(){r={},j.val(s).trigger({type:"change",reset:!1})},K=function(a,b){var c=!1;for(var d=0,e=a.length;d<e;d++)typeof q[a[d]]=="undefined"&&(q[a[d]]=!0,delete o[p[a[d]]],n[p[a[d]]]={id:a[d],name:p[a[d]]},c=!0);return c&&y(),c},L=function(){r={},s=[],j.val([""]).trigger({type:"change",reset:!0})},M=function(){var a=!1,b=Q();return d.each(b,function(b){d.has(r,b)||(a=!0)}),d.each(r,function(c,e){d.indexOf(b,e)===-1&&(a=!0)}),a},N=function(){var a=[],b=[];d.each(m,function(c,d){a.push(c),b.push(c.name)}),a.sort(U),j.select2({tags:b,placeholder:"Type a tag name",allowClear:!0})},O=function(){m={},n={},o={},p={},q={},r={},s=[]},P=function(a){var b={name:a.tagName.toLowerCase(),id:a.tagID};m[b.name]=b,o[b.name]=b,p[b.id]=b.name,y(),N(),i.find(".select2-search-field input").focus()},Q=function(){var a=j.val(),b=[];return a!==""&&d.each(a.split(","),function(a){d.has(m,a)?b.push(m[a].id):b.push(a)}),b},R=function(a){var b=[];d.each(a,function(a,c){var d=z(c);b.push(d)}),j.val(b).trigger({type:"change",reset:!1})},S=function(){var a=g.getItemDirectory();q={},d.each(a,function(a,b){d.each(a.tags,function(a,b){typeof q[b]=="undefined"&&(q[b]=!0)})})},T=function(a){var b={};for(var c=0,d=a.length;c<d;c++)b={},b.name=a[c].tagName.toLowerCase(),b.id=a[c].tagID,typeof q[b.id]!="undefined"?n[b.name]=b:o[b.name]=b,m[b.name]=b,p[b.id]=b.name},U=function(a,b){var c=a.name,d=b.name;return c.toLowerCase().localeCompare(d.toLowerCase())},V={init:u,getTags:w,getTags_result:x,renderViewLists:y,getTagName:z,getTagCount:A,getTagsToAdd:B,getTagsToDelete:C,updateInitialItemTags:D,addTag:E,deleteTag:F,removeTagFromAddList:G,selectTagsFromDirectory:H,updateUserTags:I,selectUserTags:J,updateViewList:K,resetAddList:L,isAddListChanged:M};c.extend(a,V)}(tmz.module("tagView"),tmz,jQuery,_),function(a,b,c,d,e){"use strict";var f=b.module("utilities"),g=c("#filters-modal"),h=c("#releaseDate_filter"),i=c("#gameStatus_filter"),j=c("#playStatus_filter"),k=c("#metascore_filter"),l=c("#platformFilterList");a.init=function(){a.createEventHandlers(),l.select2({placeholder:"Select platform",allowClear:!0})},a.createEventHandlers=function(){g.on("click",".btn-group button",function(a){a.preventDefault()})},a.showFilterPanel=function(){g.modal("show")},a.getFilters=function(){var a={};a.releaseDateFilters=[],a.metascoreFilters=[],a.platformFilters=[],a.gameStatusFilters=[],a.playStatusFilters=[],h.find("button").each(function(){c(this).hasClass("active")?a.releaseDateFilters.push(!0):a.releaseDateFilters.push(!1)}),k.find("button").each(function(){c(this).hasClass("active")?a.metascoreFilters.push(!0):a.metascoreFilters.push(!1)}),i.find("button").each(function(){c(this).hasClass("active")?a.gameStatusFilters.push(!0):a.gameStatusFilters.push(!1)}),j.find("button").each(function(){c(this).hasClass("active")?a.playStatusFilters.push(!0):a.playStatusFilters.push(!1)});var b=l.val(),e=[];return b&&b!==""&&(e=b.split(",")),d.each(e,function(b,c){a.platformFilters[c]=f.getStandardPlatform(b)}),a},a.applyListJSFiltering=function(b){var c=a.getFilters(),d=!1;return b.filter(function(b){var e=a.releaseDateFilter(b.releaseDate,c.releaseDateFilters),f=a.metascoreFilter(b.metascore,c.metascoreFilters),g=a.platformFilter(b.platform,c.platformFilters),h=a.gameStatusFilter(b.gameStatus,c.gameStatusFilters),i=a.playStatusFilter(b.playStatus,c.playStatusFilters);return e&&f&&g&&i&&h?!0:(d=!0,!1)}),d},a.applyIsotopeFiltering=function(b,d,e){var f=a.getFilters(),g=!1,h=c(".gridItem").filter(function(b){var d=c(this),e=d.find(".releaseDate").text(),h=a.releaseDateFilter(e,f.releaseDateFilters),i=d.find(".metacriticScore").text(),j=a.metascoreFilter(i,f.metascoreFilters),k=d.find(".platform .data").text(),l=a.platformFilter(k,f.platformFilters),m=d.find(".gameStatus").text(),n=a.gameStatusFilter(m,f.gameStatusFilters),o=d.find(".playStatus").text(),p=a.playStatusFilter(o,f.playStatusFilters);return h&&n&&p&&j&&l?!0:(g=!0,!1)});return b.isotope({filter:h,sortBy:d,sortAscending:e}),g},a.resetFilters=function(){h.find("button").each(function(){c(this).removeClass("active")}),k.find("button").each(function(){c(this).removeClass("active")}),i.find("button").each(function(){c(this).removeClass("active")}),j.find("button").each(function(){c(this).removeClass("active")}),l.val([""]).trigger("change")},a.upcomingQuickFilter=function(a){h.find('button[data-content="0"]').addClass("active")},a.newReleasesQuickFilter=function(a){h.find('button[data-content="1"]').addClass("active")},a.neverPlayedQuickFilter=function(a){j.find('button[data-content="0"]').addClass("active")},a.gamesPlayingQuickFilter=function(a){j.find('button[data-content="1"]').addClass("active")},a.gamesPlayedQuickFilter=function(a){j.find('button[data-content="2"]').addClass("active")},a.finishedGamesQuickFilter=function(a){j.find('button[data-content="3"]').addClass("active")},a.ownedGamesQuickFilter=function(a){i.find('button[data-content="1"]').addClass("active")},a.wantedGamesQuickFilter=function(a){i.find('button[data-content="3"]').addClass("active")},a.platformQuickFilter=function(a){l.val(a).trigger("change")},a.releaseDateFilter=function(a,b){var c=b[0],d=b[1],f=null;a==="1900-01-01"?f=e().add("days",1):f=e(a,"YYYY-MM-DD");var g=e(),h=f.diff(g,"seconds");return c&&d?!0:!c&&!d?!0:c&&h>0?!0:d&&h<0?!0:!1},a.gameStatusFilter=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3];return c&&d&&e&&f?!0:!c&&!d&&!e&&!f?!0:c&&a==="0"?!0:d&&a==="1"?!0:e&&a==="2"?!0:f&&a==="3"?!0:!1},a.playStatusFilter=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3];return c&&d&&e&&f?!0:!c&&!d&&!e&&!f?!0:c&&a==="0"?!0:d&&a==="1"?!0:e&&a==="2"?!0:f&&a==="3"?!0:!1},a.metascoreFilter=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=parseInt(a,10);return c&&d&&e&&f&&g&&h&&i?!0:!c&&!d&&!e&&!f&&!g&&!h&&!i?!0:c&&j>=90?!0:d&&j>=80&&j<90?!0:e&&j>=70&&j<80?!0:f&&j>=60&&j<70?!0:g&&j>=50&&j<60?!0:h&&j>=25&&j<50?!0:i&&j>=0&&j<25?!0:!1},a.platformFilter=function(a,b){if(b.length===0)return!0;for(var c=0,d=b.length;c<d;c++)if(b[c].name===a)return!0;return!1}}(tmz.module("filterPanel"),tmz,$,_,moment),function(a,b,c,d,e,f){"use strict";var g="http://media.giantbomb.com/video/",h="videoPlayer",i=91,j=5,k=!1,l=0,m=null,n=0,o=0,p=0,q=[],r=null,s=d("#video-modal"),t=d("#videoListContainer"),u=d("#videoList"),v=d("#videoPlayer"),w=d("#videoModalTitle"),x=d("#videoListNavigation"),y=x.find(".navigateLeft"),z=x.find(".navigateRight"),A=x.find(".pageNumber"),B=e.template(d("#video-results-template").html());a.init=function(){r=b(h),a.createEventHandlers(),s.modal({backdrop:!0,show:!1})},a.createEventHandlers=function(){u.on("click","li",function(a){a.preventDefault();var b=d(this).attr("data-id");E(Number(b)),F()}),y.click(function(a){J()}),z.click(function(a){K()}),s.on("hidden",function(){G()}),r.addEvent("ended",D)},a.showVideoPanel=function(){k&&(k=!1,E(0)),d("html, body").scrollTop(0),s.modal("show"),F()},a.renderVideoModal=function(a,b){k=!0,q=d.extend(!0,[],a);if(q.length!==0){n=q.length,m=null,o=0,C(q);var c={videoResults:q};u.html(B(c)),w.text(b),l=0,M(0),I()}q.length<=j&&H()};var C=function(a){for(var b=0,c=a.length;b<c;b++){a[b].publishDate=f(a[b].publish_date,"YYYY-MM-DD").calendar(),delete a[b].publish_date;var d=Math.floor(a[b].length_seconds/60),e=(a[b].length_seconds%60).toString();e.length===1&&(e="0"+e),delete a[b].length_seconds,a[b].runningTime=d+":"+e}},D=function(){o===n-1?o=0:o++,E(o);if(o%j===0){var a=Math.floor(o/j);M(a)}F()},E=function(a){o=a;var b=q[a].url,c=u.find('li[data-id="'+a+'"]'),d=u.find('li[data-id="'+p+'"]');d.removeClass("playing"),c.addClass("playing");var e=b.split("."),f=g+e[0]+"_3500."+e[1];r.src(f),p=a},F=function(){r.play()},G=function(){r.pause()},H=function(){x.hide()},I=function(){x.show()},J=function(){var a=L();l>0?M(--l):M(a)},K=function(){var a=L();l<a?M(++l):M(0)},L=function(){return m||(m=Math.ceil(n/j)-1),m},M=function(a){var b=-(a*i);l=a,u.stop().animate({top:b},250,function(){}),A.text(Number(a+1)+" / "+Number(L()+1))}}(tmz.module("videoPanel"),_V_,tmz,jQuery,_,moment),function(a,b,c,d,e){"use strict";var f=b.module("utilities"),g=["accessory","case","codes","combo","console","controller","covers","face plate","faceplate","head set","headset","import","japan","kit","map","membership","new","pack","poster","pre-paid","set","shell","skin","software","stylus","wireless"],h=b.api+"amazon/search/",i=b.api+"amazon/detail/",j={},k={},l={},m={},n=null,o=0;a.searchAmazon=function(a,b,d,e,f){f=typeof f!="undefined"?f:!1;var g=encodeURIComponent(a),i={keywords:a,browse_node:b,search_index:"VideoGames",response_group:"ItemAttributes,Images",page:1};n&&f&&n.abort();var j=++o;return n=c.ajax({url:h,type:"GET",data:i,dataType:"xml",cache:!0,success:function(a){if(j===o||!f)n=null,d(a)},error:function(){e()}}),n},a.parseAmazonResultItem=function(a){var b=!1,c="("+g.join("|")+")",d=new RegExp(c,"i"),h={name:a.find("Title").text(),platform:a.find("Platform").text()};return d.test(h.name)||h.platform===""?h.isFiltered=!0:(h.id=a.find("ASIN").text(),h.asin=a.find("ASIN").text(),h.gbombID=0,h.smallImage=a.find("ThumbnailImage > URL:first").text()||"",h.thumbnailImage=a.find("MediumImage > URL:first").text()||"",h.largeImage=a.find("LargeImage > URL:first").text()||"",h.description=a.find("EditorialReview > Content:first").text()||"",h.releaseDate=a.find("ReleaseDate").text()||"1900-01-01",h.platform=f.matchPlatformToIndex(h.platform).name,h.releaseDate!=="1900-01-01"?h.calendarDate=e(h.releaseDate,"YYYY-MM-DD").calendar():h.calendarDate="Unknown"),h},a.getAmazonItemDetail=function(a,b,e){var f=r(a);if(f)b(f);else{d.has(m,a)||(m[a]=[]),m[a].push(b);if(m[a].length===1){var g={asin:a,response_group:"Medium"};c.ajax({url:i,type:"GET",data:g,dataType:"xml",cache:!0,success:function(b){d.each(m[a],function(c){k[a]=b,c(b)}),m[a]=[]},error:e})}}},a.getAmazonItemOffers=function(a,b,e,f){var g=q(a);if(g)b.offers=g,e(g);else{d.has(l,a)||(l[a]=[]),l[a].push(e);if(l[a].length===1){var h={asin:a,response_group:"OfferFull"};c.ajax({url:i,type:"GET",data:h,dataType:"xml",cache:!0,success:function(c){d.each(l[a],function(d){var e=s(c,b);j[a]=e,d(e)}),l[a]=[]},error:f})}}};var p=function(a){var b=null,c=null;for(var d=0,e=a.offers.length;d<e;d++)a.offers[d].availability==="now"&&(b=a.offers[d].price,c=a.offers[d].rawPrice);b=b||a.lowestNewPrice,b==="Too low to display"&&(b="n/a",c=0),a.lowestNewPrice==="Too low to display"&&(a.lowestNewPrice="n/a"),a.buyNowPrice=b,a.buyNowRawPrice=c},q=function(a){var b=null;return typeof j[a]!="undefined"&&(b=j[a]),b},r=function(a){var b=null;return typeof k[a]!="undefined"&&(b=k[a]),b},s=function(a,b){var d={};return c("Item",a).each(function(){d=t(c(this))}),b.offers=d,d},t=function(a){var b={},d={},e=/\$/;b.lowestNewPrice=a.find("LowestNewPrice FormattedPrice").text().replace(e,""),b.lowestUsedPrice=a.find("LowestUsedPrice FormattedPrice").text().replace(e,""),b.totalNew=a.find("TotalNew").text(),b.totalUsed=a.find("TotalUsed").text(),b.totalOffers=a.find("TotalOffers").text(),b.offersURL=a.find("MoreOffersUrl").text(),b.offersURLNew=a.find("MoreOffersUrl").text()+"&condition=new",b.offersURLUsed=a.find("MoreOffersUrl").text()+"&condition=used";var f=/offer-listing/gi;return b.productURL=b.offersURL.replace(f,"product"),b.offers=[],c("Offer",a).each(function(){d={},d.price=c(this).find("Price FormattedPrice").text().replace(e,""),d.rawPrice=c(this).find("Price Amount").text(),d.availability=c(this).find("AvailabilityType").text(),d.freeShipping=c(this).find("IsEligibleForSuperSaverShipping").text(),b.offers.push(d)}),p(b),b}}(tmz.module("amazon"),tmz,jQuery,_,moment),function(a,b,c,d,e){"use strict";var f=b.module("amazon"),g=b.api+"giantbomb/search/",h=b.api+"giantbomb/detail/",i={},j={},k={},l={};a.searchGiantBomb=function(a,b,d){var e=encodeURIComponent(a),f=["id","name","original_release_date","image"],h={field_list:f.join(","),keywords:a,page:0},i=c.ajax({url:g,type:"GET",data:h,dataType:"json",cache:!0,success:b,error:d});return i},a.parseGiantBombResultItem=function(a){var b={id:a.id,asin:0,gbombID:a.id,name:a.name,platform:"n/a"};return a.original_release_date&&a.original_release_date!==""?b.releaseDate=a.original_release_date.split(" ")[0]:b.releaseDate="1900-01-01",b.releaseDate!=="1900-01-01"?b.calendarDate=e(b.releaseDate,"YYYY-MM-DD").calendar():b.calendarDate="Unknown",a.image&&a.image.small_url&&a.image.small_url!==""?b.smallImage=a.image.small_url:b.smallImage="no image.png",a.image&&a.image.thumb_url&&a.image.thumb_url!==""?b.thumbnailImage=a.image.thumb_url:b.thumbnailImage="no image.png",a.image&&a.image.super_url&&a.image.super_url!==""?b.largeImage=a.image.super_url:b.largeImage="no image.png",a.description&&a.description!==""?b.description=a.description:b.description="No Description",b},a.getGiantBombItemPlatform=function(a,b,c){var d=["platforms"];m(a,d,function(c){b(c,a)},c)},a.getGiantBombItemData=function(a,b,c){var e=n(a);if(e)b(e);else{d.has(k,a)||(k[a]=[]),k[a].push(b);if(k[a].length===1){var f=["description","site_detail_url","videos"];m(a,f,function(b){d.each(k[a],function(c){i[a]=b.results,c(b.results)}),k[a]=[]},c)}}},a.getGiantBombItemDetail=function(a,b,c){var e=o(a);if(e)b(e);else{d.has(l,a)||(l[a]=[]),l[a].push(b);if(l[a].length===1){var f=["id","name","original_release_date","image"];m(a,f,function(b){d.each(l[a],function(c){j[a]=b.results,c(b.results)}),l[a]=[]},c)}}};var m=function(a,b,d,e){var f={field_list:b.join(","),id:a};c.ajax({url:h,type:"GET",data:f,dataType:"json",cache:!0,success:d,error:e})},n=function(a){var b=null;return typeof i[a]!="undefined"&&(b=i[a]),b},o=function(a){var b=null;return typeof j[a]!="undefined"&&(b=j[a]),b}}(tmz.module("giantbomb"),tmz,jQuery,_,moment),function(a,b,c,d){"use strict";var e=b.module("amazon"),f=b.module("itemLinker"),g=b.module("itemData"),h=b.api+"metacritic/search/",i=b.api+"metacritic/cache/",j="metacritic.com",k={},l={};a.getMetascore=function(a,b,e,f){var i=null,j=n(b.asin,b.gbombID,b.platform);if(j)i=j,b.metascore=j.metascore,b.metascorePage=j.metascorePage,f(b);else{var k=a+"_"+b.platform;d.has(l,k)||(l[k]=[]),l[k].push(f);if(l[k].length===1){var r=m(a),s={keywords:encodeURI(r),platform:encodeURI(b.platform)};i=c.ajax({url:h,type:"GET",data:s,cache:!0,success:function(a){var c=b.metascore,f=p(r,a,b);q(f,b),!e&&b.metascore!=c&&g.updateMetacritic(b),d.each(l[k],function(a){o(b.asin,b.gbombID,b.platform,b),a(b)}),l[k]=[]}})}}return i},a.displayMetascoreData=function(a,b,d){var e=c(d),f=b,g="favorable";b<0?(f="n/a",g="unavailable"):b<50?g="unfavorable":b<75&&(g="neutral"),e.html(f).removeClass("unavailable").removeClass("unfavorable").removeClass("neutral").removeClass("favorable").addClass(g).attr("href","http://www."+j+a).attr("data-score",b).attr("data-original-title",j+" "+a).show(),e.tooltip({placement:"left"})};var m=function(a){c=/\s*[:&]\s*/g;var b=a.replace(c," "),c=/\s/g;return b=b.replace(c,"+"),b},n=function(a,b,c){var d=null;return typeof k[a+"_"+c]!="undefined"?d=k[a+"_"+c]:typeof k[b+"_"+c]!="undefined"&&(d=k[b+"_"+c]),d},o=function(a,b,c,d){a!="0"&&(k[a+"_"+c]={metascorePage:d.metascorePage,metascore:d.metascore}),b!="0"&&(k[b+"_"+c]={metascorePage:d.metascorePage,metascore:d.metascore})},p=function(a,b,c){var d=null;return typeof b.metascore=="undefined"?(d=s(b,c),d&&r(a,c.platform,d.metascore,d.metascorePage)):d=b,d},q=function(a,b){a&&a.metascore!==""?(b.metascore=a.metascore,b.displayMetascore=a.metascore,b.metascorePage=a.metascorePage):a?(b.metascore=-1,b.displayMetascore="n/a",b.metascorePage=a.metascorePage):(b.metascore=-1,b.displayMetascore="n/a",b.metascorePage="")},r=function(a,b,d,e){var f={keywords:encodeURI(a),platform:encodeURI(b),metascore:encodeURI(d),metascorePage:encodeURI(e)};c.ajax({url:i,type:"GET",data:f,cache:!0,success:function(a){}})},s=function(a,b){var d=c("#main",a).find(".result"),e={},g=null,h=-99999,i=0;return c(d).each(function(){var a=new Date(c(this).find(".release_date .data").text()),d=a.getMonth()+1;d=d<10?"0"+d:d;var j=a.getDate();j=j<10?"0"+j:j,e={name:c(this).find(".product_title a").text(),releaseDate:a.getFullYear()+"-"+d+"-"+j,platform:c(this).find(".platform").text(),metascore:c(this).find(".metascore").text(),metascorePage:c(this).find(".product_title a").attr("href")},i=f.getSimilarityScore(b,e),i>h&&(g=e,h=i)}),g}}(tmz.module("metacritic"),tmz,jQuery,_),function(a){var b=tmz.module("user"),c=tmz.module("utilities"),d=tmz.module("itemLinker"),e={};a.getWikipediaPage=function(a,b,c){var h=e[b.id];h&&typeof h.wikipediaPage!="undefined"?c(h.wikipediaPage):f(a,function(a){var f=null;_.each(a,function(a,b){f=a}),d.findWikipediaMatch(f,b,function(a){g(a.name,function(a){_.each(a.query.pages,function(a,d){h?h.wikipediaPage=a.fullurl:e[b.id]={wikipediaPage:a.fullurl},c(a.fullurl)})})})})};var f=function(a,b,c){var d="http://en.wikipedia.org/w/api.php?action=opensearch&format=json&callback=?",e={search:a,prop:"revisions",rvprop:"content"};$.ajax({url:d,type:"GET",data:e,dataType:"jsonp",cache:!1,crossDomain:!0,success:b,error:c})},g=function(a,b,c){var d="http://en.wikipedia.org/w/api.php?action=query&format=json&callback=?",e={titles:a,prop:"info",inprop:"url"};$.ajax({url:d,type:"GET",data:e,dataType:"jsonp",cache:!1,crossDomain:!0,success:b,error:c})}}(tmz.module("wikipedia")),function(a,b,c,d){"use strict";var e=b.module("amazon"),f=b.module("itemLinker"),g=b.module("itemData"),h=b.api+"gametrailers/search/",i=b.api+"gametrailers/cache/",j="gametrailers.com",k={},l={};a.getGametrailersPage=function(a,b,e){var f=null,g=n(a);if(g)b.gametrailersPage=g.gametrailersPage,e(b.gametrailersPage);else{var i=a+"_";d.has(l,i)||(l[i]=[]),l[i].push(e);if(l[i].length===1){var j=m(a),k={keywords:encodeURI(j)};f=c.ajax({url:h,type:"GET",data:k,cache:!0,success:function(c){var e=p(j,c,b);d.each(l[i],function(c){b.gametrailersPage=e,o(a,e),c(e)}),l[i]=[]}})}}return f};var m=function(a){c=/\s*[:&]\s*/g;var b=a.replace(c," "),c=/\s/g;return b=b.replace(c,"+"),b},n=function(a){var b=null;return typeof k[a]!="undefined"&&(b=k[a]),b},o=function(a,b){k[a]={gametrailersPage:b}},p=function(a,b,c){var d=null;return typeof b.gametrailersPage=="undefined"?(d=r(b,c),d&&q(a,d)):d=b.gametrailersPage,d},q=function(a,b){var d={keywords:encodeURI(a),gametrailersPage:encodeURI(b)};c.ajax({url:i,type:"GET",data:d,cache:!0,success:function(a){}})},r=function(a,b){var d=c("#games",a).find(".video_game_information_child"),e={},g=null,h=-99999,i=0;return c(d).each(function(){e={name:c(this).find(".content h3 a").text(),releaseDate:c(this).find(".content dl dd:eq(1) a").text(),gametrailersPage:c(this).find(".content h3 a").attr("href")},i=f.getSimilarityScore(b,e),i>h&&(g=e,h=i)}),g.gametrailersPage+"/videos-trailers"}}(tmz.module("gameTrailers"),tmz,jQuery,_),function(a,b,c,d){"use strict";var e=b.api+"list/popular/",f={};a.getPopularGamesListByPlatform=function(a,b){var d=g(a);if(d)b(d);else{var h={platform:a};c.ajax({url:e,type:"GET",data:h,cache:!0,success:function(c){f[a]=c,b(c)}})}};var g=function(a){var b=null;return typeof f[a]!="undefined"&&(b=f[a]),b},h=function(){}}(tmz.module("gameStats"),tmz,jQuery,_),function(a,b,c,d){var e=b.api+"list/upcoming/",f={};a.getUpcomingGames=function(a,b,d){var h=g(a,b);if(h)d(h);else{var i={platform:a,page:b};c.ajax({url:e,type:"GET",data:i,cache:!0,success:function(c){f[a+"_"+b]=c,d(c)}})}};var g=function(a,b){var c=null;return typeof f[a+"_"+b]!="undefined"&&(c=f[a+"_"+b]),c},h=function(){}}(tmz.module("ign"),tmz,jQuery,_),function(a,b,c,d){"use strict";var e=b.api+"list/released/",f={};a.getReleasedGames=function(a,b,d,i,j){var k=h(b,d,i);if(k){var l=g(k,a);j(l)}else{var m={year:b,month:d,day:i};c.ajax({url:e,type:"GET",data:m,cache:!0,success:function(c){var e=g(c,a);f[b+"_"+d+"_"+i]=e,j(e)}})}};var g=function(a,b){var c=[];for(var e=0,f=a.length;e<f;e++){a[e].name=a[e].name.replace(/\sbox\s*.*/gi,"");if(d.has(a[e],"platforms")){var g=a[e].platforms.toLowerCase(),h=g.search(b);h!==-1&&c.push(a[e])}}return c},h=function(a,b,c){var d=null;return typeof f[a+"_"+b+"_"+c]!="undefined"&&(d=f[a+"_"+b+"_"+c]),d}}(tmz.module("releasedList"),tmz,jQuery,_),function(a,b,c,d){"use strict";var e=b.module("amazon"),f=b.module("giantbomb"),g=b.module("utilities");a.standardizeTitle=function(a){var b=a,c=null,d=null,e=null,f=null,g="",h=0,i=0,j=null;return b=b.replace(/\s*[\[\(].*[\)\]]/gi,""),b=b.replace(/\s*trophies/gi,""),b=b.replace(/\S+ edition$/gi,""),b=b.replace(/\swith\s.*/gi,""),b=b.replace(/^\s*the\s/gi,""),e&&e[0].length>3&&(b=b.replace(c,"")),b.toLowerCase()},a.getSimilarityScore=function(b,c){var d=0,e=a.standardizeTitle(c.name);if(b.standardName===c.name.toLowerCase())d+=50;else{var f=new RegExp(b.standardName,"gi"),h=new RegExp(e,"gi"),i=f.exec(e),j=h.exec(b.standardName);if(i&&i[0].length>0||j&&j[0].length>0)d+=5}if(typeof c.releaseDate!="undefined")if(b.releaseDate===c.releaseDate)d+=10;else{var k=Math.floor((Date.parse(b.releaseDate)-Date.parse(c.releaseDate))/864e5);!isNaN(k)&&c.releaseDate!=="1900-01-01"&&(d-=Math.abs(k/365))}if(typeof c.platform!="undefined"){var l=g.matchPlatformToIndex(c.platform).name;b.platform===l&&(d+=20)}return d},a.convertRomanNumerals=function(a){var b=new RegExp("\\s[XVI]+","gi"),c=b.exec(a);if(c&&c[0].length>0){var d=c[0],e=new RegExp("III","gi"),f=e.exec(d),g="";f&&f[0].length>0&&(g=3,d=d.replace(e,""));var h=d.split(""),i=null;for(var j=h.length-1;j>=1;j--){switch(h[j]){case"I":i=1;break;case"V":i=5;break;case"X":i=10}i<g?g=g-i:g=g+i}a=a.replace(b," "+g)}return a},a.findItemOnAlternateProvider=function(a,b,c,d,h){var i=null;h=typeof h!="undefined"?h:null;switch(b){case g.SEARCH_PROVIDERS.Amazon:var l=a.standardName;i=f.searchGiantBomb(l,function(b){k(b,a,d,h)});break;case g.SEARCH_PROVIDERS.GiantBomb:var m=0;a.platform!=="n/a"&&(m=g.getStandardPlatform(a.platform).amazon),i=e.searchAmazon(a.name,m,function(b){j(b,a,d,h,!1)},h,c)}return i},a.getLinkedItemData=function(a,b,c){switch(b){case g.SEARCH_PROVIDERS.Amazon:f.getGiantBombItemDetail(a.gbombID,function(a){i(a,c)});break;case g.SEARCH_PROVIDERS.GiantBomb:e.getAmazonItemDetail(a.asin,function(a){h(a,c)})}},a.findWikipediaMatch=function(b,c,d){var e=b,f={},g=null,h=-99999,i=0;for(var j=0,k=e.length;j<k;j++)f={name:e[j]},j===0&&(g=f),i=a.getSimilarityScore(c,f),i>h&&(g=f,h=i);e.length!==0&&d(g)};var h=function(a,b){var d={};c("Item",a).each(function(){d=e.parseAmazonResultItem(c(this))}),b(d)},i=function(a,b){var c=f.parseGiantBombResultItem(a);b(c)},j=function(b,d,f,g,h){var i=c("Item",b).length,k={},l=0,m=null,n=-99999,o=0;c("Item",b).each(function(){k=e.parseAmazonResultItem(c(this)),typeof k.isFiltered=="undefined"&&(l===0&&(m=k),l++,o=a.getSimilarityScore(d,k),o>n&&(m=k,n=o))}),m?f(m):h?g():e.searchAmazon(d.name,0,function(a){j(a,d,f,g,!0)},g)},k=function(b,c,d,e){var g=b.results,h={},i=null,j=-99999,k=0;for(var l=0,m=g.length;l<m;l++)h=f.parseGiantBombResultItem(g[l]),l===0&&(i=h),k=a.getSimilarityScore(c,h),k>j&&(i=h,j=k);g.length!==0?d(i):e()}}(tmz.module("itemLinker"),tmz,jQuery,_),function(a,b,c,d){"use strict";var e=b.module("user"),f=b.module("utilities"),g=b.module("itemData"),h=b.module("tagView"),i=b.module("itemView"),j=b.module("amazon"),k=b.module("metacritic"),l=b.module("itemLinker"),m=b.module("giantbomb"),n=["Steam","PSN","XBL"],o=["Account Name","PSN ID","Gamertag"],p=["http://steamcommunity.com/actions/SearchFriends","http://us.playstation.com/mytrophies/","https://live.xbox.com/en-US/Friends"],q="http://d2sifwlm28j6up.cloudfront.net/no_match.png",r=0,s=0,t=0,u=0,v=null,w={},x=[],y=[],z=c("#importContainer"),A=c("#importResults"),B=c("#importResults tbody"),C=c("#startImport_btn"),D=c("#confirmImport_btn"),E=c("#cancelImport_btn"),F=c("#sourceUser"),G=c(".importSourceID"),H=c(".importSourceName"),I=c(".importSourceURL"),J=c("#importConfig-modal"),K=c("#import-modal"),L=z.find(".loadingStatus"),M=c("#importProgress"),N=M.find(".bar"),O=c("#importStatus"),P=O.find(".statusTitle"),Q=O.find(".statusText"),R=null,S=d.template(c("#import-results-template").html()),T=function(){R=ba.lazy(2e3,2e3),U()},U=function(){C.click(function(a){a.preventDefault(),F.val()!==""&&Y(F.val())}),F.keyup(function(a){a.preventDefault(),a.which===13&&F.val()!==""&&Y(F.val())}),D.click(function(a){a.preventDefault(),bj()}),E.click(function(a){a.preventDefault(),Z()})},V=function(){A.html("")},W=function(a){v=a,d.has(w,a)?(J.modal("hide"),K.modal("show")):X()},X=function(){G.text(o[v]),H.text(n[v]);var a=p[v],b='<a href="'+a+'" target="_blank">'+a+"</a>";I.html(b),J.modal("show"),d.delay(function(){F.focus().select()},1e3)},Y=function(a){w[v]=!0,y=[],r=0,s=0,t=0,u=0,B.empty(),L.stop().hide(),M.stop().hide(),O.stop().hide(),N.css({width:"0%"}),K.removeClass("ready"),J.modal("hide"),K.modal("show"),L.fadeIn(),g.importGames(v,a,function(a){$(a,["PSN","PS3","Vita"])})},Z=function(){delete w[v],X(),K.modal("hide")},$=function(a,b){x=a,t=x.length,d.each(x,function(a){a=l.standardizeTitle(a);var c={initialProvider:1,standardName:a};l.findItemOnAlternateProvider(c,f.SEARCH_PROVIDERS.Amazon,!1,function(d){_(a,d,c,b)},function(){bc(a)})})},_=function(a,b,e,g){c.extend(!0,e,b),m.getGiantBombItemPlatform(e.id,function(b){var c=[],h;for(var i=0,j=b.results.platforms.length;i<j;i++){var l=f.matchPlatformToIndex(b.results.platforms[i].name).name;c.push(l)}var m=d.intersection(c,g);e.platform=m[0];if(e.platform){r+=2,R(e,be);var n=k.getMetascore(e.standardName,e,!0,bf);bb(e)}else bc(a)})},ba=function(a,b){var c=l.findItemOnAlternateProvider(a,f.SEARCH_PROVIDERS.GiantBomb,!1,function(c){a.asin=c.asin,b()},function(){b()})},bb=function(a){a.importClass="imported",u===0&&(L.stop().fadeOut(),M.stop().fadeIn(),O.stop().fadeIn()),u++,y.push(a),bd(a),bh()},bc=function(a){var b={thumbnailImage:q,name:a,calendarDate:"",platform:"Title not found: please add manually",importClass:"importFailed"};bd(b)},bd=function(a){var b={item:a};B.append(S(b))},be=function(){bg()},bf=function(a){bg()},bg=function(){s++,bh(),r==s&&bi()},bh=function(){var a=t+r,b=u+s,c=Math.round(b/a*100);N.css({width:c+"%"}),Q.text(b+" of "+a)},bi=function(){M.stop().fadeOut(),O.stop().fadeOut(),K.addClass("ready")},bj=function(){var a=n[v].toLowerCase()+" import",b=y.length,c=0;h.addTag(a,function(a){var e=[a.tagID];d.each(y,function(a){g.addItemToTags(e,a,function(a){c++,c===b&&bk(e)})})}),delete w[v],v=null},bk=function(a){K.modal("hide"),i.refreshView(),h.updateViewList(a),i.viewRandomItem()},bl={init:T,startImport:W};c.extend(a,bl)}(tmz.module("importView"),tmz,jQuery,_),tmz.initialize();